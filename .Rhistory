plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 13000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 15000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 14000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = c(0, 14000, 3000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 3000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl1/menl2 + plot_layout(axis_titles = "collect", guides = "collect")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
scale_y_continuous(limits = c(0, 1)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"), trans = "ln",
re.form=NA) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist"), trans = "ln",
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time")
re.form=NA) +
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to not answer the exit poll\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
color = "Trust in result",
fill = "Trust in result") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia
menl3 <- plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl4 <- plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
#| fig-cap: Probabilities to vote for Putin by geodesic distance from Russia and
menl3 <- plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Geodesic distance from Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl4 <- plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Catholics",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
#| fig-cap: Probabilities to vote for Putin
menl3 <- plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Geodesic distance from Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl4 <- plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Catholics",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
menl4 <- plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time", "age"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Catholics",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
menl4 <- plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time", "age_bin"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Catholics",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
#| fig-cap: Probabilities to vote for Putin
menl3 <- plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Geodesic distance from Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl4 <- plot_predictions(m5p.nested, condition = c("orthodox_share", "out_of_Russia_time", "age_bin"),
re.form=NA) +
facet_wrap(~ age_bin, scales = "fixed") +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Catholics",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
m5a.nested
#| fig-cap: Probabilities to vote for Putin
menl3 <- plot_predictions(m5p.nested, condition = c("military_dummy", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Geodesic distance from Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
plot_predictions(m5p.nested, condition = c("military_dummy", "out_of_Russia_time"),
re.form=NA) +
scale_x_continuous(limits = c(0, 14000),
breaks = seq(0, 14000, 2000)) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Geodesic distance from Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
plot_predictions(m5p.nested, condition = c("military_dummy", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Geodesic distance from Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to vote for Putin
menl3 <- plot_predictions(m5p.nested, condition = c("dist", "military_dummy", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Military base dummy",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
menl3/menl4 + plot_layout(axis_titles = "collect", guides = "collect")
#| fig-cap: Probabilities to vote for Putin
menl3 <- plot_predictions(m5p.nested, condition = c("military_dummy", "out_of_Russia_time"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Military base dummy",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to choose non-systemic opposition
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time", "age_bin"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Christians",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to choose non-systemic opposition
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time", "trust_result_bin"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Christians",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to choose non-systemic opposition
plot_predictions(m5p.nested, condition = c("dist", "out_of_Russia_time", "result_trust_bin"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Christians",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to choose non-systemic opposition
plot_predictions(m5s.nested, condition = c("dist", "out_of_Russia_time", "result_trust_bin"),
re.form=NA) +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Christians",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to choose non-systemic opposition
plot_predictions(m5s.nested, condition = c("dist", "out_of_Russia_time", "result_trust_bin"),
re.form=NA) +
facet_wrap(~ result_trust_bin, scales = "fixed") +
labs(x = NULL, y = "Probability to vote for Putin\n",
title = "Share of Orthodox Christians",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left")
#| fig-cap: Probabilities to choose non-systemic opposition
plot_predictions(m5s.nested, condition = c("dist", "out_of_Russia_time", "result_trust_bin"),
re.form=NA) +
facet_wrap(~ result_trust_bin, scales = "fixed") +
labs(x = NULL, y = "Probability to choose non-systemic opposition\n",
title = "Geodesic distance to Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left",
legend.position = "bottom")
#| fig-cap: Probabilities to spoil the ballot
plot_predictions(m5d.nested, condition = c("vdem_polyarchy_2022",
"out_of_Russia_time",
"result_trust_bin"),
re.form=NA) +
facet_wrap(~ result_trust_bin, scales = "fixed") +
labs(x = NULL, y = "Probability to choose non-systemic opposition\n",
title = "Geodesic distance to Russia",
color = "Time out of Russia",
fill = "Time out of Russia") +
scale_color_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
scale_fill_manual(values = c("#1984c5", "#bf212f", "#f5be2c", "#016430", "grey")) +
theme_bw() +
theme(legend.justification = "left",
legend.position = "bottom")
ggpairs(data_figure2, mapping = aes(color = `Conducted Exit Poll`),
columns = 1:10,
legend = c(2, 2)) +
scale_color_manual(values = c("#bf212f", "#1984c5")) +
scale_fill_manual(values = c("#bf212f", "#1984c5")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
legend.position = "bottom")
#| fig-cap: Imputation results - number of missing values before and after
#| label: fig-f4
ggplot(data_figure3, aes(x = value, y = rowname, fill = rowname)) +
geom_bar(stat = "identity", width = 0.5) +
facet_wrap(~ name, scales = "free_x", ncol = 2) +
scale_fill_manual(values = c("#1984c5", "#bf212f")) +
labs(y = NULL, x = "\nNumber of missing values") +
theme_minimal() +
theme(legend.position = "none")
save.image(list = c(m2p, m2d, m2s), file = here("scripts", "models", "lin.rds"))
save.image(list = c(m2p, m2d, m2s), file = here("scripts", "models", "lin.RData"))
save(list = c(m2p, m2d, m2s), file = here("scripts", "models", "lin.RData"))
#| label: linear models 2
m2p <- lm(putin_full ~ orthodox_share + vdem_polyarchy_2022
+ log(mad_gdppc_2018) + obl_type + export_share + import_share
+ friendly_status + help + military_dummy + log(dist) + log(mean_trips),
data = data_country)
m2d <- lm(davankov_full ~ orthodox_share + vdem_polyarchy_2022
+ log(mad_gdppc_2018) + obl_type + export_share + import_share
+ friendly_status + help + military_dummy + log(dist) + log(mean_trips),
data = data_country)
m2s <- lm(spoiled_full ~ orthodox_share + vdem_polyarchy_2022
+ log(mad_gdppc_2018) + obl_type + export_share + import_share
+ friendly_status + help + military_dummy + log(dist) + log(mean_trips),
data = data_country)
save(list = c(m2p, m2d, m2s), file = here("scripts", "models", "lin.RData"))
#| label: packages
#| cache: false
source(here::here("utilities", "check_packages.R"))
source(here::here("utilities", "functions.R"))
#| label: source data
data_country <- read_rds(here("data", "data_built", "data_country.rds"))
#| label: linear models
#| fig-keep: 2
m1 <- lm(ep ~ vdem_polyarchy_2022 + log(mad_gdppc_2018) + orthodox_share
+ log(dist) + log(voters_in_list) + log(mean_trips), data = data_country)
m1.log <- glm(ep ~ vdem_polyarchy_2022 + log(mad_gdppc_2018) + orthodox_share
+ log(dist) + log(voters_in_list)+ log(mean_trips),
data = data_country, family = "binomial")
summary(m1)
summary(m1.log)
check_m1.log <- plot(check_model(m1.log))
check_m1.log[[4]] <- check_m1.log[[4]] + theme(axis.text.x = element_text(
angle = 45,hjust = 1)
)
check_m1.log
save(m1.log, file = here("scripts", "models", "m1_log.rds"))
#| label: linear models 2
m2p <- lm(putin_full ~ orthodox_share + vdem_polyarchy_2022
+ log(mad_gdppc_2018) + obl_type + export_share + import_share
+ friendly_status + help + military_dummy + log(dist) + log(mean_trips),
data = data_country)
m2d <- lm(davankov_full ~ orthodox_share + vdem_polyarchy_2022
+ log(mad_gdppc_2018) + obl_type + export_share + import_share
+ friendly_status + help + military_dummy + log(dist) + log(mean_trips),
data = data_country)
m2s <- lm(spoiled_full ~ orthodox_share + vdem_polyarchy_2022
+ log(mad_gdppc_2018) + obl_type + export_share + import_share
+ friendly_status + help + military_dummy + log(dist) + log(mean_trips),
data = data_country)
save(list = c("m2p", "m2d", "m2s"), file = here("scripts", "models", "lin.RData"))
#| label: linear models table
#| results: asis
resizebox.stargazer(m2p, m2d, m2s,
type = "latex",
title = "Linear models for vote shares",
tab.height = "\\textheight", tab.width= "\\textwidth")
#| label: check models
#| output: false
check_m2p <- plot(check_model(m2p))
check_m2p[[5]] <- check_m2p[[5]] + theme(axis.text.x = element_text(angle = 45,
hjust = 1))
check_m2d <- plot(check_model(m2d))
check_m2d[[5]] <- check_m2d[[5]] + theme(axis.text.x = element_text(angle = 45,
hjust = 1))
check_m2s <- plot(check_model(m2s))
check_m2s[[5]] <- check_m2s[[5]] + theme(axis.text.x = element_text(angle = 45,
hjust = 1))
#| label: check models plot
check_m2p
check_m2d
check_m2s
#| label: load figures and graphs
load(here("paper", "graphs_figures.RData"))
load(here("scripts", "models", "nl_fe.RData"))
load(here("scripts", "models", "nlme_bobyqa.RData"))
load(here("scripts", "models", "lin.RData"))
length(unique(data_country$ep == 1))
sum(unique(data_country$ep == 1))
sum(data_country$ep == 1)
View(data_country)
#| fig-cap: Average percent of votes for Putin by country
#| label: fig-f1
ggplot(data_figure1, aes(fill = putin_bins)) +
geom_sf() +
scale_fill_manual(values =
c("#1984c5", "#63bff0", "#de6e56", "#bf212f"),
na.translate = F) +
labs(fill = "% of votes",
caption = paste0("\nSources: Ivan Shukshin's Telegram channel - t.me/nevybory,",
"\nCentral Election Commission of the Russian Federation\n",
"\nNote: Abkhazia and South Osetia not shown")) +
theme_void() +
coord_sf(ylim = c(-55, 90))
