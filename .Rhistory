geom_sf() +
scale_fill_viridis_d(option = "G", direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 7, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "G", translate_na = F direction = -1) +
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 7, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "G", na_translate = F, direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 7, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "G", translate_na = F, direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 7, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "G", na.translate = F, direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
cor(merged$diff2015_2010, merged$share.raw_after2014ref)
cor(merged$diff2015_2010, merged$share.raw_after2014ref, use = "complete.obs")
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 7, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "G", na.translate = F, direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 7, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "B", na.translate = F, direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 8, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_viridis_d(option = "B", na.translate = F, direction = -1) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 8, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#002c71', '#264a94', '#4c68b7', '#7289d4', '#97aced', '#c2d0fd', '#d2383d', '#a61c1e'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#002c71', '#20468f', '#4160ad', '#627bc9', '#8198df', '#a2b6f5', '#c9d5fb', '#d2383d', '#a61c1e'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#002c71', '#20468f', '#4160ad', '#627bc9', '#8198df', '#a2b6f5', '#c9d5fb', '#f9cdca', '#d2383d', '#a61c1e'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9f181a', '#c53034', '#e25354', '#f47b77', '#fea39c', '#f9cdca', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9f181a', '#c53034', '#e25354', '#f47b77', '#fea39c', '#f9cdca', '#f5f5f5', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9f181a', '#c53034', '#e25354', '#f47b77', '#fea39c',
'#f9cdca', '#f5f5f5', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014\n",
subtitle = "By decile",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9f181a', '#c53034', '#e25354', '#f47b77', '#fea39c',
'#f9cdca', '#f5f5f5', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014",
subtitle = "By decile\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9b1517', '#bc2a2e', '#db4246', '#eb6766', '#fa8983',
'#fcaea8', '#f9d3d0', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014",
subtitle = "By decile\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9b1517', '#bc2a2e', '#db4246', '#eb6766', '#fa8983',
'#fcaea8', '#f9d3d0', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014",
subtitle = "By decile, for a sample where exit polls were conducted\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
/(sum(out_of_Russia_time == "> 10 years", na.rm = T)\n()),
/(sum(out_of_Russia_time == "> 10 years", na.rm = T)/n()),
## Aggregate to voting station level
ep.raw_agg <- ep_raw_clean |>
group_by(voting_station, countryname_en, countryname_ru, countrycode_c,
countrycode_n, city_ru, city_en) |>
summarise(vote.raw_putin = sum(vote == "Putin")/n(),
vote.raw_davankov = sum(vote == "Davankov")/n(),
vote.raw_spoiled = sum(vote == "Spoiled ballot")/n(),
share.raw_female = sum(sex == "Female", na.rm = T)/n(),
share.raw_othergender = sum(sex == "Other", na.rm = T)/n(),
share.raw_age1824 = sum(age_bin == "18-24", na.rm = T)/n(),
share.raw_age2444 = sum(age_bin == "24-44", na.rm = T)/n(),
share.raw_age4564 = sum(age_bin == "45-64", na.rm = T)/n(),
share.raw_age65 = sum(age_bin == "65+", na.rm = T)/n(),
share.raw_tourist =
sum(out_of_Russia_time == "Tourist (lives in Russia)", na.rm = T)/n(),
share.raw_afterfeb =
sum(out_of_Russia_time %in% c("6 month - 2 years",
"< 6 months",
"< 2 years"), na.rm = T)/n(),
share.raw_before2014 =
sum(out_of_Russia_time == "> 10 years", na.rm = T)/n(),
share.raw_after2014 =
sum(out_of_Russia_time == "> 5 years", na.rm = T)/n(),
share.raw_2019 =
sum(out_of_Russia_time == "2 - 5 years", na.rm = T)/n(),
# ref 2014
share.raw_afterfebref =
(sum(out_of_Russia_time %in% c("6 month - 2 years",
"< 6 months",
"< 2 years"), na.rm = T)/n())
/(sum(out_of_Russia_time == "> 10 years", na.rm = T)/n()),
share.raw_after2014ref =
sum(out_of_Russia_time == "> 5 years", na.rm = T)
/sum(out_of_Russia_time == "> 10 years", na.rm = T),
share.raw_2019ref =
sum(out_of_Russia_time == "2 - 5 years", na.rm = T)
/sum(out_of_Russia_time == "> 10 years", na.rm = T),
share.raw_timemore4h =
sum(time_to_vs == "> 4 hours (staying for the night)", na.rm = T)/n(),
share.raw_local =
sum(time_to_vs %in% c("<30 minutes", "30 minutes - 1 hour"),
na.rm = T)/n(),
share.raw_trustanyyes =
sum(result_trust %in% c("Definitely yes", "Probably yes"),
na.rm = T)/n(),
share.raw_trustanyno =
sum(result_trust %in% c("Definitely no", "Probably no"), na.rm = T)/n())
## Aggregate to voting station level
ep.raw_agg <- ep_raw_clean |>
group_by(voting_station, countryname_en, countryname_ru, countrycode_c,
countrycode_n, city_ru, city_en) |>
summarise(vote.raw_putin = sum(vote == "Putin")/n(),
vote.raw_davankov = sum(vote == "Davankov")/n(),
vote.raw_spoiled = sum(vote == "Spoiled ballot")/n(),
share.raw_female = sum(sex == "Female", na.rm = T)/n(),
share.raw_othergender = sum(sex == "Other", na.rm = T)/n(),
share.raw_age1824 = sum(age_bin == "18-24", na.rm = T)/n(),
share.raw_age2444 = sum(age_bin == "24-44", na.rm = T)/n(),
share.raw_age4564 = sum(age_bin == "45-64", na.rm = T)/n(),
share.raw_age65 = sum(age_bin == "65+", na.rm = T)/n(),
share.raw_tourist =
sum(out_of_Russia_time == "Tourist (lives in Russia)", na.rm = T)/n(),
share.raw_afterfeb =
sum(out_of_Russia_time %in% c("6 month - 2 years",
"< 6 months",
"< 2 years"), na.rm = T)/n(),
share.raw_before2014 =
sum(out_of_Russia_time == "> 10 years", na.rm = T)/n(),
share.raw_after2014 =
sum(out_of_Russia_time == "> 5 years", na.rm = T)/n(),
share.raw_2019 =
sum(out_of_Russia_time == "2 - 5 years", na.rm = T)/n(),
# ref 2014
share.raw_afterfebref =
(sum(out_of_Russia_time %in% c("6 month - 2 years",
"< 6 months",
"< 2 years"), na.rm = T)/n())
/(sum(out_of_Russia_time == "> 10 years", na.rm = T)/n()),
share.raw_after2014ref =
(sum(out_of_Russia_time == "> 5 years", na.rm = T)/n())
/(sum(out_of_Russia_time == "> 10 years", na.rm = T)/n()),
share.raw_2019ref =
(sum(out_of_Russia_time == "2 - 5 years", na.rm = T)/n())
/(sum(out_of_Russia_time == "> 10 years", na.rm = T)/n()),
share.raw_timemore4h =
sum(time_to_vs == "> 4 hours (staying for the night)", na.rm = T)/n(),
share.raw_local =
sum(time_to_vs %in% c("<30 minutes", "30 minutes - 1 hour"),
na.rm = T)/n(),
share.raw_trustanyyes =
sum(result_trust %in% c("Definitely yes", "Probably yes"),
na.rm = T)/n(),
share.raw_trustanyno =
sum(result_trust %in% c("Definitely no", "Probably no"), na.rm = T)/n())
#| label: Data
source(here::here("scripts", "data_building.R"))
data_plot <- merged |>
drop_na(countrycode_n) |>
group_by(countrycode_n) |>
summarize(all_2010 = all_2010,
all_2015 = all_2015,
diff2015_2010 = diff2015_2010,
diff2020_2015 = diff2020_2015,
across(c(share.raw_afterfebref,
share.raw_after2014ref, share.raw_2019ref),
~ if_else(is.nan(mean(., na.rm = T)), NA, mean(., na.rm = T))),
.groups = "drop") |>
distinct() |>
full_join(world, by = "countrycode_n") |>
st_as_sf()
#| label: raw graphs
data_plot %>%
summarise(across(everything(), ~ sum(is.na(.x))))
data_raw <- data_plot |>
pivot_longer(cols = c(share.raw_after2014ref,
share.raw_2019ref, share.raw_afterfebref),
names_to = "when")
data_raw |>
mutate(value = cut(value,
classIntervals(c(min(data_raw$value) - .00001,
data_raw$value),
n = 10, style = "quantile")$brks)) |>
ggplot(aes(fill = value)) +
geom_sf() +
scale_fill_manual(values = c(
'#790000', '#9b1517', '#bc2a2e', '#db4246', '#eb6766', '#fa8983',
'#fcaea8', '#f9d3d0', '#4160ad', '#20468f'),
na.translate = F) +
labs(title = "Self-reported migration times per country, compared to 2014",
subtitle = "By decile, for a sample where exit polls were conducted\n",
fill = "Times less/more than before 2014") +
facet_wrap(~ factor(when, levels = c("share.raw_after2014ref",
"share.raw_2019ref",
"share.raw_afterfebref"),
labels = c("After 2014 but before 2019",
"After 2019 but before 2022",
"After 2022")),
nrow = 2) +
theme_void() +
theme(legend.position = "bottom") +
coord_sf(ylim = c(-55, 90))
