---
title: |
  |Soviet legacies and long-term development: 
  |Exploring the Subnational Dimension
subtitle: "Final paper for AQMSS I"
author: "Polikanov Stepan"
format:
  pdf:
    code_download: true
    fontsize: 11pt
    highlight-style: kate
    fig-width: 10
    fig-height: 6
    include-in-header:
      - fig-align.tex
      - text: |
          \addtokomafont{disposition}{\rmfamily} 
          \AddToHook{env/Highlighting/begin}{\scriptsize} 
          \usepackage[backend = biber, style = apa]{biblatex}
          \addbibresource{bibliography.bib}
          \usepackage{float} 
          \usepackage{subcaption}
embed-resources: true
execute: 
  echo: true
  warning: false
  error: false
  message: false
---

\subsubsection{Setup}

```{r}
#| label: Setup

# Manage packages
  
  ## Package list
  packages <- c("sandwich", "lmtest", "MASS", "car", "tune", "readxl", "writexl", "here", 
                "summarytools", "stargazer","terra", "sf", "geodata", 
                "viridis", "lwgeom", "tidyverse", "kableExtra")

  ## Install packages not yet installed
  installed_packages <- packages %in% rownames(installed.packages())
    if (any(installed_packages == FALSE)) {
      install.packages(packages[!installed_packages])
    }
    
  ## Load packages
  invisible(lapply(packages, library, character.only = TRUE))
  
  
# Establish directory
here::i_am("./data analysis/script/final.qmd")

# Set options
options(scipen = 999)

# Define global functions

  ## Fitting stargazer onto the page
  resizebox.stargazer = function(..., tab.width = "!", tab.height = "!")
      {
    require(stringr) 
    res = capture.output(stargazer::stargazer(...))
    tab.width = tab.width
    tab.height = tab.height
    res = prepend(res, "}", before = length(res))
  
    res = c(res[1:str_which(res, "^\\\\begin\\{tabular\\}.*")-1],
        paste0("\\resizebox*{",tab.width,"}{",tab.height,"}{%"),
        res[str_which(res, "^\\\\begin\\{tabular\\}.*"):length(res)]
        )
    cat(res, sep = "\n")
  }

options(scipen = 999)
```

\subsubsection{Shapefiles download}

```{r}
#| label: download data
#| eval: false

gadm(c("Armenia", "Azerbaijan", "Belarus", "Estonia", "Georgia", "Kyrgyzstan", 
       "Moldova", "Latvia", "Lithuania", "Russia", "Tajikistan", "Turkmenistan", 
       "Ukraine", "Uzbekistan"), 
     version = "3.6",  path = here("data analysis", "data"),  level = 1)

gadm(c("Armenia", "Azerbaijan", "Belarus", "Estonia", "Georgia", "Kazakhstan",
       "Kyrgyzstan", "Moldova", "Latvia", "Lithuania", "Russia", "Tajikistan", 
       "Turkmenistan", "Ukraine", "Uzbekistan"), 
     version = "3.6", path = here("data analysis", "data"), level = 0)
```

\subsubsection{Loading Data}

```{r}
#| label: data

# DOSE - self-reported GRP data
    
  ## Main file
  dose_v2 <- read_csv(here("data analysis", "data", "DOSE_V2.csv"))
  
  ## Shapefiles: Kazakhstan
  kz_shape <- read_sf(here("data analysis", "data", "DOSE_shapefiles.gpkg"), 
                 layer = "all_non_GADM_regions") %>%
    rename(geometry = geom) %>%
    filter(NAME_0 == "Kazakhstan")
  
  ## Shapefiles: GADM regional
  gadm <- list.files(here("data analysis", "data", "gadm"), pattern = "_1_pk", 
                     full.names = T) %>%
    map(read_rds) %>% 
    map(unwrap) %>%
    map(st_as_sf) %>%
    bind_rows(kz_shape)
  
  ## Shapefiles: GADM country borders
  gadm_countries <- list.files(here("data analysis", "data", "gadm"), 
                               pattern = "_0_pk", full.names = T) %>%
    map(read_rds) %>% 
    map(unwrap) %>%
    map(st_as_sf) %>%
    bind_rows() %>%
    st_transform(4326)%>%
    st_shift_longitude()
  
# SHDI - Subnational Human Development Index
  
  ## Main file  
  hdi <- read_excel(here("data analysis", "data", "hdi.xlsx"))
  
  ## Regional data for Russia
  hdi_russia <- read_excel(here("data analysis", "data", "hdi_russia.xlsx"))

# Locations of GULAG camps 1923-1967 (Memorial georeferenced map)
gulag <- read_sf(here("data analysis", "data", "gulag", "gulags.shp"))

# Muscovy - Russia - USSR territorial expansion data

  ## Raw files
  expansion <- list.files(here("data analysis", "data", "expansion"), 
                     full.names = T) %>%
    map(read_sf) %>%
    bind_rows(.id = "id") %>%
    mutate(id = as.numeric(id)) %>%
    left_join(read_excel(here("data analysis", "data", "expansion_names.xlsx")), by = "id")
  
  ## Intersection with 2009 GADM lists (generated by chunk below)
  load(here("data analysis", "data", "expansion_list.RData"))3
```

\section{Introduction and the theoretical framework}

\subsection{Research Question}

In this paper, I aim to answer the following \textit{research question}:

\begin{quote}
  How legacies of Soviet rule affected subnational economic development in the post-Soviet countries?
\end{quote}

I address the gap in the way previous research has dealt with macro- and micro-level investigations into the effects of Soviet legacies. The endgoal of this paper is to lay basis for micro-level analysis of the former Soviet union on the municipal level. 

The analysis does not present much in terms of innovative research questions, robustness of results or identification. Considering the already harsh limitations of the data, cross-sectional analysis is the only option, and it does not lend itself easily to causal identification. I further describe the limitations of the study in the "Discussion" section.

\subsection{Soviet Legacies: an empirical agenda}

This paper presents a first attempt at analyzing economic, social and political legacies created by the Russian Empire and the USSR at a regional level. Most studies on post-Soviet countries have focused on i) comparative analysis of cross-country dynamics (\cite{ekiert_capitalism_2003, benesova_post-soviet_2016, beissinger_communist_2014}), ii) comparing post-Soviet states to other regions of the world (\cite{carter_communist_2016}), iii) analyzing processes on a per-country basis, often with disagregation by subnational units (\cite{lankina_authoritarian_2016, zhukov_stalins_2018}) or iv) finding natural experiments and discontinuities in specific local contexts (\cite{schofield_cultural_2015, alesina_good-bye_2007}). 

I deploy a seldom-used framework of data organization: I disaggregate data by constituent units of post-Soviet countries, specifically, level 1 administrative units. This allows for identification of both within- and cross-country effects. Perhaps more importantly, it allows to test hypotheses pertaining to the shared USSR experience and uncover patterns in subnational variation that cannot be attributed to national policies simultaneously.

Such an approach would be exceptionally helpful if I would be dealing with municipal units, however, due to harsh limitations in data collection, I decided to begin with an exploratory analysis on the regional level.

In the following paper I study effects of being under rule of both Russian Empire and USSR, occupation and political repressions on human and economic development. Because of data availability I limit myself to cross-sectional regression analysis with only a handful of variables. The goal of the paper is to establish avenues for future research and evaluate validity of chosen measures.

\subsection{Foreign rule}

Legacies of Soviet Union have been an object of both the public and scientific interest since the dissolution of the USSR. There is no doubt that such legacies exist: the overarching system of planned economy, political repression and international struggle has formed the states born out of 1991 into a specific group, believed to possess unique properties vis-a-vis other countries. 

Some countries, however, seem to have overcome the more negative consequences of Soviet rule faster than others (\cite{beissinger_historical_2014}). Specifically, the three Baltic countries present a unique case of being more detached from those legacies on one hand historically, through being annexed into different Empires and lost just as frequently, and on the other hand, politically, being forcefully invaded and occupied by USSR in 1940. 

On the other hand, other places have experienced relatively little variation in terms of rule, either being conquered during the Imperial period and continuing their existence under Soviet rule or being an even earlier acquisition, whether by force of diplomacy, of the Muscovy.

My main argument is that those status changes and, ultimately, the length the country spends under foreign (relative to its previous status) authority, predicts outcomes after the end of the Soviet Union. But which outcomes might be affected? Research shows that political participation (\cite{rozenas_political_2017, zhukov_stalins_2018, natkhov_revealed_2023}), beliefs (\cite{lupu_legacy_2017, schofield_cultural_2015}) and economic performance (\cite{hill_siberian_2003, beissinger_room_2014}) are all affected by the Soviet Leviathan. 

Moreover, if one considers spatial data, it becomes clear that full incorporation of countries within their administrative borders (at least for Eastern Europe) is mostly a phenomenon of the XX century. Due to constant wars, divisions of territory and institutions that could not govern all of the territory, as well as simply lower population densities, different parts of the now post-Soviet countries were incorporated into the Muscovy and its descendant states at different times, creating subnational variation.

The most obvious effect one can think of would be on measures like the generalized trust, following \cite{nunn_slave_2011}. The mechanism could be that distrust comes not from directly from impacts of \textit{Russian} (or any other, except when oppression is a factor) rule, but perhaps through distrust of authority due to territories "trading hands". Since the surveys are not produced at such a scale and censuses don't normally include generalized trust questions, this question is left for causal identification strategies at local level, such as \cite{alesina_good-bye_2007} and \cite{schofield_cultural_2015}.

The lack of consistent institutional framework might be related to the outcomes in \textit{human development}, though. The "common institutional framework" argument would state that longer duration under the Russian rule would bring greater assimilation and better institutions, which would result in higher levels of human development. This constitutes my first hypothesis:

\begin{itemize}
  \item[$H_1$:] Subnational units that have been under Russian rule longer have higher levels of economic development in 2009
\end{itemize}

However, due to violent and invasive way of Soviet pre-war annexations, I wouldn't expect the effect to be similar for Imperial and Soviet periods. I thus refine $H_1$:

\begin{itemize}
  \item[$H_{1a}$:] Subnational units that have been under Russian pre-Imperial and Imperial rule longer have higher levels of human development in 2009
  \item[$H_{1b}$:] Subnational units that have been under Soviet rule longer have lower levels of human development in 2009
\end{itemize}

In light of problematic distribution of the period-disagregated variables, I do not test hypotheses $H_{1a}$ and $H_{1b}$, leaving those variables for further refinement.

\subsection{Repressions}

A large literature emphasizes the long-term effects of repressions on identity and political participation (\cite{rozenas_political_2017, zhukov_stalins_2018, lupu_legacy_2017}). However, identification of the impact on economic development is less clear. In the Soviet Union the \textit{gulag}\footnote{Main Directorate of Correctional Labour Camps, \textit{Glavnoe upravleniе ispravitel'no-trudovyh lagerej}} was not only a penal institution, but also a source of forced labor. An economy based on prison labour might create a specific economic system which has persistent effects. 

Therefore, I also examine effects of having a gulag camp on two variables: economic development, as captured by Gross Regional Product per capita/USD and Human Development Index as in $H_1$. The corresponding hypotheses are the following:

\begin{itemize}
  \item[$H_{2a}$:] Subnational units that had gulag camps during 1923-1967 have lower levels of human development in 2009
  \item[$H_{2b}$:] Subnational units that had gulag camps during 1923-1967 have lower levels of economic development in 2009
\end{itemize}

Those two hypotheses are about simple existence of such camps, however, I also run models with a number of camps rather than a dummy.

\section{Data}

\subsection{Disagregation}

The analysis presented in this paper is predicated on the correct identification of the units in question. Ideally, this research project would be conducted on the municipal level, as it provides several advantages:

\begin{itemize}
  \item Municipalities in most countries are meant to have (at least some) power over economic, social and political issues, which makes them valid self-contained units rather than arbitrary aggregations.
  \item Definitions for what a municipality means in terms of population, territory and nature (for example urban vs rural) are similar across space and time (that is, the dissolution of the USSR didn't change the logic of municipal aggregation), especially since in the Soviet Union municipalities were meant to be uniform across the country as opposed to asymmetrical definitions of Autonomous Republics, Soviet Republics, oblasts and other higher-level divisions.
  \item Identification of effects of having a gulag camp for example benefit greatly from tighter geographical aggregations, as the effects of the camp may be true for a city (or other immediate surroundings) but irrelevant once the whole region is considered. The intersections I build with historical polygons of Russian territory would also be much more precise.
\end{itemize}

However, even compiling historical data from the RSFSR (Russian Soviet Federative Socialist Republic) alone is challenging, while merging and cross-referencing variables collected by different national agencies for different reasons without a common statistical framework such as the European Union is a daunting task indeed. Advances in georeferencing and computational social sciences, however, make such an ambitious research agenda possible in the future. 

As is widely known, analysis on the country-level within regions suffers from lack of statistical power. When applied to the post-soviet states, one gets 15 countries, which are situated in different regions of the world (Eastern Europe, Central Asia and the Baltics), are very different in terms of population and economic situations and all have significant legacies of the Soviet Union and Russian incorporation and/or occupation. 

I therefore turn to different regional divisions:

\begin{itemize}
  \item Level 1 administrative units, which are simply appropriate regional divisions within countries, sometimes with administrative rights (such as in federations like Russia).
  \item NUTS 2 (in Europe), or larger economic statistical units, as they are defined in most countries, typically are aggregations of multiple administrative units, homogenizes by population and GRP to represent equal populations.
\end{itemize}

I strongly prefer level 1 administrative units because regional divisions in countries are seldom arbitrary (that is, the divisions are developed historically), some of the smaller countries in the sample would be united into only one or two big NUTS2-like units, which was the case with Latvia, Lithuania, Estonia, and plans for such a division are present for Moldova, Georgia, Ukraine and other countries that want to join the EU.

For the most part, unfortunately, disagregation in this paper is larger economic areas. This is an attribute of the SHDI dataset, without which most of the analysis is simply not possible. I expand on this issue further in the \textbf{Data Limitations} section.

\subsection{Availability \& variables}

The task of finding comparable data for subnational regions of multiple countries is a problematic endeavor. The first problem is that not all data is collected for all countries and this pattern is non-random. Consider, for example, Turkmenistan, which is by far the most isolated country in the former Soviet Union area and one of the most authoritarian ones: it is abundantly clear that statistical collection and their reliability are determined as much by regime as it is by state capacity (which is more or less equal, considering the lengths Soviet Union went in establishing bureacratic institutions and their persistence (\cite{stewart_presidents_2013})). 

Therefore, data that is collected uniformly throughout the area is of significant value. Such data include geospatial data, such as climate, soil and precipitation and historical variables specifically. Economic data such as that estimated by measuring nightlight intensity provide an additional level of robustness, as it is collected uniformly and allows to measure development even in areas where conventional statistical data fails (such as Turkmenistan, for example.)

I collect information on the following variables:

\subsubsection{Economic and Human Development}

For \textit{Gross Regional Product} I use DOSE - the MCC-PIK \textit{Database Of Sub-national Economic Output}(\cite{wenz_dose_2023}). It contains self-reported (collected and published by national agencies) data on economic development, mainly GRP and GRP by economic sector for a variety of years and disagregated at level 1 administrative units (regions of the country). DOSE is handy because it clusters data by GADM (Database of Global Administrative Areas) areas, which are consistent and georeferenced, allowing for easy mapping and merging with other spatial data not necessarily defined at subnational level\footnote{For one country in the sample, Kazakhstan, GADM boundaries are not ones that the statistical agency uses for reporting, so I use the shapefile provided by \textit{DOSE} authors.}.

I choose the year of 2009 for the dependent variable, as it is the first year when data for all countries in the sample is present. The context surrounding the year is significant: the world was still in Global Financial Crisis, and regionally, Russo-Georgian war ended just a year earlier, which is why I assign a dummy to regions that were affected), in Russia, the legacy of the Chechen wars continued until the formal end of the "Counter-terrorist operation" in 2009 as well. 

For \textit{Human Development Index} I use the SHDI measure compiled by Smits and Permanyer for 2009 (\cite{smits_subnational_2019}). They translate United Nation's HDI into subnational data greatly increasing coverage of developing countries, which include all of the post-soviet states. One issue that is apparent in the data is that data for Russia is presented at the level of federal districts rather than regions. I use the data from the \textit{National Human Development Report in the Russian Federation 2009} to replace data for Russia (\cite{bobylev_national_2010}).

\subsubsection{Creating GRP and HDI}

\AddToHookNext{env/Highlighting/begin}{\tiny}

```{r}
#| label: creating GRP and HDI variables

# Filter DOSE
dose_fsu <- dose_v2 %>%
  # No Armenia, Moldova, Tajikistan and Turkmenistan
  filter(country %in% c("Azerbaijan", "Belarus", "Estonia", "Georgia", 
                        "Kazakhstan", "Kyrgyzstan", "Latvia", "Lithuania", 
                        "Russia", "Ukraine", "Uzbekistan"),
         year == 2009) %>%
  mutate(GID_1.norm = case_when(region == "Harju" ~ "EST.1_1",
                                region == "Põlva" ~ "EST.5_1",
                                region == "Rapla" ~ "EST.3_1",
                                region == "Saare" ~ "EST.2_1",
                                region == "Tartu" ~ "EST.5_1",
                                region == "Valga" ~ "EST.5_1",
                                region == "Viljandi" ~ "EST.5_1",
                                region == "Võru" ~ "EST.5_1",
                                region == "Hiiu" ~ "EST.2_1",
                                region == "Ida-Viru" ~ "EST.4_1",
                                region == "Jõgeva" ~ "EST.5_1",
                                region == "Lääne-Viru" ~ "EST.3_1",
                                region == "Järva" ~ "EST.3_1",
                                region == "Lääne" ~ "EST.2_1",
                                region == "Pärnu" ~ "EST.2_1",
                                # KZ
                                region == "Almaty" ~ "KAZ.1_1",
                                region == "Kostanay" ~ "KAZ.5_1",
                                region == "Kyzylorda" ~ "KAZ.2_1",
                                region == "South Kazakhstan" ~ "KAZ.2_1",
                                region == "West Kazakhstan" ~ "KAZ.3_1",
                                region == "Zhambyl" ~ "KAZ.2_1",
                                region == "Aqmola" ~ "KAZ.5_1",
                                region == "Aktobe" ~ "KAZ.3_1",
                                region == "Atirau" ~ "KAZ.3_1",
                                region == "East Kazakhstan" ~ "KAZ.6_1",
                                region == "Mangistau" ~ "KAZ.3_1",
                                region == "North Kazakhstan" ~ "KAZ.5_1",
                                region == "Pavlodar" ~ "KAZ.3_1",
                                region == "Karagandy" ~ "KAZ.4_1",
                                # KGZ
                                region == "Osh сity" ~ "KGZ.7_1",
                                # UKR
                                region == "Cherkasy" ~ "UKR.2_1",
                                region == "Khmelnytskiy" ~ "UKR.5_1",
                                region == "Kiev" ~ "UKR.1_1",
                                region == "Kyiv City" ~ "UKR.1_1",
                                region == "Kirovohrad" ~ "UKR.2_1",
                                region == "Lviv" ~ "UKR.5_1",
                                region == "Luhansk" ~ "UKR.3_1",
                                region == "Mykolayiv" ~ "UKR.4_1",
                                region == "Odesa" ~ "UKR.4_1",
                                region == "Poltava" ~ "UKR.2_1",
                                region == "Rivne" ~ "UKR.5_1",
                                region == "Chernihiv" ~ "UKR.1_1",
                                region == "Sevastopol" ~ "UKR.4_1",
                                region == "Sumy" ~ "UKR.1_1",
                                region == "Ternopil" ~ "UKR.5_1",
                                region == "Transcarpathia" ~ "UKR.5_1",
                                region == "Vinnytsya" ~ "UKR.2_1",
                                region == "Volyn" ~ "UKR.5_1",
                                region == "Zaporizhzhya" ~ "UKR.3_1",
                                region == "Zhytomyr" ~ "UKR.1_1",
                                region == "Chernivtsi" ~ "UKR.5_1",
                                region == "Autonomous Republic of Crimea" ~ "UKR.4_1",
                                region == "Dnipropetrovsk" ~ "UKR.3_1",
                                region == "Donetsk" ~ "UKR.3_1",
                                region == "Ivano-Frankivsk" ~ "UKR.5_1",
                                region == "Kharkiv" ~ "UKR.3_1",
                                region == "Kherson" ~ "UKR.4_1",
                                # Uzbekistan
                                region == "Andijon" ~ "UZB.5_1",
                                region == "Samarkand" ~ "UZB.2_1",
                                region == "Sirdaryo" ~ "UZB.4_1",
                                region == "Surkhandarya" ~ "UZB.3_1",
                                region == "Tashkent City" ~ "UZB.6_1",
                                region == "Tashkent" ~ "UZB.6_1",
                                region == "Bukhoro" ~ "UZB.2_1",
                                region == "Ferghana" ~ "UZB.5_1",
                                region == "Jizzakh" ~ "UZB.4_1",
                                region == "Karakalpakstan" ~ "UZB.1_1",
                                region == "Kashkadarya" ~ "UZB.3_1",
                                region == "Khorezm" ~ "UZB.1_1",
                                region == "Namangan" ~ "UZB.5_1",
                                region == "Navoi" ~ "UZB.2_1",
                                .default = GID_1))

# Merge DOSE with GADM boundaries, normalize the spatial features
dose_gadm <- merge(dose_fsu, gadm, by = c("GID_0", "GID_1"), 
                   all = T) %>%
  st_as_sf() %>%
  st_zm() %>%
  st_transform(4326) %>%
  st_shift_longitude()

dose_agg <- dose_gadm %>%
  group_by(GID_1.norm, country, PPP, fx) %>%
  summarize(across(11:14, ~ mean(.)),
            pop = sum(pop, na.rm = T),
            T_a = mean(as.numeric(T_a)),
            P_a = mean(as.numeric(P_a)),
            geometry = st_combine(geometry),
            .groups = "drop")

# Prepare HDI data for merging
hdi_fsu <- hdi %>%
  filter(Country != "Russian Federation", Level != "National") %>%
  full_join(hdi_russia, by = join_by("Region" == "...1")) %>%
  mutate(GID_1 = case_when(
                           # Azerbaijan - no data in HDI for Nakhchivan and 
                           # Kalbajar-Lachin
                           Region == "Absheron" ~ "AZE.1_1",
                           Region == "Yukhari Karabakh" ~ "AZE.10_1",
                           Region == "Aran" ~ "AZE.2_1",
                           ## Baku is not a distinct region in GADM
                           Region == "Baku" ~ "AZE.1_1", 
                           Region == "Dakhlik Shirvan" ~ "AZE.3_1",
                           Region == "Ganja Gazakh" ~ "AZE.4_1",
                           Region == "Guba Khachmaz" ~ "AZE.8_1",
                           Region == "Lankaran" ~ "AZE.6_1",
                           Region == "Shaki Zaqatala" ~ "AZE.9_1",
                           # Belarus - perfect
                           Region == "Brest region" ~ "BLR.1_1",
                           Region == "Gomel region" ~ "BLR.2_1",
                           Region == "Grodno region" ~ "BLR.3_1",
                           Region == "Minsk region" ~ "BLR.5_1",
                           Region == "Mogilev region" ~ "BLR.4_1",
                           Region == "Vitebsk region" ~ "BLR.6_1",
                           # Estonia - HDI is economic regions, GADM is regions
                           # (fixed in GADM modifications)
                           Region == "Pohja-Eesti" ~ "EST.1_1",
                           Region == "Laane-Eesti" ~ "EST.2_1",
                           Region == "Kesk-Eesti" ~ "EST.3_1",
                           Region == "Kirde-Eesti" ~ "EST.4_1",
                           Region == "Louna-Eesti" ~ "EST.5_1",
                           # Georgia - some NAs in GRP data
                           Region == "Ajaria" ~ "GEO.2_1",
                           Region == "Guria" ~ "GEO.3_1",
                           Region == 
                             "Imereti Racha-Lochkhumi Kvemo Svaneti" ~ "GEO.8_1",
                           Region == "Kakheti" ~ "GEO.5_1",
                           Region == "Kvemo Kartli" ~ "GEO.6_1",
                           Region == "Mtskheta-Mtianeti" ~ "GEO.7_1",
                           Region == "Samegrelo-Zemo Svateni" ~ "GEO.9_1",
                           Region == "Samtskhe-Javakheti" ~ "GEO.10_1",
                           Region == "Shida Kartli" ~ "GEO.11_1",
                           Region == "Tbilisi" ~ "GEO.12_1",
                           # Kazakhstan - HDI is economic regions, GADM is regions
                           # (fixed in GADM modifications)
                           Region == "Almaty city" ~ "KAZ.1_1",
                           Region ==
  "South region (Almatinskaya, Zhambylskaya, Kyzylordinskaya, South-Kazakhstanskaya)"
                           ~ "KAZ.2_1",
                           Region ==
  "West region (Aktyubinskaya, Atyrauskaya, Mangistauskaya, West-Kazakhstanskaya)"
                           ~ "KAZ.3_1",
                           Region == "Central region (Karagandinskaya)" ~ "KAZ.4_1",
                           Region ==
  "North region (Akmolinskaya (incl Astana city), Kostnaiskaya, Pavlodarskaya, North-Kazakhstanskaya)"
                           ~ "KAZ.5_1",
                           Region ==
                             "East region (East-Kazakhstanskaya)" ~ "KAZ.6_1",
                           # Kyrgyzstan - GADM separates Osh city from Osh 
                           # region, HDI does not
                           Region == "Batken" ~ "KGZ.1_1",
                           Region == "Bishkek" ~ "KGZ.2_1",
                           Region == "Chuy" ~ "KGZ.3_1",
                           Region == "Issyk-Kul" ~ "KGZ.9_1",
                           Region == "Jalal-Abad" ~ "KGZ.4_1",
                           Region == "Naryn" ~ "KGZ.5_1",
                           Region == "Osh" ~ "KGZ.7_1",
                           Region == "Talas" ~ "KGZ.8_1",
                           # Latvia - GADM means Pieriga region by Riga
                           Region == "Kurzeme region" ~ "LVA.1_1",
                           Region == "Latgale region" ~ "LVA.2_1",
                           Region == "Pieriga region" ~ "LVA.3_1",
                           Region == "Riga region" ~ "LVA.3_1",
                           Region == "Vidzeme region" ~ "LVA.4_1",
                           Region == "Zemgale region" ~ "LVA.5_1",
                           # Lithuania - perfect
                           Region == "Alytus County" ~ "LTU.1_1",
                           Region == "Kaunas County" ~ "LTU.2_1",
                           Region == "Klaipeda County" ~ "LTU.3_1",
                           Region == "Marijampole County" ~ "LTU.4_1",
                           Region == "Panevezys County" ~ "LTU.5_1",
                           Region == "Siauliai County" ~ "LTU.6_1",
                           Region == "Taurage County" ~ "LTU.7_1",
                           Region == "Telsiai County" ~ "LTU.8_1",
                           Region == "Utena County" ~ "LTU.9_1",
                           Region == "Vilnius County" ~ "LTU.10_1",
                           # Ukraine - bad, reduced regions that may not reflect
                           # regional differences
                           Region == "North" & Country == "Ukraine" ~ "UKR.1_1",
                           Region == "Central" & Country == "Ukraine" ~ "UKR.2_1",
                           Region == "East" & Country == "Ukraine" ~ "UKR.3_1",
                           Region == "South" & Country == "Ukraine" ~ "UKR.4_1",
                           Region == "West" & Country == "Ukraine" ~ "UKR.5_1",
                           # Uzbekistan - same as Ukraine 
                           Region == "West (Karakalpakstan, Khorezm)" ~ "UZB.1_1",
                           Region ==
                             "Central (Navoi, Bukhara, Samarkand)" ~ "UZB.2_1",
                           Region ==
                             "South (Kashkadarya, Surkhandarya)" ~ "UZB.3_1",
                           Region ==
                             "Central-East (Dzhizak, Syrdarya)" ~ "UZB.4_1",
                           Region ==
                             "East (Namangan, Fergana, Andizhan)" ~ "UZB.5_1",
                           Region == "Tashkent" ~ "UZB.6_1",
                           # Russia
                           Region == "Moscow" ~ "RUS.43_1", 
                           Region == "Tyumen Region" ~ "RUS.73_1", 
                           Region == "St.Petersburg" ~ "RUS.14_1", 
                           Region == "Republic of Tatarstan" ~ "RUS.68_1", 
                           Region == "Belgorod Region" ~ "RUS.7_1", 
                           Region == "Tomsk Region" ~ "RUS.69_1", 
                           Region == "Sakhalin Region" ~ "RUS.61_1", 
                           Region == "Krasnoyarsk Territory" ~ "RUS.35_1", 
                           Region == "Sverdlovsk Region" ~ "RUS.66_1", 
                           Region == "Chelyabinsk Region" ~ "RUS.11_1", 
                           Region == "Orenburg Region" ~ "RUS.53_1", 
                           Region == "Samara Region" ~ "RUS.62_1", 
                           Region == "Lipetsk Region" ~ "RUS.39_1", 
                           Region == "Komi Republic" ~ "RUS.32_1", 
                           Region == "Vologda Region" ~ "RUS.78_1", 
                           Region == "Republic of Bashkortostan" ~ "RUS.6_1", 
                           Region ==
                             "Republic of Sakha (Yakutia)" ~ "RUS.60_1", 
                           Region == "Arkhangelsk Region" ~ "RUS.4_1", 
                           Region == "Novosibirsk Region" ~ "RUS.50_1", 
                           Region == "Omsk Region" ~ "RUS.51_1", 
                           Region == "Yaroslavl Region" ~ "RUS.81_1", 
                           Region == "Republic of Udmurtia" ~ "RUS.74_1", 
                           Region == "Volgograd Region" ~ "RUS.77_1", 
                           Region == "Krasnodar Territory" ~ "RUS.34_1", 
                           Region == "Murmansk Region" ~ "RUS.45_1", 
                           Region ==
                             "Republic of North Ossetia- Alania" ~ "RUS.48_1", 
                           Region == "Kursk Region" ~ "RUS.37_1", 
                           Region == "Moscow Region" ~ "RUS.44_1", 
                           Region == "Orel Region" ~ "RUS.52_1", 
                           Region == "Perm Territory" ~ "RUS.55_1", 
                           Region == "Irkutsk Region" ~ "RUS.18_1", 
                           Region == "Nizhny Novgorod Region" ~ "RUS.47_1", 
                           Region == "Magadan Region" ~ "RUS.40_1", 
                           Region == "Saratov Region" ~ "RUS.63_1", 
                           Region == "Rostov Region" ~ "RUS.58_1", 
                           Region == "Republic of Chuvashia" ~ "RUS.13_1", 
                           Region == "Republic of Mordovia" ~ "RUS.42_1", 
                           Region == "Voronezh Region" ~ "RUS.79_1", 
                           Region == "Kaliningrad Region" ~ "RUS.21_1", 
                           Region == "Kemerovo Region" ~ "RUS.27_1", 
                           Region == "Republic of Khakassia" ~ "RUS.29_1", 
                           Region == "Tambov Region" ~ "RUS.67_1", 
                           Region == "Republic of Karelia" ~ "RUS.26_1", 
                           Region == "Republic of Dagestan" ~ "RUS.15_1", 
                           Region == "Astrakhan Region" ~ "RUS.5_1", 
                           Region == "Khabarovsk Territory" ~ "RUS.28_1", 
                           Region == "Kaluga Region" ~ "RUS.23_1", 
                           Region == "Penza Region" ~ "RUS.54_1", 
                           Region == "Ulyanovsk Region" ~ "RUS.75_1", 
                           Region == "Kamchatka Territory" ~ "RUS.24_1", 
                           Region == "Ryazan Region" ~ "RUS.59_1", 
                           Region ==
                             "Republic of Karachaevo- Cherkessia" ~ "RUS.25_1", 
                           Region == "Tula Region" ~ "RUS.70_1", 
                           Region == "Stavropol Territory" ~ "RUS.65_1", 
                           Region == "Kostroma Region" ~ "RUS.33_1", 
                           Region == "Altai Territory" ~ "RUS.2_1", 
                           Region == "Novgorod Region" ~ "RUS.49_1", 
                           Region == "Smolensk Region" ~ "RUS.64_1", 
                           Region == "Leningrad Region" ~ "RUS.38_1", 
                           Region == "Kirov Region" ~ "RUS.31_1", 
                           Region == "Kurgan Region" ~ "RUS.36_1", 
                           Region == "Vladimir Region" ~ "RUS.76_1", 
                           Region == "Primorskiy Territory" ~ "RUS.56_1", 
                           Region == "Republic of Mari El" ~ "RUS.41_1", 
                           Region == "Republic of Buryatia" ~ "RUS.9_1", 
                           Region == "Tver Region" ~ "RUS.72_1", 
                           Region == "Bryansk Region" ~ "RUS.8_1", 
                           Region ==
    "Republic of Kabardino- Balkaria" ~ "RUS.20_1", 
                           Region == "Amur Region" ~ "RUS.3_1", 
                           Region == "Republic of Adygeya" ~ "RUS.1_1", 
                           Region == "Chukotka Autonomous District" ~ "RUS.12_1", 
                           Region == "Republic of Kalmykia" ~ "RUS.22_1", 
                           Region == "Ivanovo Region" ~ "RUS.19_1", 
                           Region == "Pskov Region" ~ "RUS.57_1", 
                           Region == "Trans-Baikal Territory" ~ "RUS.83_1", 
                           Region == "Republic of Chechnya" ~ "RUS.10_1", 
                           Region == "Jewish Autonomous District" ~ "RUS.82_1", 
                           Region == "Republic of Ingushetia" ~ "RUS.17_1", 
                           Region == "Republic of Altai" ~ "RUS.16_1", 
                           Region == "Republic of Tuva" ~ "RUS.71_1"),
         hdi = case_when(!is.na(HDI) ~ HDI,
                         !is.na(`2009`) ~ `2009`),
         Country = if_else(!is.na(HDI), "Russian Federation", Country),
         Continent = if_else(!is.na(HDI), "Europe", Continent),
         ISO_Code = if_else(!is.na(HDI), "RUS", ISO_Code),
         Level = if_else(!is.na(HDI), "Subnat", Level)) %>%
  select(1:6, GID_1, hdi)

hdi_agg <- hdi_fsu %>%
  group_by(GID_1, Country, Continent, ISO_Code, Level) %>%
  drop_na(GID_1) %>%
  summarize(hdi = mean(hdi), .groups = "drop")


dose.hdi <- merge(dose_agg, hdi_agg, 
                  by.x = "GID_1.norm", by.y = "GID_1", all = T)
```

\subsubsection{GULAGs}

I proxy the spatial distribution of prison system by georeferencing the labour camp map using ArcGIS software. It was produced by the "International Memorial" Russian NGO, labelled as "foreign agent" in 2012 and ordered to liquidate by Russian Supreme Court in 2021.

The map exists in multiple forms - an \href{https://gulag.online/articles/mapa-taborovych-sprav-gulagu-a-pribehu-ze-stredni-evropy?locale=en}{interactive map}\footnote{There are actually two, \href{https://gulagmap.ru/}{here} is the one from the gulag museum in Moscow}, \href{http://old.memo.ru/history/nkvd/gulag/maps/ussri.htm}{on the old website} and have been used in scientific publications (\cite{pallot_mapping_2022}).

I then intersect the points which denote individual camps with subnational units in the data.

\subsubsection{Other variables}

I also create several control variables that denote specific characteristics of regions that might be important. Those include:

\begin{itemize}
  \item Population density
  \item Whether a region is or contains the capital of the country
  \item A dummy for Georgia because of the proximity of Russo-Georgian war
  \item A dummy that denotes all countries that are non-Russia after 1991
\end{itemize}

Other control variables come ready with DOSE dataset. Those include:

\begin{itemize}
  \item Area-weight average annual temperature
  \item Area-weight average annual precipitation
  \item Power Purchasing Parity (proxy for currency strength)
  \item A dummy that denotes all countries that are non-Russia after 1991
\end{itemize}

```{r}
#| label: creating gulag variable and misc processing

sf_use_s2(FALSE)

dose.hdi.dummy <- dose.hdi %>%
  mutate(area = st_area(geometry),
         pop_density = pop/(as.numeric(area)/1000),
         capital = if_else(GID_1.norm %in% c("EST.1_1", "RUS.43_1", "UZB.6_1",
                                             "UKR.1_1", "LTU.10_1", "LVA.3_1",
                                             "KGZ.2_1", "KAZ.2_1", "GEO.12_1",
                                             "BLR.5_1", "AZE.1_1"), 1, 0),
         georgia = if_else(country == "Georgia", 1, 0),
         baltics = if_else(country %in% c("Estonia", "Lithuania", "Latvia"), 1, 0),
         non_russia = if_else(country == "Russia", 0, 1))

gulag_ <- st_transform(gulag, st_crs(dose.hdi.dummy))%>%
  st_shift_longitude() %>%
  st_intersection(dose.hdi.dummy) %>%
  group_by(GID_1.norm) %>%
  summarize(gulag_n = n(), .groups = "drop")

dose.hdi.gulag <- dose.hdi.dummy %>%
  left_join(data.frame(gulag_), by = "GID_1.norm") %>%
  mutate(gulag_n = if_else(is.na(gulag_n), 0, gulag_n),
         gulag_dummy = if_else(gulag_n != 0, 1, 0)) %>%
  drop_na(GID_1.norm, country)

expansion.merge <- expansion %>%
  group_by(id, name) %>%
  summarize(geometry = st_combine(geom), .groups = "drop") %>%
  mutate(start_year = as.numeric(str_sub(name, 6, 9)),
         end_year = as.numeric(str_sub(name, 14, 17)),
         n_years = end_year - start_year)
```

\subsubsection{Length of Russian Rule}

The data for by-period territorial expansion of Russia is taken from the \href{https://map.runivers.ru/?year=1462#}{open data} of the "Russia's borders from 1462 through 2018" Project. 

I start with 1462 to avoid over-estimation of years under Russian rule for Ukranian areas. The data contains 239 separate files with polygons of each state Russia was in during 1462-1991. I overlay each period polygon with each subnational region in 2009 and determine whether they cross or not. For ones that do cross, all of the years (because periods have different gaps between period states) are summed up. I disagregate the variable by three periods: pre Imperial (1462-1721), Imperial (1721-1917) and Soviet (1917-1991).

```{r}
#| label: merging data on territorial expansion by-period
#| eval: false

## Warning: this will eat up all of your memory and (might) crash R session.
## I leave this hear for reproducibility, but later just upload the 4 lists
## that are generated by this chunk


# Clean used memory
gc()

# The geometries become more complex the further into the time we go, so I divide
# the file for processing accordingly

dose.hdi.gulag.exp_1 <- dose.hdi.gulag %>%
  st_intersects(slice(expansion.merge, 1:100))

dose.hdi.gulag.exp_2 <- dose.hdi.gulag %>%
  st_intersects(slice(expansion.merge, 101:150))

dose.hdi.gulag.exp_3 <- dose.hdi.gulag %>%
  st_intersects(slice(expansion.merge, 151:200))

dose.hdi.gulag.exp_4 <- dose.hdi.gulag %>%
  st_intersects(slice(expansion.merge, 201:239))
```

```{r}
#| label: generating years under Soviet rule variable

dose.hdi.gulag.exp <- data.frame(do.call(cbind, 
             list(dose.hdi.gulag.exp_1, dose.hdi.gulag.exp_2, 
                  dose.hdi.gulag.exp_3, dose.hdi.gulag.exp_4))) %>%
  rowwise() %>%
  mutate(X1 = list(X1 + 0),
         X2 = list(X2 + 100),
         X3 = list(X3 + 150),
         X4 = list(X4 + 200)) %>%
  unnest_wider(c(X1, X2, X3, X4), names_sep = "") %>%
  rownames_to_column() %>%
  pivot_longer(cols = 2:240) %>%
  transmute(row = as.numeric(rowname), 
            period_dummy = if_else(!is.na(value), 1, 0),
            id = rep(1:239, times = 151)) %>%
  left_join(st_drop_geometry(expansion.merge), by = "id") %>%
  mutate(era = case_when(end_year < 1721 ~ "pre_empire",
                         end_year >= 1721 & end_year < 1917 ~ "empire",
                         end_year > 1917 ~ "soviet")) %>%
  group_by(row, era) %>%
  filter(period_dummy == 1) %>%
  summarize(n_years = sum(n_years), .groups = "drop") %>%
  pivot_wider(id_cols = "row", names_from = "era", values_from = "n_years") %>%
  mutate(across(2:4, ~if_else(is.na(.), 0, .)),
         n_years = pre_empire + empire + soviet) %>%
  cbind(dose.hdi.gulag) %>%
  st_as_sf()
```

\subsection{Data Limitations}

\subsubsection{Sample}

Firstly, once assembled, the data only covers 11 countries of 15. It excludes:

\begin{itemize}
  \item Armenia
  \item Moldova
  \item Tajikistan
  \item Turkmenistan
\end{itemize}

The data for these countries is actually available -- I was, for example, able to find statistical reports for Armenia, but they were in Armenian and .pdf format, which entailed hand-coding them. Therefore, adding them to the full sample is left for future work.

Those countries could provide further insights or may be important for identifying effects. In particular, because of the absence of Moldova and Armenia and missing data for Abkhazia in Georgian data, I was not able to test the hypothesis of protests, riots and secessionist movements, data for which are available.

Another serious problem pertaining to sampling is that in SHDI data some countries are disagregated not by administrative borders, but by larger economic regions that are sometimes defined as NUTS2 regions. I wanted to specifically avoid using those, because they are higher-level aggregations that combine regions that are very different culturally and historically. The biggest issues could be caused by this aggregation for Ukraine and Uzbekistan, which I had to keep because HDI developed with the UN methodology is not available for administrative regions.

Consider the following maps of Ukraine -- the first one is created by SHDI database, the second one represents a map made in the analysis of regional HDI in Ukraine, using a slightly different methodology (\cite{kuzyshyn_geospatial_2014}):

```{r}
#| label: shdi ukraine

dose.hdi.gulag.exp %>%
  filter(country == "Ukraine") %>%
ggplot() + 
    geom_sf(aes(fill = hdi*100)) +
    geom_sf(data = filter(gadm_countries, NAME_0 == "Ukraine"), color = "black", fill = NA) +
    scale_fill_viridis(option = "C") +
    labs(title = "Subnational HDI in Ukraine",
         subtitle = "Dissagregated by large economic areas",
         fill = "HDI",
         caption = "Source: SHDI, 2023") +
    theme_void()
```


\includegraphics{hdi_ukraine.png}

The large aggregation definitely overlooks inter-regional differences in Lviv, Uzhgorod and other regions in the West, and between Kharkiv and Donetsk in the East, which is especially impactful because Ukraine is one of the larger countries with a significant history of both Russian opression and assimilation.

\subsubsection{Ommited variables}

Apart from the variables that might be confounders but I have no way to control for except for employing a different identification strategy, there are variables that I would have preffered to include in the analysis as there are data for them, but was unable to due to the need to geocode them manually (which as you can begin to suspect is the case with much of the russian and soviet data).

Those include:

\begin{itemize}
  \item Employment structure in 1989 from the Soviet Union Industrial Census, used as a proxy by \cite{natkhov_revealed_2023} for Soviet misallocations as defined by \cite{beissinger_room_2014, hill_siberian_2003}.
  \item Disaggregated data for protests and riots in 1987-1992, used in the book \cite{beissinger_nationalist_2002}.
  \item Some data from the 1989 Census denoting socio-demographic characteristics of regions.
  \item Alternative version of the economic development, as measured by nightlights, for example from \href{https://blackmarble.gsfc.nasa.gov/#home}{NASA's Black Marble}.
\end{itemize}

\subsection{Descriptive statistics}

```{r}
#| label: descriptive statistics
#| results: asis

summary_df <- as.data.frame(dose.hdi.gulag.exp) %>%
  select(-row, -GID_1.norm, -country, -fx, -Continent, -ISO_Code, -Level, -area,
         -geometry.x, -geometry.y)

colnames(summary_df) <- c("Years under Russian rule: Empire",
                          "Years under Russian rule: pre-Empire",
                          "Years under Russian rule: Soviet",
                          "Years under Russian rule: Total",
                          "2009 Purchasing Power Parity",
                          "2009 GRP per capita, USD",
                          "2009 Agricultural GRP per capita, USD",
                          "2009 Manufacturing GRP per capita, USD",
                          "2009 Services GRP per capita, USD",
                          "Population",
                          "Area-weighted annual mean temperature",
                          "Area-weighted annual mean precepitation",
                          "Country",
                          "Human Development Index",
                          "Population Density",
                          "Does this region contain a capital?",
                          "Georgia dummy",
                          "Baltics dummy",
                          "Non-Russia dummy",
                          "Gulag: number of camps",
                          "Gulag: dummy")
dfSummary(summary_df,
          varnumbers = F, labels.col = F, 
          valid.col = F, na.col = F, headings = F,
          plain.ascii = FALSE, style = "grid",
          tmp.img.dir = "/tmp")
```

\subsubsection{Distribution of dependent variables}

```{r}
#| label: vizualizing spatial distributions - dependents
#| eval: false

p1 <- dose.hdi.gulag.exp %>%
  ggplot() + 
    geom_sf(aes(fill = hdi*100)) +
    geom_sf(data = gulag, color = "lightblue", size = .5) +
    geom_sf(data = gadm_countries, color = "black", fill = NA) +
    scale_fill_viridis(option = "C", 
                       breaks = seq(60, 100, 10), limits = c(60, 100)) +
    labs(title = "Former Soviet Union area by UN Human Development Index",
         subtitle = "Dissagregated by administrative units",
         caption = "Source: United Nations, 2010; SHDI, 2023",
         fill = "HDI (0 to 100)\n") +
    theme_void()+
    coord_sf(xlim = c(20, 200))

ggsave(filename = "p1.png", plot = p1)

p2 <- dose.hdi.gulag.exp %>%
  ggplot() + 
    geom_sf(aes(fill = grp_pc_usd/100)) +
    geom_sf(data = gulag, color = "lightblue", size = .5) +
    geom_sf(data = gadm_countries, color = "black", fill = NA) +
    scale_fill_viridis(option = "C", breaks = seq(0, 300, 100), 
                       limits = c(0, 300), end = 0.85) +
    labs(title = "Former Soviet Union countries by 2009 GRPpc in constant thousands of USD",
         subtitle = "Dissagregated by administrative units",
         caption = "Source: DOSE v2, 2023",
         fill = "GRPpc, thousands of $\n") +
    theme_void()+
    coord_sf(xlim = c(20, 200))

ggsave(filename = "p2.png", plot = p2)
```
\begin{figure}[H]
\includegraphics[width=0.7\linewidth]{p1.png}
\includegraphics[width=0.7\linewidth]{p2.png}
\end{figure}

\subsubsection{Distribution of independent variables}

When vizualizing the "Russian Rule" distributions, it becomes apparent that the disagregation by period in case of Empire and Soviet eras is not informative. I therefore only deploy the aggregate years displayed.

```{r}
#| label: vizualizing spatial distributions - independent
#| eval: false

p3 <- dose.hdi.gulag.exp %>%
  mutate(across(c("pre_empire", "empire", "soviet"), ~ (./max(.))*100),
         "Pre-Empire" = pre_empire,
         "Empire" = empire,
         "Soviet Union" = soviet) %>%
  pivot_longer(cols = c("Pre-Empire", "Empire", "Soviet Union")) %>%
  ggplot() + 
    geom_sf(aes(fill = value)) +
    geom_sf(data = gadm_countries, color = "black", fill = NA) +
    scale_fill_viridis(option = "C", direction = -1) +
    facet_wrap(~ name, nrow = 3) +
    labs(title = "Former Soviet Union area by time under Russian Rule",
         subtitle = "Dissagregated by administrative units",
         caption = "Source: Borders of Russia Project, own calculations",
         fill = "% of years\n") +
    theme_void()+
    coord_sf(xlim = c(20, 200))

ggsave(filename = "p3.png", plot = p3)

p4 <- dose.hdi.gulag.exp %>%
  ggplot() + 
    geom_sf(aes(fill = n_years)) +
    geom_sf(data = gulag, color = "lightblue", size = .5) +
    geom_sf(data = gadm_countries, color = "black", fill = NA) +
    scale_fill_viridis(option = "C") +
    labs(title = "Former Soviet Union area buy years under Russian Rule",
         subtitle = "Dissagregated by administrative units",
         caption = "Source: Borders of Russia Project, own calculations",
         fill = "Years\n") +
    theme_void()+
    coord_sf(xlim = c(20, 200))

ggsave(filename = "p4.png", plot = p4)

p5 <- dose.hdi.gulag.exp %>%
  ggplot() + 
    geom_sf(aes(fill = gulag_n)) +
    geom_sf(data = gulag, color = "lightblue", size = .5) +
    geom_sf(data = gadm_countries, color = "black", fill = NA) +
    scale_fill_viridis(option = "C") +
    labs(title = "Former Soviet Union area by number of gulag camps",
         subtitle = "Dissagregated by administrative units",
         caption = "Source: Memorial, 1998",
         fill = "Number of camps\n") +
    theme_void() +
    coord_sf(xlim = c(20, 200))

ggsave(filename = "p5.png", plot = p5)

p6 <- dose.hdi.gulag.exp %>%
  ggplot() + 
    geom_sf(aes(fill = gulag_n/(as.numeric(area)/1000))) +
    geom_sf(data = gulag, color = "lightblue", size = .5) +
    geom_sf(data = gadm_countries, color = "black", fill = NA) +
    scale_fill_viridis(option = "C") +
    labs(title = "Former Soviet Union area by number of gulag camps per km^2",
         subtitle = "Dissagregated by administrative units\n",
         caption = "Source: Memorial, 1998") +
    theme_void() +
    theme(legend.position = "none") +
    coord_sf(xlim = c(20, 200))

ggsave(filename = "p6.png", plot = p6)
```
\begin{figure}[H]
\includegraphics{p3.png}
\end{figure}

\begin{figure}[H]
\includegraphics[width=0.7\linewidth]{p4.png}
\includegraphics[width=0.7\linewidth]{p5.png}
\end{figure}

\begin{figure}[H]
\includegraphics[width=0.7\linewidth]{p6.png}
\end{figure}

\section{Empirical analysis}

\subsection{Russian Rule and Human Development}

I first test $H_1$: subnational units that have been under Russian Rule longer have higher levels of human development in 2009.

```{r}
#| label: h1
#| results: asis

m1.0 <- lm(I(hdi*100) ~ I(n_years/100), 
         data = dose.hdi.gulag.exp)

m1.1 <- lm(I(hdi*100) ~ I(n_years/100) + I(grp_pc_usd/1000) + gulag_dummy
         + log(pop) + pop_density + PPP, 
         data = dose.hdi.gulag.exp)

m1.2 <- lm(I(hdi*100) ~ I(n_years/100) + I(grp_pc_usd/1000) + gulag_dummy
         + log(pop) + pop_density + PPP + T_a + P_a , 
         data = dose.hdi.gulag.exp)

m1.3 <- lm(I(hdi*100) ~ I(n_years/100) + I(grp_pc_usd/1000) + gulag_dummy
         + log(pop) + pop_density + PPP + T_a + P_a + non_russia + capital
         + georgia + baltics, 
         data = dose.hdi.gulag.exp)

m1.4 <- lm(I(hdi*100) ~ I(n_years/100) + I(grp_pc_usd/1000) + gulag_dummy
         + log(pop) + pop_density + PPP + T_a + P_a + non_russia + capital
         + georgia + baltics, 
         data = dose.hdi.gulag.exp)

rse1.4 <- sqrt(diag(vcovHC(m1.4, type = "HC1")))

m1.5 <- rlm(I(hdi*100) ~ I(n_years/100) + I(grp_pc_usd/1000) + gulag_dummy
         + log(pop) + pop_density + PPP + T_a + P_a + non_russia + capital
         + georgia + baltics, 
         data = dose.hdi.gulag.exp)

rse1.5 <- sqrt(diag(vcovHC(m1.5, type = "HC1")))

resizebox.stargazer(m1.0, m1.1, m1.2, m1.3, m1.4, m1.5, 
          table.placement = "H",
          title = "Testing Hypothesis I", 
          se = c(list(NULL, NULL, NULL, NULL, rse1.4, rse1.5)),
          dep.var.labels = "2009 Human Development Index (0 to 100)",
          covariate.labels = c(
              "Hundred Years under Russian Rule",
              "2009 GRP per capita, thousands USD",
              "Gulag Dummy",
              "Logarithm of population",
              "Population density",
              "Purchasing Power Parity",
              "Average annual temperature",
              "Average annual precipitation",
              "Not Russia",
              "Includes a capital",
              "Georgia",
              "Baltic states"
          ),
          model.names = F,
          column.labels = c("Null", "$+$Main controls", "$+$Fundamentals", "$+$Dummies",
                            "Robust errors", "Robust Linear Regression"),
          model.numbers = F,
          header = F,
          add.lines = 
            list(c("Robust Standard Errors?", 
                   "No", "No", "No",  "No", "Yes", "Yes")),
          tab.width = "\\textwidth",
          tab.height = "\\textheight")
```

Based on these results, there is at least some evidence in support of $H_1$: increase of a 100 years in Russian Rule (most of which can be attributed to pre-Imperial period as evidenced by the "Descriptive Statistics" section) leads to an increase of about 6. Interestingly, results are valid even when controlling with dummy variables, which I thought would eliminate a lot of variance.

\subsection{Legacies of the GULAG system}

Testing $H_2$:

```{r}
#| label: H2
#| results: asis

m2.1 <- lm(I(hdi*100) ~ gulag_n + I(n_years/100) + I(grp_pc_usd/1000)
           + log(pop) + pop_density + PPP + T_a + P_a + non_russia + capital
           + georgia + baltics, 
           data = dose.hdi.gulag.exp)

m2.2 <- lm(I(hdi*100) ~ I(gulag_n/(as.numeric(area)/1000000000))
           + I(n_years/100) + I(grp_pc_usd/1000)
           + log(pop) + pop_density + PPP + T_a + P_a + non_russia + capital
           + georgia + baltics, 
           data = dose.hdi.gulag.exp)

m2.3 <- lm(I(grp_pc_usd/1000) ~ gulag_n + I(n_years/100) + I(hdi*100)
           + pop_density + PPP + T_a + P_a + non_russia + capital
           + georgia + baltics, 
           data = dose.hdi.gulag.exp)

m2.4 <- lm(I(grp_pc_usd/1000) ~ I(gulag_n/(as.numeric(area)/1000000000))
           + I(n_years/100) + I(hdi*100)
           + pop_density + PPP + T_a + P_a + non_russia + capital
           + georgia + baltics,
           data = dose.hdi.gulag.exp)


resizebox.stargazer(m2.1, m2.2, m2.3, m2.4,
          table.placement = "H",
          title = "Testing Hypothesis II", 
          dep.var.labels = c("2009 Human Development Index (0 to 100)", 
                             "2009 GRP per capita, thousands USD"),
          covariate.labels = c(
              "Number of Gulag camps",
              "Number of Gulag camps per 1000 squared km",
              "Hundred Years under Russian Rule",
              "2009 GRP per capita, thousands USD",
              "Logarithm of population",
              "2009 Human Development Index (0 to 100)",
              "Population density",
              "Purchasing Power Parity",
              "Average annual temperature",
              "Average annual precipitation",
              "Not Russia",
              "Includes a capital",
              "Georgia",
              "Baltic states"
          ),
          model.names = F,
          model.numbers = F,
          header = F,
          tab.width = "\\textwidth",
          tab.height = "\\textheight")
```

Based on two models with full sets of controls, I detect no effect of gulag camps (with different operationalizations) on human or economic development. As outlined earlier, this may be due to aggregation to the higher level than effect travels across. This is also supported by the correct sign of the predictors for the economic development models. Therefore, I do not consider this model a definitive rejection of the hypothesis.

\section{Robustness Exercises}

Running some simple diagnostics for the full model for $H_1$:

```{r}
#| label: diagnosing models for H1

kable(data.frame(vif(m1.3), row.names = c(
              "Hundred Years under Russian Rule",
              "2009 GRP per capita, thousands USD",
              "Gulag Dummy",
              "Logarithm of population",
              "Population density",
              "Purchasing Power Parity",
              "Average annual temperature",
              "Average annual precipitation",
              "Not Russia",
              "Includes a capital",
              "Georgia",
              "Baltic states"
          )), 
      booktabs = T, digits = 2, row.names = T, 
      col.names = "VIF (> 5 is a problem)") %>% 
  kable_styling(latex_options = c("hold_position", "scale_down"),
                font_size = 7) 

plot(m1.3, which = 4, id.n = 3)

dose.hdi.gulag.exp %>%
  drop_na(hdi) %>% 
  mutate(pred = predict(m1.3)) %>%
  ggplot(aes(x = hdi*100, y = pred)) +
  geom_abline(lty = 2) +
  geom_point(size = 1, alpha = .5) +
  coord_obs_pred() +
  scale_x_continuous(limits = c(50, 100),
                     breaks = seq(50, 100, 10)) +
  scale_y_continuous(limits = c(50, 100),
                     breaks = seq(50, 100, 10)) +
  labs(x = "\nHDI",
       y = "Predicted\n",
       title = "Predicted vs Actual values") +
  theme_minimal()

data.frame(m1.3$residuals) %>% 
  ggplot(aes(m1.3$residuals)) +
    geom_density(adjust = 2) +
    stat_function(fun = dnorm, args = list(mean = mean(m1.3$residuals),
                                           sd = sd(m1.3$residuals)),
                  color = "red") +
    labs(x = "\nResiduals",
         y = "",
         title = "Residuals vs Normal distribution"
         ) +
    theme_minimal() +
    theme(axis.ticks.y = element_blank(),
          axis.text.y = element_blank())
```

The diagnostics do not reveal anything worrying, suggesting that Hypothesis I indeed has partial confirmation.

\section{Discussion}

To conclude this paper, I want to reiterate that this is an exploratory endeavor and the results are definitely not correctly identified in the broader context. Identification of Soviet Legacies' persistent effects on both macro- and micro- scales requires careful attention to controlling both modern and historical confounders, the data for which was simply not present in this paper. A more robust analysis would incorporate robustness checks to avoid ecological fallacies, which are definitely present from the Human Development in Ukraine example. Ommited variable bias is also a substantial issue. Importantly, it might not be the effect of Russian control I identify above, but actually the effect of strength (or rather lack thereof) of pre-modern institutions.

Nevertheless, some cross-sectional support for Hypothesis I is hopeful, even considering a not-very-large effect size. While I reject $H_2$ in its entirety, a more granular approach to data might prove successful in establishing the effect of the gulag system, which I remain convinced is substantial.

\section{A note on code and rendering}

The rendering of such a large project in one file has been an issue. I prefer to first generate data via a simple R script and then work with it in a quarto document to avoid having large objects in-memory, rendering maps with lots of complex features and running computationally expensive geospatial operations. This is why some of the chucks are labelled with "eval: false" and the results uploaded elsewhere. For replication purposes, you can still run the original operations.

\printbibliography
