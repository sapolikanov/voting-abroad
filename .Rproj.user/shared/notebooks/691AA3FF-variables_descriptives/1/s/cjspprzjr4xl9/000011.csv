"0","#| label: time to the voting station"
"0",""
"0","ep_raw_clean |> "
"0","  group_by(time_to_vs, .drop = F) |> "
"0","  summarise(n = length(time_to_vs)) |>"
"0","  mutate(pct = (n/sum(n)),"
"0","         lbl = if_else(pct > 0.02, scales::percent(pct), NA),"
"0","         time_to_vs = if_else(is.na(time_to_vs), ""No Data"", time_to_vs),"
"0","         time_to_vs = factor(time_to_vs, "
"0","                               levels = c(""<30 minutes"", ""30 minutes - 1 hour"","
"0","                                          ""1 - 2 hours"", ""2 - 3 hours"", ""> 2 hours"","
"0","                                          ""3 - 4 hours"", ""> 4 hours (staying for the night)"","
"0","                                          ""Declined to answer"", ""No Data""))) |> "
"0","  ggplot(aes(x = n, y = time_to_vs,"
"0","             fill = time_to_vs)) +"
"0","    geom_bar(stat = ""identity"", color = ""black"") +"
"0","    geom_text(aes(label = lbl), size = 3, position = position_stack(vjust = 0.5)) +"
"0","    scale_fill_manual(values = c(""#FFC374"", ""#F9E897"", ""#b3c58b"", ""#7F9F80"", ""#007682"", "
"0","                                 ""#124076"", ""#872c76"", ""#bf212f"", ""#bf212f"")) +"
"0","    labs(x = ""\nNumber of respondents"","
"0","         y = """","
"0","         title = ""Time to voting station across all observations"","
"0","         subtitle = paste(""N ="", nrow(ep_raw_clean))) +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"")"
