"0","#| label: adjusting time to the voting station"
"0",""
"0","ep_raw_tvs <- ep_raw_dem |> "
"0","  mutate(time_to_vs.less_than_hour = case_when("
"0","    time_to_vs %in% c(""<30 minutes"", ""30 minutes - 1 hour"") ~ ""Yes"","
"0","    time_to_vs %in% c(""1 - 2 hours"", ""2 - 3 hours"", ""> 2 hours"","
"0","                      ""3 - 4 hours"", ""> 4 hours (staying for the night)"") ~ ""No"","
"0","    .default = ""No Data""),"
"0","         time_to_vs.more_than_4hours = case_when("
"0","    time_to_vs == ""> 4 hours (staying for the night)"" ~ ""Yes"","
"0","    time_to_vs %in% c(""<30 minutes"", ""30 minutes - 1 hour"","
"0","                      ""1 - 2 hours"", ""2 - 3 hours"", ""> 2 hours"","
"0","                      ""3 - 4 hours"") ~ ""No"","
"0","    .default = ""No Data""))"
"0",""
"0","ep_raw_tvs |> "
"0","  filter(!countryname_en %in% c(""Australia"", ""New Zealand"")) |> "
"0","  pivot_longer(cols = c(time_to_vs.less_than_hour,"
"0","                        time_to_vs.more_than_4hours)) |> "
"0","  group_by(name, value) |> "
"0","  summarise(n = length(value)) |> "
"0","  mutate(pct = n/sum(n)*100,"
"0","         name = case_when(name == ""time_to_vs.less_than_hour"""
"0","                          ~ ""Less than an hour to get to the voting station"","
"0","                          name == ""time_to_vs.more_than_4hours"""
"0","                          ~ ""More than 4 hours to get to the voting station"")) |> "
"0","  ggplot(aes(x = pct, y = value,"
"0","             fill = name)) +"
"0","      geom_bar(stat = ""identity"", color = ""black"") +"
"0","      geom_text(aes(label = n), size = 3, position = position_stack(vjust = 0.5)) +"
"0","      scale_fill_manual(values = c(""#FFC374"", ""#7F9F80"")) +"
"0","      scale_x_continuous(limits = c(0, 80),"
"0","                         breaks = seq(0, 80, 10),"
"0","                         label = scales::label_number(suffix = ""%"")) +"
"0","      facet_wrap(~ name, nrow = 2) +"
"0","      labs(x = ""\nPercent of respondents"","
"0","           y = """","
"0","           title = ""Time to voting station, adjusted"","
"0","           subtitle = paste("
"0","             ""N ="", nrow(filter(ep_raw_clean,!countryname_en %in% c(""Australia"","
"0","                                                               ""New Zealand"")))"
"0","                            ),"
"0","           caption = "
"0","             ""Note: Australia and New Zealand not included in the count as there are no data for them"") +"
"0","      theme_minimal() +"
"0","      theme(legend.position = ""none"")"
"2","`summarise()` has grouped output by 'name'. You can override using the `.groups` argument."
