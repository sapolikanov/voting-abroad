"0","#| label: adjusting trust in the result"
"0",""
"0","ep_raw_trst <- ep_raw_out |> "
"0","  mutate(result_trust_bin = case_when(result_trust %in% c(""Probably no"", ""Definitely no"") ~ ""No"","
"0","                                      result_trust %in% c(""Probably yes"", ""Definitely yes"") ~ ""Yes"","
"0","                                      result_trust == ""Declined to answer"" | is.na(result_trust) ~ ""No Data"","
"0","                                      .default = result_trust))"
"0",""
"0","ep_raw_trst |> "
"0","  filter(!countryname_en %in% c(""Australia"", ""New Zealand"")) |> "
"0","  group_by(result_trust_bin) |> "
"0","  summarise(n = n()) |> "
"0","  mutate(pct = round(n/sum(n), 4),"
"0","         lbl = if_else(pct < 0.01, NA, scales::percent(pct)),"
"0","         result_trust_bin = factor(result_trust_bin,"
"0","                                   levels = c(""No"", ""Yes"", ""Don't know"", ""No Data""))) |> "
"0","  ggplot(aes(x = n, y = result_trust_bin,"
"0","             fill = result_trust_bin)) +"
"0","    geom_bar(stat = ""identity"", color = ""black"") +"
"0","    geom_text(aes(label = lbl), size = 3, position = position_stack(vjust = 0.5)) +"
"0","    scale_fill_manual(values = c(""#FFC374"", ""#F9E897"", ""#7F9F80"", "
"0","                                 ""#bf212f"", ""#bf212f"")) +"
"0","    scale_x_continuous(limits = c(0, 50000),"
"0","                       breaks = seq(0, 50000, 5000)) +"
"0","    labs(x = ""\nNumber of respondents"","
"0","         y = """","
"0","         title = ""Trust in the outcome of the election"","
"0","         subtitle = ""N = 68.593 with Australia and NZ excluded"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"")"
