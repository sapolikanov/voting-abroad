"0","#| label: demography"
"0",""
"0","# Demographic"
"0",""
"0","## Original data"
"0","ep_raw_clean |> "
"0","  mutate(sex = if_else(is.na(sex), ""No Data"", sex), "
"0","         age_bin = if_else(is.na(age_bin), ""No Data"", age_bin)) |> "
"0","  group_by(sex, age_bin) |> "
"0","  summarize(n = n()) |> "
"0","  mutate(pct = n/sum(n)*100) |> "
"0","  ggplot(aes(x = pct, y = age_bin, fill = age_bin)) +"
"0","    geom_bar(stat = ""identity"", color = ""black"") +"
"0","    geom_text(aes(label = n), size = 3, position = position_stack(vjust = 0.5)) +"
"0","    facet_wrap(~ sex, nrow = 5) +"
"0","    scale_fill_manual(values = c(""#FFC374"", ""#F9E897"", ""#7F9F80"", "
"0","                                 ""#124076"", ""#bf212f"", ""#bf212f"")) +"
"0","    scale_x_continuous(limits = c(0, 100),"
"0","                       breaks = seq(0, 100, 10),"
"0","                       label = scales::label_number(suffix = ""%"")) +"
"0","    labs(x = ""\nPercent of questionnaires"","
"0","         y = """","
"0","         title = ""Demographic composition of poll questionnaires across all observations"","
"0","         subtitle = paste(""Including missing data patterns, `No Data` = NA in the data,\nN ="", nrow(ep_raw_clean))) +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"")"
"2","`summarise()` has grouped output by 'sex'. You can override using the `.groups` argument."
