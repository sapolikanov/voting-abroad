"0","ep_raw_dep |> "
"0","  filter(!countryname_en %in% c(""Australia"", ""New Zealand"")) |> "
"0","  group_by(out_of_Russia_time, vote) |> "
"0","  summarise(n = n()) |> "
"0","  mutate(pct = round(n/sum(n), 4),"
"0","         lbl = if_else(pct < 0.1, NA, n),"
"0","         out_of_Russia_time = factor(out_of_Russia_time,"
"0","           levels = c(""After invasion"", ""2 - 5 years"", ""After annexation"","
"0","                      ""Before annexation"", ""Tourist (lives in Russia)"", ""No Data""))) |> "
"0","  ggplot(aes(x = pct, y = out_of_Russia_time,"
"0","             fill = reorder(vote, pct))) +"
"0","    geom_bar(stat = ""identity"", color = ""black"", position = ""fill"") +"
"0","    geom_text(aes(label = lbl), size = 3, position = position_stack(vjust = 0.5)) +"
"0","    scale_fill_manual(values = c(""#bf212f"", ""#872c76"",  ""#FFC374"", ""#7F9F80"", "
"0","                                 ""#bf212f"", ""#124076"", ""#b3c58b"")) +"
"0","    scale_x_continuous(limits = c(0, 1),"
"0","                       breaks = seq(0, 1, 0.2), "
"0","                       labels = scales::label_number(scale = 100, suffix = ""%"")) +"
"0","    labs(x = ""\nShare of respondents"","
"0","         y = """","
"0","         title = ""Time living outside of Russia, adjusted and vote choice"","
"0","         subtitle = ""N = 68.593 with Australia and NZ excluded"") +"
"0","    theme_minimal()"
"1","[38;5;254m`summarise()` has grouped output by 'out_of_Russia_time'. You can override using the `.groups` argument.[39m
"
"2","Warning:"
"2"," [38;5;254mRemoved 27 rows containing missing values or values outside the scale range (`geom_text()`).[39m
"
