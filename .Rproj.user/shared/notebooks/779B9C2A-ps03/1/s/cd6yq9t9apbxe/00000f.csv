"0","#| label: building dependents"
"0",""
"0","ep_raw_dep <- ep_raw_trst |> "
"0","  mutate(vote_putin = if_else(vote == ""Putin"", 1, 0),"
"0","         vote_davankov = if_else(vote == ""Davankov"", 1, 0),"
"0","         vote_spoiled = if_else(vote == ""Spoiled ballot"", 1, 0),"
"0","         vote_opposition = if_else(vote %in% c(""Davankov"", ""Spoiled ballot""), "
"0","                                   1, 0),"
"0","         vote_declined = if_else(vote == ""Declined to answer"", 1, 0),"
"0","         vote_putin_declined = if_else(vote %in% c(""Putin"", ""Declined to answer""), 1, 0),  "
"0","         nest1_putin = vote_putin,"
"0","         nest1_nonsystemic = case_when("
"0","           vote %in% c(""Davankov"", ""Spoiled ballot"") ~ 1,"
"0","           vote %in% c(""Slutsky"", ""Haritonov"") ~ 0, "
"0","           .default = NA),"
"0","         nest1_opposition = case_when(vote == ""Davankov"" ~ 1,"
"0","                                      vote == ""Spoiled ballot"" ~ 0, "
"0","                                      .default = NA),"
"0","         nest1_sysopposition = case_when(vote == ""Slutsky"" ~ 1,"
"0","                                         vote == ""Haritonov"" ~ 0,"
"0","                                         .default = NA))"
"0",""
"0","ep_raw_dep |> "
"0","  filter(!countryname_en %in% c(""Australia"", ""New Zealand"")) |> "
"0","  group_by(vote) |> "
"0","  summarise(n = n()) |> "
"0","  mutate(pct = round(n/sum(n), 4),"
"0","         lbl = if_else(pct < 0.02, NA, scales::percent(pct)),"
"0","         result_trust_bin = factor(vote,"
"0","                                   levels = c(""Putin"", ""Davankov"", "
"0","                                              ""Spoiled ballot"", ""Slutsky"", "
"0","                                              ""Haritonov"", ""Tore up/took"", "
"0","                                              ""Declined to answer""))) |> "
"0","  ggplot(aes(x = n, y = reorder(vote, n),"
"0","             fill = vote)) +"
"0","    geom_bar(stat = ""identity"", color = ""black"") +"
"0","    geom_text(aes(label = lbl), size = 3, position = position_stack(vjust = 0.5)) +"
"0","    scale_fill_manual(values = c(""#b3c58b"", ""#bf212f"",   "
"0","                                 ""#FFC374"",""#124076"", ""#E6A167"", ""#7F9F80"",""#872c76"")) +"
"0","    scale_x_continuous(limits = c(0, 35000),"
"0","                       breaks = seq(0, 35000, 5000)) +"
"0","    labs(x = ""\nNumber of respondents"","
"0","         y = """","
"0","         title = ""Voting choices"","
"0","         subtitle = ""N = 68.593 with Australia and NZ excluded"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""none"")"
