"0","#| label: country-level differences"
"0",""
"0","ep_mice_prep |> "
"0","  filter(!countryname_en %in% c(""New Zealand"", ""Australia"")) |> "
"0","  group_by(countryname_en) |> "
"0","  summarize(vote_na = sum(vote == ""Declined to answer""),"
"0","            vote = n()) |> "
"0","  mutate(share = vote_na/vote) |> "
"0","  ggplot(aes(x = share, y = reorder(countryname_en, share),"
"0","             label = paste0(vote_na, "" / "", vote), fill = vote)) +"
"0","    geom_bar(stat = ""identity"") +"
"0","    geom_text(size = 3, hjust = -0.5, position = position_dodge(width = 1), "
"0","              inherit.aes = TRUE) +"
"0","    scale_x_continuous(limits = c(0, 0.7),"
"0","                       breaks = seq(0, 0.7, 0.1),"
"0","                       labels = scales::label_number(scale = 100,"
"0","                                                     suffix = ""%"")) +"
"0","    scale_fill_gradient2(low = ""#bf212f"", mid = ""#F9E897"", high = ""#b3c58b"","
"0","                         midpoint = 2000) +"
"0","    labs(x = ""\nShare of Declined to answer"","
"0","         y = NULL, fill = ""N of respondents"","
"0","         title = ""Share and counts of those declined to disclose their vote"","
"0","         subtitle = ""By country and absolute number of respondents"") +"
"0","    theme_minimal() "
