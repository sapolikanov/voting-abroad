{
  "hash": "804cd4ecefd9db5ea02c20c425672c4d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Individual-level analysis: mixed effects models\"\nsubtitle: \"Part of the final project for AQMSS II\"\nauthor: \"Polikanov Stepan and Okisheva Vera\"\nformat: pdf\nembed-resources: true\nexecute: \n  echo: true\n  warning: false\n  error: false\n  message: false\n---\n\n\n# Mixed effects models\n\n## Nested Logit\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(here::here(\"utilities\", \"check_packages.R\"))\nsource(here::here(\"utilities\", \"functions.R\"))\n\nconflicts_prefer(dplyr::filter)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nep_raw_dep <- read_rds(here(\"data\", \"data_built\", \"ep_raw_dep.rds\"))\ndata_country <- read_rds(here(\"data\", \"data_built\", \"data_country.rds\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nload(here(\"scripts\", \"models\", \"feme_bobyqa.RData\"))\nload(here(\"scripts\", \"models\", \"nlme_bobyqa.RData\"))\nload(here(\"scripts\", \"models\", \"me_allfit.RData\"))\nload(here(\"scripts\", \"models\", \"nl_fe.RData\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Recode no data back to native NA\nmodel_data <- ep_raw_dep |> \n  mutate(across(c(sex, age_bin, time_to_vs.less_than_hour, \n                  time_to_vs.less_than_hour, out_of_Russia_time, \n                  result_trust_bin), \n                ~ if_else(. %in% c(\"No Data\", \"Declined to answer\"), NA, .)),\n         vote = relevel(as.factor(vote), ref = \"Putin\"),\n         sex = relevel(as.factor(sex), ref = \"Male\"),\n         age_bin = relevel(as.factor(age_bin), ref = \"25-44\"),\n         out_of_Russia_time = relevel(as.factor(out_of_Russia_time), ref = \"Before annexation\"),\n         result_trust_bin = relevel(as.factor(result_trust_bin), ref = \"Yes\")) |> \n  filter(!countryname_en %in% c(\"New Zealand\", \"Australia\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Drop Australia and New Zealand for this because they have very skewed and low \n# n observations. Might also help with convergence\nnested_me_data <- model_data |>\n  filter(vote != \"Tore up/took\", !countryname_en %in% c(\"Australia\",\n                                                        \"New Zealand\")) |>\n  mutate(non_answer = if_else(vote == \"Declined to answer\", 1, 0),\n         putin_else = case_when(vote == \"Putin\" ~ 1,\n                                vote %in% c(\"Davankov\", \"Spoiled ballot\",\n                                            \"Slutsky\", \"Haritonov\") ~ 0,\n                                .default = NA),\n         nonsys_sys = case_when(vote %in% c(\"Davankov\", \"Spoiled ballot\") ~ 1,\n                                vote %in% c(\"Slutsky\", \"Haritonov\") ~ 0,\n                                .default = NA),\n         davankov_spoiled = case_when(vote == \"Davankov\" ~ 1,\n                                      vote == \"Spoiled ballot\" ~ 0,\n                                      .default = NA),\n         slutsky_haritonov = case_when(vote == \"Slutsky\" ~ 1,\n                                       vote == \"Haritonov\" ~ 0,\n                                       .default = NA)) |> \n  left_join(select(data_country,\n                   -countryname_en), \n            by = c(\"countrycode_n\", \"countrycode_c\"))\n```\n:::\n\n\nWe fit the model consecutively for each dichotomy this time separating data by hand in the same way as the ``nestedLogit`` package does.\n\nFor some models we get non-convergence. We diagnose which optimizers work best in those case and update the model to achieve convergence.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Answer (1) vs non-answer (0)\nm4a.nested <- glmer(non_answer ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n```\n:::\n\n\n### Not answer v answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use bobyqa\nm5a.nested <- glmer(non_answer ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status + help + military_dummy\n                    + log(dist) + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\",\n                                           optCtrl = list(maxfun = 1e9)))\n\n# Doesn't converge\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit with all optimizers\nm5a.allfit <- allFit(m5a.nested, maxfun = 1e9)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nbobyqa : [OK]\nNelder_Mead : [OK]\nnlminbwrap : [OK]\noptimx.L-BFGS-B : [OK]\nnloptwrap.NLOPT_LN_NELDERMEAD : [OK]\nnloptwrap.NLOPT_LN_BOBYQA : [OK]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convergence results\n  \n  ## Export models\n  m5a.allfit_OK <- m5a.allfit[sapply(m5a.allfit, is, \"merMod\")]\n  \n  ## Generate warnings encountered\n  data.frame(lapply(m5a.allfit_OK, function(x) x@optinfo$conv$lme4$messages)) |> \n    pivot_longer(everything(), names_to = \"Method\",\n                 values_to = \"Estimation result\") |> \n    arrange(`Method`, `Estimation result`) |> \n    distinct() |> \n    mutate(`Method` = if_else(lag(`Method`) != `Method` | is.na(lag(`Method`)), \n                              `Method`, \"\"),\n           `Estimation result` = gsub(\"\\\\|\", \" \", `Estimation result`)) |> \n    kable(booktabs = T,\n          caption = paste(\"Convergence results for Answer/non-Answer dichotomy,\", \n                          \"ME with level 2 variables and all optimizers\")) |> \n    column_spec(1, width = \"8cm\") |> \n    column_spec(2, width = \"8cm\")\n```\n\n::: {.cell-output-display}\n\n\\begin{longtable}[t]{>{\\raggedright\\arraybackslash}p{8cm}>{\\raggedright\\arraybackslash}p{8cm}}\n\\caption{\\label{tab:nested-logit-mixed-effects-m5a-answer-lvl2-diagnostics}Convergence results for Answer/non-Answer dichotomy, ME with level 2 variables and all optimizers}\\\\\n\\toprule\nMethod & Estimation result\\\\\n\\midrule\nNelder\\_Mead & Model failed to converge with max grad  = 0.0288314 (tol = 0.002, component 1)\\\\\nbobyqa & Model failed to converge with max grad  = 0.00240407 (tol = 0.002, component 1)\\\\\nnlminbwrap & Model failed to converge with max grad  = 0.071349 (tol = 0.002, component 1)\\\\\nnloptwrap.NLOPT\\_LN\\_BOBYQA & Model failed to converge with max grad  = 0.0450179 (tol = 0.002, component 1)\\\\\nnloptwrap.NLOPT\\_LN\\_NELDERMEAD & Model failed to converge: degenerate  Hessian with 1 negative eigenvalues\\\\\n\\addlinespace\n & unable to evaluate scaled \\vphantom{1} gradient\\\\\noptimx.L.BFGS.B & Model failed to converge: degenerate  Hessian with 1 negative eigenvalues\\\\\n & unable to evaluate scaled gradient\\\\\n\\bottomrule\n\\end{longtable}\n\n\n:::\n\n```{.r .cell-code}\n# Log-Likelihoods\n(lliks <- sort(sapply(m5a.allfit_OK, logLik))) |> \n  kable(col.names = \"Log-likelihood\", booktabs = T, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|                              | Log-likelihood|\n|:-----------------------------|--------------:|\n|optimx.L-BFGS-B               |      -8472.303|\n|Nelder_Mead                   |      -8472.302|\n|nloptwrap.NLOPT_LN_BOBYQA     |      -8472.302|\n|nlminbwrap                    |      -8472.302|\n|bobyqa                        |      -8472.302|\n|nloptwrap.NLOPT_LN_NELDERMEAD |      -8472.302|\n\n\n:::\n\n```{.r .cell-code}\n# Coefficients from different optimizers\n  \n  ## Export fixef and melt into single dataframe\n  models <- levels(melt(t(sapply(m5a.allfit_OK, fixef)))$Var1)\n  m5a.allfit.fixef.m <- transform(melt(t(sapply(m5a.allfit_OK, fixef))), \n                                  Var1 = factor(Var1, levels = names(lliks))) |> \n    transmute(`Method` = Var1,\n              `Coefficient` = value,\n              `Variable` = case_when(\n                Var2 == \"(Intercept)\" ~ \"Intercept\",\n                Var2 == \"sexFemale\" ~ \"Sex: Female\",\n                Var2 == \"sexOther\" ~ \"Sex: Other\",\n                Var2 == \"age_bin18-24\" ~ \"Age: 18-24 (ref 25-44)\",\n                Var2 == \"age_bin45-64\" ~ \"Age: 45-65 (ref 25-44)\",\n                Var2 == \"age_bin65+\" ~ \"Age: 65 + (ref 25-44)\",\n                Var2 == \"time_to_vs.less_than_hourYes\" ~ \n                  \"Took < 1 hour to get to the voting station\",\n                Var2 == \"out_of_Russia_timeAfter invasion\" ~\n                  \"Moved after March 2022 (ref before 2014)\",\n                Var2 == \"out_of_Russia_time2 - 5 years\" ~\n                  paste(\"Moved after March 2019 but before\",\n                        \"March 2022 (ref before 2014)\"),\n                Var2 == \"out_of_Russia_timeAfter annexation\" ~\n                  paste(\"Moved after March 2014 but before\",\n                        \"March 2019 (ref before 2014)\"),\n                Var2 == \"out_of_Russia_timeTourist (lives in Russia)\" ~\n                  paste(\"Didn't move - tourist, lives\",\n                        \"in Russia (ref before 2014)\"),\n                Var2 == \"result_trust_binDon't know\" ~\n                  \"Trust in the result: Don't know (ref Yes)\",\n                Var2 == \"result_trust_binNo\" ~\n                  \"Trust in the result: No (ref Yes)\",\n                Var2 == \"orthodox_share\" ~ \"Share of Orthodox Christians\",\n                Var2 == \"vdem_polyarchy_2022\" ~ \"Polyarchy index\",\n                Var2 == \"log(mad_gdppc_2018)\" ~ \"GDP per capita (log)\",\n                Var2 == \"obl_type1\" ~ \"Military agreements: 1 (ref 0)\",\n                Var2 == \"obl_type2\" ~ \"Military agreements: 2 (ref 0)\",\n                Var2 == \"obl_type3\" ~ \"Military agreements: 3 (ref 0)\",\n                Var2 == \"obl_type4\" ~ \"Military agreements: 4 (ref 0)\",\n                Var2 == \"export_share\" ~ \"Export share\",\n                Var2 == \"import_share\" ~ \"Import share\",\n                Var2 == \"friendly_statusUnfriendly\" ~ \n                  \"Unfriendly status (ref Neutral)\",\n                Var2 == \"friendly_statusFriendly\" ~ \n                  \"Friendly status (ref Neutral)\",\n                Var2 == \"help\" ~ \"Help to Ukraine\",\n                Var2 == \"military_dummy\" ~ \"Russian military presence\",\n                Var2 == \"log(dist)\" ~ \"Geodesic distance (log)\"),\n              )\n  \n  ## Plot \n  ggplot(m5a.allfit.fixef.m, \n           aes(x = `Coefficient`, y = `Method`, colour = `Method`)) +\n      geom_point() +\n      facet_wrap(~ `Variable`, scale = \"free\") +\n      scale_colour_brewer(palette = \"Dark2\") +\n      scale_y_discrete(breaks = models,\n                       labels = substr(models, 1, 3)) +\n      labs(x = \"\", y = \"\") + \n      theme_minimal() +\n      theme(legend.position = \"none\",\n            axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](mixed_effects_models_files/figure-pdf/nested-logit-mixed-effects-m5a-answer-lvl2-diagnostics-1.pdf)\n:::\n\n```{.r .cell-code}\n# So judging by this I leave the model alone - the coefficients seem to be okay \n# between different optimizers and since bobyqa comes close to the tolerance \n# threshold, I will use it.\n\n# Check m5a-specific diagnostics\n# Gradient 1\n  derivs1 <- m5a.nested@optinfo$derivs\n  sc_grad1 <- with(derivs1, solve(Hessian, gradient))\n  gradres1 <- max(pmin(abs(sc_grad1), abs(derivs1$gradient)))\n\n# Gradient 2\n  dd <- update(m5a.nested, devFunOnly = TRUE)\n  pars <- unlist(getME(m5a.nested, c(\"theta\", \"fixef\")))\n  grad2 <- grad(dd, pars)\n  hess2 <- hessian(dd, pars)\n  sc_grad2 <- solve(hess2, grad2)\n  gradres2 <- max(pmin(abs(sc_grad2), abs(grad2)))\n\n  ## The gradient cutoffs for Nelder Mead (nlopt), bobyqa and nlminwrap seem to \n  ## be close to what I am getting. \n\n# Check for singular fit \nsingres <- if_else(isSingular(m5a.nested), \"Yes\", \"No\")\n  \n# Display diagnostics\nkable(cbind(gradres1, gradres2, singres), \n      booktabs = T, digits = 3,\n      col.names = c(\"Gradient, method I\", \"Gradient, method II\", \n                    \"Singular fit?\"),\n      caption = paste(\"Diagnostics for `Answer vs No answer to poll`\", \n                      \"model (with preferred optimizer)\"))\n```\n\n::: {.cell-output-display}\n\n\nTable: Diagnostics for `Answer vs No answer to poll` model (with preferred optimizer)\n\n|Gradient, method I  |Gradient, method II |Singular fit? |\n|:-------------------|:-------------------|:-------------|\n|0.00240406734519638 |0.00243011504717848 |No            |\n\n\n:::\n:::\n\n\nThe model doesn't converge. \n\n### Putin v everyone else\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Putin (1) vs everyone else (0), declined to answer NA\nm4p.nested <- glmer(putin_else ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n\n# Converges!\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5p.nested <- glmer(putin_else ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status + help + military_dummy\n                    + log(dist) + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\", \n                                           optCtrl = list(maxfun = 1e9)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit with all optimizers (loaded with other models)\nm5p.allfit <- allFit(m5p.nested, maxfun = 1e9)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nbobyqa : [OK]\nNelder_Mead : [OK]\nnlminbwrap : [OK]\noptimx.L-BFGS-B : [OK]\nnloptwrap.NLOPT_LN_NELDERMEAD : [OK]\nnloptwrap.NLOPT_LN_BOBYQA : [OK]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convergence results\n  \n  ## Export models\n  m5p.allfit_OK <- m5p.allfit[sapply(m5p.allfit, is, \"merMod\")]\n  \n  ## Generate warnings encountered\n  data.frame(lapply(m5p.allfit_OK, function(x) x@optinfo$conv$lme4$messages)) |> \n    pivot_longer(everything(), names_to = \"Method\",\n                 values_to = \"Estimation result\") |> \n    arrange(`Method`, `Estimation result`) |> \n    distinct() |> \n    mutate(`Method` = if_else(lag(`Method`) != `Method` | is.na(lag(`Method`)), \n                              `Method`, \"\"),\n           `Estimation result` = gsub(\"\\\\|\", \" \", `Estimation result`)) |> \n    kable(booktabs = T,\n          caption = paste(\"Convergence results for Answer/non-Answer dichotomy,\", \n                          \"ME with level 2 variables and all optimizers\")) |> \n    column_spec(1, width = \"8cm\") |> \n    column_spec(2, width = \"8cm\")\n```\n\n::: {.cell-output-display}\n\n\\begin{longtable}[t]{>{\\raggedright\\arraybackslash}p{8cm}>{\\raggedright\\arraybackslash}p{8cm}}\n\\caption{\\label{tab:nested-logit-mixed-effects-m5p-putin-lvl2-diagnostics}Convergence results for Answer/non-Answer dichotomy, ME with level 2 variables and all optimizers}\\\\\n\\toprule\nMethod & Estimation result\\\\\n\\midrule\nNelder\\_Mead & Model failed to converge with max grad  = 0.0439094 (tol = 0.002, component 1)\\\\\nbobyqa & Model failed to converge with max grad  = 0.00486188 (tol = 0.002, component 1)\\\\\nnlminbwrap & Model failed to converge with max grad  = 0.0198981 (tol = 0.002, component 1)\\\\\nnloptwrap.NLOPT\\_LN\\_BOBYQA & Model failed to converge with max grad  = 0.0277748 (tol = 0.002, component 1)\\\\\nnloptwrap.NLOPT\\_LN\\_NELDERMEAD & Model failed to converge with max grad  = 0.0240685 (tol = 0.002, component 1)\\\\\n\\addlinespace\noptimx.L.BFGS.B & Model failed to converge with max grad  = 0.0818325 (tol = 0.002, component 1)\\\\\n\\bottomrule\n\\end{longtable}\n\n\n:::\n\n```{.r .cell-code}\n# Log-Likelihoods\n(lliks <- sort(sapply(m5p.allfit_OK, logLik))) |> \n  kable(col.names = \"Log-likelihood\", booktabs = T, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|                              | Log-likelihood|\n|:-----------------------------|--------------:|\n|Nelder_Mead                   |      -3178.423|\n|nloptwrap.NLOPT_LN_BOBYQA     |      -3178.423|\n|optimx.L-BFGS-B               |      -3178.423|\n|nlminbwrap                    |      -3178.423|\n|nloptwrap.NLOPT_LN_NELDERMEAD |      -3178.423|\n|bobyqa                        |      -3178.423|\n\n\n:::\n\n```{.r .cell-code}\n# Coefficients from different optimizers\n  \n  ## Export fixef and melt into single dataframe\n  models <- levels(melt(t(sapply(m5p.allfit_OK, fixef)))$Var1)\n  m5p.allfit.fixef.m <- transform(melt(t(sapply(m5p.allfit_OK, fixef))), \n                                  Var1 = factor(Var1, levels = names(lliks))) |> \n    transmute(`Method` = Var1,\n              `Coefficient` = value,\n              `Variable` = case_when(\n                Var2 == \"(Intercept)\" ~ \"Intercept\",\n                Var2 == \"sexFemale\" ~ \"Sex: Female\",\n                Var2 == \"sexOther\" ~ \"Sex: Other\",\n                Var2 == \"age_bin18-24\" ~ \"Age: 18-24 (ref 25-44)\",\n                Var2 == \"age_bin45-64\" ~ \"Age: 45-65 (ref 25-44)\",\n                Var2 == \"age_bin65+\" ~ \"Age: 65 + (ref 25-44)\",\n                Var2 == \"time_to_vs.less_than_hourYes\" ~ \n                  \"Took < 1 hour to get to the voting station\",\n                Var2 == \"out_of_Russia_timeAfter invasion\" ~\n                  \"Moved after March 2022 (ref before 2014)\",\n                Var2 == \"out_of_Russia_time2 - 5 years\" ~\n                  paste(\"Moved after March 2019 but before\",\n                        \"March 2022 (ref before 2014)\"),\n                Var2 == \"out_of_Russia_timeAfter annexation\" ~\n                  paste(\"Moved after March 2014 but before\",\n                        \"March 2019 (ref before 2014)\"),\n                Var2 == \"out_of_Russia_timeTourist (lives in Russia)\" ~\n                  paste(\"Didn't move - tourist, lives\",\n                        \"in Russia (ref before 2014)\"),\n                Var2 == \"result_trust_binDon't know\" ~\n                  \"Trust in the result: Don't know (ref Yes)\",\n                Var2 == \"result_trust_binNo\" ~\n                  \"Trust in the result: No (ref Yes)\",\n                Var2 == \"orthodox_share\" ~ \"Share of Orthodox Christians\",\n                Var2 == \"vdem_polyarchy_2022\" ~ \"Polyarchy index\",\n                Var2 == \"log(mad_gdppc_2018)\" ~ \"GDP per capita (log)\",\n                Var2 == \"obl_type1\" ~ \"Military agreements: 1 (ref 0)\",\n                Var2 == \"obl_type2\" ~ \"Military agreements: 2 (ref 0)\",\n                Var2 == \"obl_type3\" ~ \"Military agreements: 3 (ref 0)\",\n                Var2 == \"obl_type4\" ~ \"Military agreements: 4 (ref 0)\",\n                Var2 == \"export_share\" ~ \"Export share\",\n                Var2 == \"import_share\" ~ \"Import share\",\n                Var2 == \"friendly_statusUnfriendly\" ~ \n                  \"Unfriendly status (ref Neutral)\",\n                Var2 == \"friendly_statusFriendly\" ~ \n                  \"Friendly status (ref Neutral)\",\n                Var2 == \"help\" ~ \"Help to Ukraine\",\n                Var2 == \"military_dummy\" ~ \"Russian military presence\",\n                Var2 == \"log(dist)\" ~ \"Geodesic distance (log)\"),\n              )\n  \n  ## Plot\n  ggplot(m5p.allfit.fixef.m, \n         aes(x = `Coefficient`, y = `Method`, colour = `Method`)) +\n      geom_point() +\n      facet_wrap(~ `Variable`, scale = \"free\") +\n      scale_colour_brewer(palette = \"Dark2\") +\n      scale_y_discrete(breaks = models,\n                       labels = substr(models, 1, 3)) +\n      labs(x = \"\", y = \"\") + \n      theme_minimal() +\n      theme(legend.position = \"none\",\n            axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](mixed_effects_models_files/figure-pdf/nested-logit-mixed-effects-m5p-putin-lvl2-diagnostics-1.pdf)\n:::\n\n```{.r .cell-code}\n# Check m5p-specific diagnostics\n  \n# Gradient 1\n  derivs1 <- m5p.nested@optinfo$derivs\n  sc_grad1 <- with(derivs1, solve(Hessian, gradient))\n  gradres1 <- max(pmin(abs(sc_grad1), abs(derivs1$gradient)))\n\n# Gradient 2\n  dd <- update(m5p.nested, devFunOnly = TRUE)\n  pars <- unlist(getME(m5p.nested, c(\"theta\", \"fixef\")))\n  grad2 <- grad(dd, pars)\n  hess2 <- hessian(dd, pars)\n  sc_grad2 <- solve(hess2, grad2)\n  gradres2 <- max(pmin(abs(sc_grad2), abs(grad2)))\n\n  ## The gradient cutoffs for Nelder Mead (nlopt), bobyqa and nlminwrap seem to \n  ## be close to what I am getting. \n\n# Check for singular fit \nsingres <- if_else(isSingular(m5p.nested), \"Yes\", \"No\")\n  \n# Display diagnostics\nkable(cbind(gradres1, gradres2, singres),\n      booktabs = T, digits = 3,\n      col.names = c(\"Gradient, method I\", \"Gradient, method II\", \n                    \"Singular fit?\"),\n      caption = paste(\"Diagnostics for `Putin vs Everyone\", \n                      \"else` model (with preferred optimizer)\"))\n```\n\n::: {.cell-output-display}\n\n\nTable: Diagnostics for `Putin vs Everyone else` model (with preferred optimizer)\n\n|Gradient, method I |Gradient, method II |Singular fit? |\n|:------------------|:-------------------|:-------------|\n|0.0132050081447233 |0.0131996664023155  |No            |\n\n\n:::\n:::\n\n\n### Non-systemic v systemic opposition\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Non-systemic - Davankov or Spoiled (1) vs systemic - Haritonov, Slutsky (0) \n# opposition, declined to answer and Putin are NA\nm4s.nested <- glmer(nonsys_sys ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n\n# Converges\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5s.nested <- glmer(nonsys_sys ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status  + help + military_dummy\n                    + log(dist) + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\", \n                                           optCtrl = list(maxfun = 1e9)))\n\n# Singular fit! \n\n# The predictors most likely to cause issues are obl_type and friendly_status\n# as they are broadly (and correlated between themselves and other variables) \n# defined dichotomous predictors. Remove them from the model and try again\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5s.red <- update(m5s.nested, ~ . - obl_type - friendly_status)\n\n# Works great and no issues with convergence either\n```\n:::\n\n\n\n### Davankov v spoiled\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Davankov (1) vs Spoiled (0) declined to answer, Haritonov, Slutsky and Putin\n# are NA\nm4d.nested <- glmer(davankov_spoiled ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5d.nested <- glmer(davankov_spoiled ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status  + help + military_dummy\n                    + log(dist) + (1 | countryname_en), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\", \n                                           optCtrl = list(maxfun = 1e9)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5d.allfit <- allFit(m5d.nested, maxfun = 1e9)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nbobyqa : [OK]\nNelder_Mead : [OK]\nnlminbwrap : [OK]\noptimx.L-BFGS-B : [OK]\nnloptwrap.NLOPT_LN_NELDERMEAD : [OK]\nnloptwrap.NLOPT_LN_BOBYQA : [OK]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convergence results\n  \n  ## Export models\n  m5d.allfit_OK <- m5d.allfit[sapply(m5d.allfit, is, \"merMod\")]\n  \n  ## Generate warnings encountered\n  data.frame(lapply(m5d.allfit_OK, function(x) x@optinfo$conv$lme4$messages)) |> \n    pivot_longer(everything(), names_to = \"Method\",\n                 values_to = \"Estimation result\") |> \n    arrange(`Method`, `Estimation result`) |> \n    distinct() |> \n    mutate(`Method` = if_else(lag(`Method`) != `Method` | is.na(lag(`Method`)), \n                              `Method`, \"\"),\n           `Estimation result` = gsub(\"\\\\|\", \" \", `Estimation result`)) |> \n    kable(booktabs = T,\n          caption = paste(\"Convergence results for Answer/non-Answer dichotomy,\", \n                          \"ME with level 2 variables and all optimizers\")) |> \n    column_spec(1, width = \"8cm\") |> \n    column_spec(2, width = \"8cm\")\n```\n\n::: {.cell-output-display}\n\n\\begin{longtable}[t]{>{\\raggedright\\arraybackslash}p{8cm}>{\\raggedright\\arraybackslash}p{8cm}}\n\\caption{\\label{tab:nested_logit_mixed_effects_m5d_davankov_lvl2_diagnostics}Convergence results for Answer/non-Answer dichotomy, ME with level 2 variables and all optimizers}\\\\\n\\toprule\nMethod & Estimation result\\\\\n\\midrule\nNelder\\_Mead & Model failed to converge with max grad  = 0.425244 (tol = 0.002, component 1)\\\\\nbobyqa & Model failed to converge with max grad  = 0.0157886 (tol = 0.002, component 1)\\\\\nnlminbwrap & Model failed to converge with max grad  = 1.66793 (tol = 0.002, component 1)\\\\\nnloptwrap.NLOPT\\_LN\\_BOBYQA & Model failed to converge with max grad  = 0.0678025 (tol = 0.002, component 1)\\\\\nnloptwrap.NLOPT\\_LN\\_NELDERMEAD & Model failed to converge with max grad  = 0.081166 (tol = 0.002, component 1)\\\\\n\\addlinespace\noptimx.L.BFGS.B & Model failed to converge with max grad  = 0.0682182 (tol = 0.002, component 1)\\\\\n\\bottomrule\n\\end{longtable}\n\n\n:::\n\n```{.r .cell-code}\n# Log-Likelihoods\n(lliks <- sort(sapply(m5d.allfit_OK, logLik))) |> \n  kable(col.names = \"Log-likelihood\", booktabs = T, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|                              | Log-likelihood|\n|:-----------------------------|--------------:|\n|Nelder_Mead                   |      -20537.76|\n|nlminbwrap                    |      -20537.73|\n|optimx.L-BFGS-B               |      -20537.73|\n|nloptwrap.NLOPT_LN_BOBYQA     |      -20537.73|\n|nloptwrap.NLOPT_LN_NELDERMEAD |      -20537.73|\n|bobyqa                        |      -20537.73|\n\n\n:::\n\n```{.r .cell-code}\n# Coefficients from different optimizers\n  \n  ## Export fixef and melt into single dataframe\n  models <- levels(melt(t(sapply(m5d.allfit_OK, fixef)))$Var1)\n  m5d.allfit.fixef.m <- transform(melt(t(sapply(m5d.allfit_OK, fixef))), \n                                  Var1 = factor(Var1, levels = names(lliks))) |> \n    transmute(`Method` = Var1,\n              `Coefficient` = value,\n              `Variable` = case_when(\n                Var2 == \"(Intercept)\" ~ \"Intercept\",\n                Var2 == \"sexFemale\" ~ \"Sex: Female\",\n                Var2 == \"sexOther\" ~ \"Sex: Other\",\n                Var2 == \"age_bin18-24\" ~ \"Age: 18-24 (ref 25-44)\",\n                Var2 == \"age_bin45-64\" ~ \"Age: 45-65 (ref 25-44)\",\n                Var2 == \"age_bin65+\" ~ \"Age: 65 + (ref 25-44)\",\n                Var2 == \"time_to_vs.less_than_hourYes\" ~ \n                  \"Took < 1 hour to get to the voting station\",\n                Var2 == \"out_of_Russia_timeAfter invasion\" ~\n                  \"Moved after March 2022 (ref before 2014)\",\n                Var2 == \"out_of_Russia_time2 - 5 years\" ~\n                  paste(\"Moved after March 2019 but before\",\n                        \"March 2022 (ref before 2014)\"),\n                Var2 == \"out_of_Russia_timeAfter annexation\" ~\n                  paste(\"Moved after March 2014 but before\",\n                        \"March 2019 (ref before 2014)\"),\n                Var2 == \"out_of_Russia_timeTourist (lives in Russia)\" ~\n                  paste(\"Didn't move - tourist, lives\",\n                        \"in Russia (ref before 2014)\"),\n                Var2 == \"result_trust_binDon't know\" ~\n                  \"Trust in the result: Don't know (ref Yes)\",\n                Var2 == \"result_trust_binNo\" ~\n                  \"Trust in the result: No (ref Yes)\",\n                Var2 == \"orthodox_share\" ~ \"Share of Orthodox Christians\",\n                Var2 == \"vdem_polyarchy_2022\" ~ \"Polyarchy index\",\n                Var2 == \"log(mad_gdppc_2018)\" ~ \"GDP per capita (log)\",\n                Var2 == \"obl_type1\" ~ \"Military agreements: 1 (ref 0)\",\n                Var2 == \"obl_type2\" ~ \"Military agreements: 2 (ref 0)\",\n                Var2 == \"obl_type3\" ~ \"Military agreements: 3 (ref 0)\",\n                Var2 == \"obl_type4\" ~ \"Military agreements: 4 (ref 0)\",\n                Var2 == \"export_share\" ~ \"Export share\",\n                Var2 == \"import_share\" ~ \"Import share\",\n                Var2 == \"friendly_statusUnfriendly\" ~ \n                  \"Unfriendly status (ref Neutral)\",\n                Var2 == \"friendly_statusFriendly\" ~ \n                  \"Friendly status (ref Neutral)\",\n                Var2 == \"help\" ~ \"Help to Ukraine\",\n                Var2 == \"military_dummy\" ~ \"Russian military presence\",\n                Var2 == \"log(dist)\" ~ \"Geodesic distance (log)\"),\n              )\n  \n  ## Plot\n  ggplot(m5d.allfit.fixef.m, \n           aes(x = `Coefficient`, y = `Method`, colour = `Method`)) +\n      geom_point() +\n      facet_wrap(~ `Variable`, scale = \"free\") +\n      scale_colour_brewer(palette = \"Dark2\") +\n      scale_y_discrete(breaks = models,\n                       labels = substr(models, 1, 3)) +\n      labs(x = \"\", y = \"\") + \n      theme_minimal() +\n      theme(legend.position = \"none\",\n            axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](mixed_effects_models_files/figure-pdf/nested_logit_mixed_effects_m5d_davankov_lvl2_diagnostics-1.pdf)\n:::\n\n```{.r .cell-code}\n# Check m5d-specific diagnostics\n  \n# Gradient 1\n  derivs1 <- m5d.nested@optinfo$derivs\n  sc_grad1 <- with(derivs1, solve(Hessian, gradient))\n  gradres1 <- max(pmin(abs(sc_grad1), abs(derivs1$gradient)))\n\n# Gradient 2\n  dd <- update(m5d.nested, devFunOnly = TRUE)\n  pars <- unlist(getME(m5d.nested, c(\"theta\", \"fixef\")))\n  grad2 <- grad(dd, pars)\n  hess2 <- hessian(dd, pars)\n  sc_grad2 <- solve(hess2, grad2)\n  gradres2 <- max(pmin(abs(sc_grad2), abs(grad2)))\n\n  ## The gradient cutoffs for Nelder Mead (nlopt), bobyqa and nlminwrap seem to \n  ## be close to what I am getting. \n\n# Check for singular fit \nsingres <- if_else(isSingular(m5d.nested), \"Yes\", \"No\")\n  \n# Display diagnostics\nkable(cbind(gradres1, gradres2, singres), \n      booktabs = T, digits = 3,\n      col.names = c(\"Gradient, method I\", \"Gradient, method II\", \n                    \"Singular fit?\"),\n      caption = paste(\"Diagnostics for `Davankov vs Spoil the ballot`\", \n                      \"model (with preferred optimizer)\"))\n```\n\n::: {.cell-output-display}\n\n\nTable: Diagnostics for `Davankov vs Spoil the ballot` model (with preferred optimizer)\n\n|Gradient, method I |Gradient, method II |Singular fit? |\n|:------------------|:-------------------|:-------------|\n|0.0040686829458804 |0.00394873324194497 |No            |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsave(list = c(\"m5a.nested\", \"m5p.nested\", \"m5s.nested\", \"m5s.red\", \"m5d.nested\"), \n     file = \"nlme_bobyqa.RData\")\n\nsave(list = c(\"m4a.nested\", \"m4p.nested\", \"m4s.nested\", \"m4d.nested\"), \n     file = \"feme_bobyqa.RData\")\n\nsave(list = c(\"m5a.allfit\", \"m5p.allfit\", \"m5d.allfit\"), \n     file = \"me_allfit.RData\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef_map_me <- c(\"(Intercept)\", \"sexFemale\" = \"Sex: Female\", \n                 \"sexOther\" = \"Sex: Other\", \n                 \"age_bin18-24\" = \"Age: 18-24 (ref 25-44)\", \n                 \"age_bin45-64\" = \"Age: 45-65 (ref 25-44)\", \n                 \"age_bin65+\" = \"Age: 65 + (ref 25-44)\", \n                 \"time_to_vs.less_than_hourYes\" = \n                   \"Took < 1 hour to get to the voting station\",\n                 \"out_of_Russia_timeAfter invasion\" =\n                   \"Moved after March 2022 (ref before 2014)\", \n                 \"out_of_Russia_time2 - 5 years\" = \n                   paste(\"Moved after March 2019 but before\",\n                         \"March 2022 (ref before 2014)\"),\n                 \"out_of_Russia_timeAfter annexation\" =\n                   paste(\"Moved after March 2014 but before\",\n                         \"March 2019 (ref before 2014)\"),\n                 \"out_of_Russia_timeTourist (lives in Russia)\" =\n                   paste(\"Didn't move - tourist, lives\",\n                         \"in Russia (ref before 2014)\"),\n                 \"result_trust_binDon't know\" = \n                   \"Trust in the result: Don't know (ref Yes)\",\n                 \"result_trust_binNo\" = \n                   \"Trust in the result: No (ref Yes)\",\n                 \"orthodox_share\" = \"Share of Orthodox Christians\",\n                 \"vdem_polyarchy_2022\" = \"Polyarchy index\",\n                 \"log(mad_gdppc_2018)\" = \"GDP per capita (log)\",\n                 \"obl_type1\" = \"Military agreements: 1 (ref 0)\",\n                 \"obl_type2\" = \"Military agreements: 2 (ref 0)\",\n                 \"obl_type3\" = \"Military agreements: 3 (ref 0)\",\n                 \"obl_type4\" = \"Military agreements: 4 (ref 0)\",\n                 \"export_share\" = \"Export share\",\n                 \"import_share\" = \"Import share\",\n                 \"friendly_statusUnfriendly\" = \n                   \"Unfriendly status (ref Neutral)\",\n                 \"friendly_statusFriendly\" =\n                   \"Friendly status (ref Neutral)\",\n                 \"help\" = \"Help to Ukraine\",\n                 \"military_dummy\" = \"Russian military presence\",\n                 \"log(dist)\" = \"Geodesic distance (log)\")\n```\n:::\n\n::: {#tbl-results-me-1 .cell tbl-cap='Mixed effects results, no level 2 variables'}\n\n```{.r .cell-code}\nmodelsummary(list(\"Declined to answer vs answer\" = m4a.nested,\n                  \"Putin vs everyone else\" = m4p.nested,\n                  \"Non-systemic vs systemic opposition\" = m4s.nested,\n                  \"Davankov vs Spoiled\" = m4d.nested),\n             output = \"kableExtra\", stars = T, \n             coef_map = coef_map_me) |> \n  kable_styling(latex_options = \"scale_down\")\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccc}\n\\toprule\n  & Declined to answer vs answer & Putin vs everyone else & Non-systemic vs systemic opposition & Davankov vs Spoiled\\\\\n\\midrule\nSex: Female & \\num{0.275}*** & \\num{0.482}*** & \\num{0.022} & \\num{-0.199}***\\\\\n & (\\num{0.044}) & (\\num{0.071}) & (\\num{0.056}) & (\\num{0.024})\\\\\nSex: Other & \\num{0.064} & \\num{0.171} & \\num{-0.375} & \\num{-0.470}**\\\\\n & (\\num{0.237}) & (\\num{0.368}) & (\\num{0.296}) & (\\num{0.144})\\\\\nAge: 18-24 (ref 25-44) & \\num{-0.003} & \\num{0.026} & \\num{-0.095} & \\num{0.062}+\\\\\n & (\\num{0.081}) & (\\num{0.124}) & (\\num{0.086}) & (\\num{0.037})\\\\\nAge: 45-65 (ref 25-44) & \\num{0.180}** & \\num{1.322}*** & \\num{-0.302}*** & \\num{-0.826}***\\\\\n & (\\num{0.059}) & (\\num{0.086}) & (\\num{0.087}) & (\\num{0.039})\\\\\nAge: 65 + (ref 25-44) & \\num{0.170}* & \\num{1.507}*** & \\num{-0.957}*** & \\num{-0.931}***\\\\\n & (\\num{0.077}) & (\\num{0.131}) & (\\num{0.155}) & (\\num{0.106})\\\\\nTook < 1 hour to get to the voting station & \\num{0.376}*** & \\num{0.094} & \\num{-0.099} & \\num{-0.034}\\\\\n & (\\num{0.052}) & (\\num{0.081}) & (\\num{0.061}) & (\\num{0.026})\\\\\nMoved after March 2022 (ref before 2014) & \\num{-0.359}*** & \\num{-2.330}*** & \\num{0.766}*** & \\num{0.565}***\\\\\n & (\\num{0.069}) & (\\num{0.101}) & (\\num{0.084}) & (\\num{0.040})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{-0.207}** & \\num{-1.480}*** & \\num{0.409}*** & \\num{0.454}***\\\\\n & (\\num{0.075}) & (\\num{0.109}) & (\\num{0.091}) & (\\num{0.042})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{-0.159}* & \\num{-0.806}*** & \\num{0.296}** & \\num{0.219}***\\\\\n & (\\num{0.080}) & (\\num{0.120}) & (\\num{0.102}) & (\\num{0.045})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{-0.039} & \\num{-0.975}*** & \\num{0.041} & \\num{0.652}***\\\\\n & (\\num{0.096}) & (\\num{0.143}) & (\\num{0.144}) & (\\num{0.087})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{0.499}*** & \\num{-3.960}*** & \\num{0.718}*** & \\num{0.387}**\\\\\n & (\\num{0.082}) & (\\num{0.109}) & (\\num{0.127}) & (\\num{0.139})\\\\\nTrust in the result: No (ref Yes) & \\num{-1.328}*** & \\num{-7.218}*** & \\num{1.903}*** & \\num{-0.806}***\\\\\n & (\\num{0.060}) & (\\num{0.101}) & (\\num{0.094}) & (\\num{0.105})\\\\\n\\midrule\nNum.Obs. & \\num{53824} & \\num{51202} & \\num{42363} & \\num{40946}\\\\\nR2 Marg. & \\num{0.139} & \\num{0.781} & \\num{0.070} & \\num{0.054}\\\\\nR2 Cond. & \\num{0.227} & \\num{0.813} & \\num{0.075} & \\num{0.070}\\\\\nAIC & \\num{18314.4} & \\num{6766.2} & \\num{11756.3} & \\num{45344.3}\\\\\nBIC & \\num{18438.9} & \\num{6890.0} & \\num{11877.5} & \\num{45465.0}\\\\\nICC & \\num{0.1} & \\num{0.1} & \\num{0.0} & \\num{0.0}\\\\\nRMSE & \\num{0.21} & \\num{0.13} & \\num{0.18} & \\num{0.43}\\\\\n\\bottomrule\n\\multicolumn{5}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n\n::: {#tbl-results-me-2 .cell tbl-cap='Comparison: logistic vs mixed effects models (no lvl 2 variables)'}\n\n```{.r .cell-code}\nm3.answer <- models(m3.nested.fe, 1)\nm3.putin <- models(m3.nested.fe, 2)\nm3.nonsys <- models(m3.nested.fe, 3)\nm3.davankov <- models(m3.nested.fe, 4)\n\nmodelsummary(list(\"Logistic\" = m3.answer,\n                  \"Mixed effects\" = m4a.nested,\n                  \"Logistic\" = m3.putin,\n                  \"Mixed effects\" = m4p.nested,\n                  \"Logistic\" = m3.nonsys,\n                  \"Mixed effects\" = m4s.nested,\n                  \"Logistic\" = m3.davankov,\n                  \"Mixed effects\" = m4d.nested),\n             output = \"kableExtra\", stars = T, \n             coef_map = coef_map_me) |> \n  kable_styling(latex_options = \"scale_down\") |> \n  add_header_above(c(\" \" = 1, \"Answer vs No answer\" = 2, \n                     \"Putin vs everyone else\" = 2,\n                     \"Non-systemic vs systemic opposition\" = 2,\n                     \"Davankov vs Spoiled\" = 2))\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccccccc}\n\\toprule\n\\multicolumn{1}{c}{ } & \\multicolumn{2}{c}{Answer vs No answer} & \\multicolumn{2}{c}{Putin vs everyone else} & \\multicolumn{2}{c}{Non-systemic vs systemic opposition} & \\multicolumn{2}{c}{Davankov vs Spoiled} \\\\\n\\cmidrule(l{3pt}r{3pt}){2-3} \\cmidrule(l{3pt}r{3pt}){4-5} \\cmidrule(l{3pt}r{3pt}){6-7} \\cmidrule(l{3pt}r{3pt}){8-9}\n  & Logistic & Mixed effects & Logistic  & Mixed effects  & Logistic   & Mixed effects   & Logistic    & Mixed effects   \\\\\n\\midrule\nSex: Female & \\num{0.275}*** & \\num{0.275}*** & \\num{0.481}*** & \\num{0.482}*** & \\num{0.019} & \\num{0.022} & \\num{-0.195}*** & \\num{-0.199}***\\\\\n & (\\num{0.044}) & (\\num{0.044}) & (\\num{0.072}) & (\\num{0.071}) & (\\num{0.057}) & (\\num{0.056}) & (\\num{0.024}) & (\\num{0.024})\\\\\nSex: Other & \\num{0.039} & \\num{0.064} & \\num{0.208} & \\num{0.171} & \\num{-0.371} & \\num{-0.375} & \\num{-0.455}** & \\num{-0.470}**\\\\\n & (\\num{0.240}) & (\\num{0.237}) & (\\num{0.369}) & (\\num{0.368}) & (\\num{0.301}) & (\\num{0.296}) & (\\num{0.146}) & (\\num{0.144})\\\\\nAge: 18-24 (ref 25-44) & \\num{-0.008} & \\num{-0.003} & \\num{0.019} & \\num{0.026} & \\num{-0.114} & \\num{-0.095} & \\num{0.072}+ & \\num{0.062}+\\\\\n & (\\num{0.082}) & (\\num{0.081}) & (\\num{0.126}) & (\\num{0.124}) & (\\num{0.088}) & (\\num{0.086}) & (\\num{0.037}) & (\\num{0.037})\\\\\nAge: 45-65 (ref 25-44) & \\num{0.172}** & \\num{0.180}** & \\num{1.304}*** & \\num{1.322}*** & \\num{-0.294}*** & \\num{-0.302}*** & \\num{-0.827}*** & \\num{-0.826}***\\\\\n & (\\num{0.059}) & (\\num{0.059}) & (\\num{0.087}) & (\\num{0.086}) & (\\num{0.088}) & (\\num{0.087}) & (\\num{0.039}) & (\\num{0.039})\\\\\nAge: 65 + (ref 25-44) & \\num{0.161}* & \\num{0.170}* & \\num{1.501}*** & \\num{1.507}*** & \\num{-0.994}*** & \\num{-0.957}*** & \\num{-0.952}*** & \\num{-0.931}***\\\\\n & (\\num{0.078}) & (\\num{0.077}) & (\\num{0.132}) & (\\num{0.131}) & (\\num{0.159}) & (\\num{0.155}) & (\\num{0.107}) & (\\num{0.106})\\\\\nTook < 1 hour to get to the voting station & \\num{0.310}*** & \\num{0.376}*** & \\num{0.071} & \\num{0.094} & \\num{-0.086} & \\num{-0.099} & \\num{-0.028} & \\num{-0.034}\\\\\n & (\\num{0.055}) & (\\num{0.052}) & (\\num{0.085}) & (\\num{0.081}) & (\\num{0.067}) & (\\num{0.061}) & (\\num{0.027}) & (\\num{0.026})\\\\\nMoved after March 2022 (ref before 2014) & \\num{-0.363}*** & \\num{-0.359}*** & \\num{-2.357}*** & \\num{-2.330}*** & \\num{0.820}*** & \\num{0.766}*** & \\num{0.539}*** & \\num{0.565}***\\\\\n & (\\num{0.069}) & (\\num{0.069}) & (\\num{0.103}) & (\\num{0.101}) & (\\num{0.090}) & (\\num{0.084}) & (\\num{0.040}) & (\\num{0.040})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{-0.217}** & \\num{-0.207}** & \\num{-1.467}*** & \\num{-1.480}*** & \\num{0.419}*** & \\num{0.409}*** & \\num{0.438}*** & \\num{0.454}***\\\\\n & (\\num{0.075}) & (\\num{0.075}) & (\\num{0.110}) & (\\num{0.109}) & (\\num{0.093}) & (\\num{0.091}) & (\\num{0.042}) & (\\num{0.042})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{-0.179}* & \\num{-0.159}* & \\num{-0.798}*** & \\num{-0.806}*** & \\num{0.299}** & \\num{0.296}** & \\num{0.213}*** & \\num{0.219}***\\\\\n & (\\num{0.081}) & (\\num{0.080}) & (\\num{0.121}) & (\\num{0.120}) & (\\num{0.103}) & (\\num{0.102}) & (\\num{0.046}) & (\\num{0.045})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{-0.002} & \\num{-0.039} & \\num{-0.997}*** & \\num{-0.975}*** & \\num{0.134} & \\num{0.041} & \\num{0.633}*** & \\num{0.652}***\\\\\n & (\\num{0.098}) & (\\num{0.096}) & (\\num{0.146}) & (\\num{0.143}) & (\\num{0.150}) & (\\num{0.144}) & (\\num{0.088}) & (\\num{0.087})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{0.521}*** & \\num{0.499}*** & \\num{-3.955}*** & \\num{-3.960}*** & \\num{0.716}*** & \\num{0.718}*** & \\num{0.392}** & \\num{0.387}**\\\\\n & (\\num{0.083}) & (\\num{0.082}) & (\\num{0.110}) & (\\num{0.109}) & (\\num{0.129}) & (\\num{0.127}) & (\\num{0.141}) & (\\num{0.139})\\\\\nTrust in the result: No (ref Yes) & \\num{-1.293}*** & \\num{-1.328}*** & \\num{-7.204}*** & \\num{-7.218}*** & \\num{1.891}*** & \\num{1.903}*** & \\num{-0.804}*** & \\num{-0.806}***\\\\\n & (\\num{0.060}) & (\\num{0.060}) & (\\num{0.102}) & (\\num{0.101}) & (\\num{0.095}) & (\\num{0.094}) & (\\num{0.106}) & (\\num{0.105})\\\\\n\\midrule\nNum.Obs. & \\num{53824} & \\num{53824} & \\num{51202} & \\num{51202} & \\num{42363} & \\num{42363} & \\num{40946} & \\num{40946}\\\\\nR2 Marg. &  & \\num{0.139} &  & \\num{0.781} &  & \\num{0.070} &  & \\num{0.054}\\\\\nR2 Cond. &  & \\num{0.227} &  & \\num{0.813} &  & \\num{0.075} &  & \\num{0.070}\\\\\nAIC & \\num{18166.4} & \\num{18314.4} & \\num{6724.4} & \\num{6766.2} & \\num{11769.4} & \\num{11756.3} & \\num{45257.7} & \\num{45344.3}\\\\\nBIC & \\num{18833.4} & \\num{18438.9} & \\num{7387.7} & \\num{6890.0} & \\num{12418.5} & \\num{11877.5} & \\num{45904.2} & \\num{45465.0}\\\\\nICC &  & \\num{0.1} &  & \\num{0.1} &  & \\num{0.0} &  & \\num{0.0}\\\\\nRMSE & \\num{0.21} & \\num{0.21} & \\num{0.13} & \\num{0.13} & \\num{0.18} & \\num{0.18} & \\num{0.43} & \\num{0.43}\\\\\n\\bottomrule\n\\multicolumn{9}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n\n::: {#tbl-results-me-3 .cell tbl-cap='Mixed effects results, with level 2 variables'}\n\n```{.r .cell-code}\nmodelsummary(list(\"Declined to answer vs answer\" = m5a.nested,\n                  \"Putin vs everyone else\" = m5p.nested,\n                  \"Non-systemic vs systemic opposition\" = m5s.red,\n                  \"Davankov vs Spoiled\" = m5d.nested),\n             output = \"kableExtra\", stars = T, \n             coef_map = coef_map_me) |> \n  kable_styling(latex_options = \"scale_down\")\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccc}\n\\toprule\n  & Declined to answer vs answer & Putin vs everyone else & Non-systemic vs systemic opposition & Davankov vs Spoiled\\\\\n\\midrule\nSex: Female & \\num{0.258}*** & \\num{0.489}*** & \\num{0.015} & \\num{-0.186}***\\\\\n & (\\num{0.045}) & (\\num{0.073}) & (\\num{0.059}) & (\\num{0.025})\\\\\nSex: Other & \\num{0.071} & \\num{0.176} & \\num{-0.232} & \\num{-0.462}**\\\\\n & (\\num{0.240}) & (\\num{0.376}) & (\\num{0.328}) & (\\num{0.148})\\\\\nAge: 18-24 (ref 25-44) & \\num{0.036} & \\num{0.040} & \\num{-0.117} & \\num{0.064}+\\\\\n & (\\num{0.083}) & (\\num{0.125}) & (\\num{0.088}) & (\\num{0.038})\\\\\nAge: 45-65 (ref 25-44) & \\num{0.194}** & \\num{1.316}*** & \\num{-0.299}*** & \\num{-0.823}***\\\\\n & (\\num{0.060}) & (\\num{0.089}) & (\\num{0.090}) & (\\num{0.040})\\\\\nAge: 65 + (ref 25-44) & \\num{0.175}* & \\num{1.491}*** & \\num{-0.930}*** & \\num{-0.906}***\\\\\n & (\\num{0.078}) & (\\num{0.134}) & (\\num{0.159}) & (\\num{0.108})\\\\\nTook < 1 hour to get to the voting station & \\num{0.355}*** & \\num{0.054} & \\num{-0.081} & \\num{-0.041}\\\\\n & (\\num{0.054}) & (\\num{0.084}) & (\\num{0.065}) & (\\num{0.027})\\\\\nMoved after March 2022 (ref before 2014) & \\num{-0.351}*** & \\num{-2.329}*** & \\num{0.817}*** & \\num{0.540}***\\\\\n & (\\num{0.071}) & (\\num{0.103}) & (\\num{0.090}) & (\\num{0.040})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{-0.175}* & \\num{-1.496}*** & \\num{0.402}*** & \\num{0.444}***\\\\\n & (\\num{0.076}) & (\\num{0.111}) & (\\num{0.093}) & (\\num{0.042})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{-0.134}+ & \\num{-0.826}*** & \\num{0.318}** & \\num{0.214}***\\\\\n & (\\num{0.081}) & (\\num{0.121}) & (\\num{0.103}) & (\\num{0.045})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{-0.018} & \\num{-1.014}*** & \\num{0.148} & \\num{0.647}***\\\\\n & (\\num{0.099}) & (\\num{0.148}) & (\\num{0.153}) & (\\num{0.090})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{0.551}*** & \\num{-3.956}*** & \\num{0.700}*** & \\num{0.331}*\\\\\n & (\\num{0.084}) & (\\num{0.111}) & (\\num{0.133}) & (\\num{0.146})\\\\\nTrust in the result: No (ref Yes) & \\num{-1.355}*** & \\num{-7.238}*** & \\num{1.910}*** & \\num{-0.839}***\\\\\n & (\\num{0.062}) & (\\num{0.103}) & (\\num{0.098}) & (\\num{0.111})\\\\\nShare of Orthodox Christians & \\num{-0.472} & \\num{1.888}*** & \\num{-0.360}* & \\num{0.071}\\\\\n & (\\num{0.468}) & (\\num{0.412}) & (\\num{0.142}) & (\\num{0.163})\\\\\nPolyarchy index & \\num{0.328} & \\num{-0.959} & \\num{0.532}* & \\num{-0.561}*\\\\\n & (\\num{0.668}) & (\\num{0.674}) & (\\num{0.250}) & (\\num{0.233})\\\\\nGDP per capita (log) & \\num{-0.280} & \\num{-0.336}+ & \\num{0.036} & \\num{0.037}\\\\\n & (\\num{0.174}) & (\\num{0.176}) & (\\num{0.088}) & (\\num{0.072})\\\\\nMilitary agreements: 1 (ref 0) & \\num{-0.412} & \\num{-0.683} &  & \\num{0.084}\\\\\n & (\\num{0.471}) & (\\num{0.454}) &  & (\\num{0.162})\\\\\nMilitary agreements: 2 (ref 0) & \\num{-0.900}+ & \\num{-0.705} &  & \\num{0.160}\\\\\n & (\\num{0.507}) & (\\num{0.485}) &  & (\\num{0.171})\\\\\nMilitary agreements: 3 (ref 0) & \\num{-0.653} & \\num{-0.592} &  & \\num{0.014}\\\\\n & (\\num{0.463}) & (\\num{0.427}) &  & (\\num{0.162})\\\\\nMilitary agreements: 4 (ref 0) & \\num{-0.826} & \\num{0.149} &  & \\num{-0.132}\\\\\n & (\\num{0.814}) & (\\num{0.739}) &  & (\\num{0.278})\\\\\nExport share & \\num{-0.174}** & \\num{-0.061} & \\num{0.030} & \\num{0.018}\\\\\n & (\\num{0.062}) & (\\num{0.058}) & (\\num{0.024}) & (\\num{0.016})\\\\\nImport share & \\num{0.217}*** & \\num{0.123}* & \\num{-0.020} & \\num{-0.018}\\\\\n & (\\num{0.063}) & (\\num{0.056}) & (\\num{0.020}) & (\\num{0.018})\\\\\nUnfriendly status (ref Neutral) & \\num{0.622} & \\num{0.103} &  & \\num{0.149}\\\\\n & (\\num{0.819}) & (\\num{0.794}) &  & (\\num{0.284})\\\\\nFriendly status (ref Neutral) & \\num{0.430} & \\num{-0.279} &  & \\num{0.264}\\\\\n & (\\num{0.480}) & (\\num{0.466}) &  & (\\num{0.183})\\\\\nHelp to Ukraine & \\num{-1.003}* & \\num{-0.599} & \\num{-0.124} & \\num{-0.255}\\\\\n & (\\num{0.476}) & (\\num{0.532}) & (\\num{0.194}) & (\\num{0.196})\\\\\nRussian military presence & \\num{0.085} & \\num{-1.367}* & \\num{0.224} & \\num{0.254}\\\\\n & (\\num{0.728}) & (\\num{0.678}) & (\\num{0.195}) & (\\num{0.264})\\\\\nGeodesic distance (log) & \\num{-0.386}* & \\num{0.212} & \\num{-0.150}** & \\num{0.074}\\\\\n & (\\num{0.151}) & (\\num{0.144}) & (\\num{0.057}) & (\\num{0.050})\\\\\n\\midrule\nNum.Obs. & \\num{48964} & \\num{46494} & \\num{37827} & \\num{36523}\\\\\nR2 Marg. & \\num{0.199} & \\num{0.817} & \\num{0.076} & \\num{0.075}\\\\\nR2 Cond. & \\num{0.244} & \\num{0.823} & \\num{0.076} & \\num{0.079}\\\\\nAIC & \\num{17000.6} & \\num{6412.8} & \\num{10728.8} & \\num{41131.5}\\\\\nBIC & \\num{17247.0} & \\num{6657.8} & \\num{10916.7} & \\num{41369.6}\\\\\nICC & \\num{0.1} & \\num{0.0} & \\num{0.0} & \\num{0.0}\\\\\nRMSE & \\num{0.21} & \\num{0.13} & \\num{0.18} & \\num{0.43}\\\\\n\\bottomrule\n\\multicolumn{5}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n\n::: {#tbl-results-me-4 .cell tbl-cap='Comparison: mixed effects (no lvl 2) vs mixed effects models (with lvl 2)'}\n\n```{.r .cell-code}\nmodelsummary(list(\"No lvl 2\" = m4a.nested,\n                  \"With lvl 2\" = m5a.nested,\n                  \"No lvl 2\" = m4p.nested,\n                  \"With lvl 2\" = m5p.nested,\n                  \"No lvl 2\" = m4s.nested,\n                  \"With lvl 2\" = m5s.red,\n                  \"No lvl 2\" = m4d.nested,\n                  \"With lvl 2\" = m5d.nested),\n             output = \"kableExtra\", stars = T, \n             coef_map = coef_map_me) |> \n  kable_styling(latex_options = \"scale_down\") |> \n  add_header_above(c(\" \" = 1, \"Answer vs No answer\" = 2, \n                     \"Putin vs everyone else\" = 2,\n                     \"Non-systemic vs systemic opposition\" = 2,\n                     \"Davankov vs Spoiled\" = 2))\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccccccc}\n\\toprule\n\\multicolumn{1}{c}{ } & \\multicolumn{2}{c}{Answer vs No answer} & \\multicolumn{2}{c}{Putin vs everyone else} & \\multicolumn{2}{c}{Non-systemic vs systemic opposition} & \\multicolumn{2}{c}{Davankov vs Spoiled} \\\\\n\\cmidrule(l{3pt}r{3pt}){2-3} \\cmidrule(l{3pt}r{3pt}){4-5} \\cmidrule(l{3pt}r{3pt}){6-7} \\cmidrule(l{3pt}r{3pt}){8-9}\n  & No lvl 2 & With lvl 2 & No lvl 2  & With lvl 2  & No lvl 2   & With lvl 2   & No lvl 2    & With lvl 2   \\\\\n\\midrule\nSex: Female & \\num{0.275}*** & \\num{0.258}*** & \\num{0.482}*** & \\num{0.489}*** & \\num{0.022} & \\num{0.015} & \\num{-0.199}*** & \\num{-0.186}***\\\\\n & (\\num{0.044}) & (\\num{0.045}) & (\\num{0.071}) & (\\num{0.073}) & (\\num{0.056}) & (\\num{0.059}) & (\\num{0.024}) & (\\num{0.025})\\\\\nSex: Other & \\num{0.064} & \\num{0.071} & \\num{0.171} & \\num{0.176} & \\num{-0.375} & \\num{-0.232} & \\num{-0.470}** & \\num{-0.462}**\\\\\n & (\\num{0.237}) & (\\num{0.240}) & (\\num{0.368}) & (\\num{0.376}) & (\\num{0.296}) & (\\num{0.328}) & (\\num{0.144}) & (\\num{0.148})\\\\\nAge: 18-24 (ref 25-44) & \\num{-0.003} & \\num{0.036} & \\num{0.026} & \\num{0.040} & \\num{-0.095} & \\num{-0.117} & \\num{0.062}+ & \\num{0.064}+\\\\\n & (\\num{0.081}) & (\\num{0.083}) & (\\num{0.124}) & (\\num{0.125}) & (\\num{0.086}) & (\\num{0.088}) & (\\num{0.037}) & (\\num{0.038})\\\\\nAge: 45-65 (ref 25-44) & \\num{0.180}** & \\num{0.194}** & \\num{1.322}*** & \\num{1.316}*** & \\num{-0.302}*** & \\num{-0.299}*** & \\num{-0.826}*** & \\num{-0.823}***\\\\\n & (\\num{0.059}) & (\\num{0.060}) & (\\num{0.086}) & (\\num{0.089}) & (\\num{0.087}) & (\\num{0.090}) & (\\num{0.039}) & (\\num{0.040})\\\\\nAge: 65 + (ref 25-44) & \\num{0.170}* & \\num{0.175}* & \\num{1.507}*** & \\num{1.491}*** & \\num{-0.957}*** & \\num{-0.930}*** & \\num{-0.931}*** & \\num{-0.906}***\\\\\n & (\\num{0.077}) & (\\num{0.078}) & (\\num{0.131}) & (\\num{0.134}) & (\\num{0.155}) & (\\num{0.159}) & (\\num{0.106}) & (\\num{0.108})\\\\\nTook < 1 hour to get to the voting station & \\num{0.376}*** & \\num{0.355}*** & \\num{0.094} & \\num{0.054} & \\num{-0.099} & \\num{-0.081} & \\num{-0.034} & \\num{-0.041}\\\\\n & (\\num{0.052}) & (\\num{0.054}) & (\\num{0.081}) & (\\num{0.084}) & (\\num{0.061}) & (\\num{0.065}) & (\\num{0.026}) & (\\num{0.027})\\\\\nMoved after March 2022 (ref before 2014) & \\num{-0.359}*** & \\num{-0.351}*** & \\num{-2.330}*** & \\num{-2.329}*** & \\num{0.766}*** & \\num{0.817}*** & \\num{0.565}*** & \\num{0.540}***\\\\\n & (\\num{0.069}) & (\\num{0.071}) & (\\num{0.101}) & (\\num{0.103}) & (\\num{0.084}) & (\\num{0.090}) & (\\num{0.040}) & (\\num{0.040})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{-0.207}** & \\num{-0.175}* & \\num{-1.480}*** & \\num{-1.496}*** & \\num{0.409}*** & \\num{0.402}*** & \\num{0.454}*** & \\num{0.444}***\\\\\n & (\\num{0.075}) & (\\num{0.076}) & (\\num{0.109}) & (\\num{0.111}) & (\\num{0.091}) & (\\num{0.093}) & (\\num{0.042}) & (\\num{0.042})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{-0.159}* & \\num{-0.134}+ & \\num{-0.806}*** & \\num{-0.826}*** & \\num{0.296}** & \\num{0.318}** & \\num{0.219}*** & \\num{0.214}***\\\\\n & (\\num{0.080}) & (\\num{0.081}) & (\\num{0.120}) & (\\num{0.121}) & (\\num{0.102}) & (\\num{0.103}) & (\\num{0.045}) & (\\num{0.045})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{-0.039} & \\num{-0.018} & \\num{-0.975}*** & \\num{-1.014}*** & \\num{0.041} & \\num{0.148} & \\num{0.652}*** & \\num{0.647}***\\\\\n & (\\num{0.096}) & (\\num{0.099}) & (\\num{0.143}) & (\\num{0.148}) & (\\num{0.144}) & (\\num{0.153}) & (\\num{0.087}) & (\\num{0.090})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{0.499}*** & \\num{0.551}*** & \\num{-3.960}*** & \\num{-3.956}*** & \\num{0.718}*** & \\num{0.700}*** & \\num{0.387}** & \\num{0.331}*\\\\\n & (\\num{0.082}) & (\\num{0.084}) & (\\num{0.109}) & (\\num{0.111}) & (\\num{0.127}) & (\\num{0.133}) & (\\num{0.139}) & (\\num{0.146})\\\\\nTrust in the result: No (ref Yes) & \\num{-1.328}*** & \\num{-1.355}*** & \\num{-7.218}*** & \\num{-7.238}*** & \\num{1.903}*** & \\num{1.910}*** & \\num{-0.806}*** & \\num{-0.839}***\\\\\n & (\\num{0.060}) & (\\num{0.062}) & (\\num{0.101}) & (\\num{0.103}) & (\\num{0.094}) & (\\num{0.098}) & (\\num{0.105}) & (\\num{0.111})\\\\\nShare of Orthodox Christians &  & \\num{-0.472} &  & \\num{1.888}*** &  & \\num{-0.360}* &  & \\num{0.071}\\\\\n &  & (\\num{0.468}) &  & (\\num{0.412}) &  & (\\num{0.142}) &  & (\\num{0.163})\\\\\nPolyarchy index &  & \\num{0.328} &  & \\num{-0.959} &  & \\num{0.532}* &  & \\num{-0.561}*\\\\\n &  & (\\num{0.668}) &  & (\\num{0.674}) &  & (\\num{0.250}) &  & (\\num{0.233})\\\\\nGDP per capita (log) &  & \\num{-0.280} &  & \\num{-0.336}+ &  & \\num{0.036} &  & \\num{0.037}\\\\\n &  & (\\num{0.174}) &  & (\\num{0.176}) &  & (\\num{0.088}) &  & (\\num{0.072})\\\\\nMilitary agreements: 1 (ref 0) &  & \\num{-0.412} &  & \\num{-0.683} &  &  &  & \\num{0.084}\\\\\n &  & (\\num{0.471}) &  & (\\num{0.454}) &  &  &  & (\\num{0.162})\\\\\nMilitary agreements: 2 (ref 0) &  & \\num{-0.900}+ &  & \\num{-0.705} &  &  &  & \\num{0.160}\\\\\n &  & (\\num{0.507}) &  & (\\num{0.485}) &  &  &  & (\\num{0.171})\\\\\nMilitary agreements: 3 (ref 0) &  & \\num{-0.653} &  & \\num{-0.592} &  &  &  & \\num{0.014}\\\\\n &  & (\\num{0.463}) &  & (\\num{0.427}) &  &  &  & (\\num{0.162})\\\\\nMilitary agreements: 4 (ref 0) &  & \\num{-0.826} &  & \\num{0.149} &  &  &  & \\num{-0.132}\\\\\n &  & (\\num{0.814}) &  & (\\num{0.739}) &  &  &  & (\\num{0.278})\\\\\nExport share &  & \\num{-0.174}** &  & \\num{-0.061} &  & \\num{0.030} &  & \\num{0.018}\\\\\n &  & (\\num{0.062}) &  & (\\num{0.058}) &  & (\\num{0.024}) &  & (\\num{0.016})\\\\\nImport share &  & \\num{0.217}*** &  & \\num{0.123}* &  & \\num{-0.020} &  & \\num{-0.018}\\\\\n &  & (\\num{0.063}) &  & (\\num{0.056}) &  & (\\num{0.020}) &  & (\\num{0.018})\\\\\nUnfriendly status (ref Neutral) &  & \\num{0.622} &  & \\num{0.103} &  &  &  & \\num{0.149}\\\\\n &  & (\\num{0.819}) &  & (\\num{0.794}) &  &  &  & (\\num{0.284})\\\\\nFriendly status (ref Neutral) &  & \\num{0.430} &  & \\num{-0.279} &  &  &  & \\num{0.264}\\\\\n &  & (\\num{0.480}) &  & (\\num{0.466}) &  &  &  & (\\num{0.183})\\\\\nHelp to Ukraine &  & \\num{-1.003}* &  & \\num{-0.599} &  & \\num{-0.124} &  & \\num{-0.255}\\\\\n &  & (\\num{0.476}) &  & (\\num{0.532}) &  & (\\num{0.194}) &  & (\\num{0.196})\\\\\nRussian military presence &  & \\num{0.085} &  & \\num{-1.367}* &  & \\num{0.224} &  & \\num{0.254}\\\\\n &  & (\\num{0.728}) &  & (\\num{0.678}) &  & (\\num{0.195}) &  & (\\num{0.264})\\\\\nGeodesic distance (log) &  & \\num{-0.386}* &  & \\num{0.212} &  & \\num{-0.150}** &  & \\num{0.074}\\\\\n &  & (\\num{0.151}) &  & (\\num{0.144}) &  & (\\num{0.057}) &  & (\\num{0.050})\\\\\n\\midrule\nNum.Obs. & \\num{53824} & \\num{48964} & \\num{51202} & \\num{46494} & \\num{42363} & \\num{37827} & \\num{40946} & \\num{36523}\\\\\nR2 Marg. & \\num{0.139} & \\num{0.199} & \\num{0.781} & \\num{0.817} & \\num{0.070} & \\num{0.076} & \\num{0.054} & \\num{0.075}\\\\\nR2 Cond. & \\num{0.227} & \\num{0.244} & \\num{0.813} & \\num{0.823} & \\num{0.075} & \\num{0.076} & \\num{0.070} & \\num{0.079}\\\\\nAIC & \\num{18314.4} & \\num{17000.6} & \\num{6766.2} & \\num{6412.8} & \\num{11756.3} & \\num{10728.8} & \\num{45344.3} & \\num{41131.5}\\\\\nBIC & \\num{18438.9} & \\num{17247.0} & \\num{6890.0} & \\num{6657.8} & \\num{11877.5} & \\num{10916.7} & \\num{45465.0} & \\num{41369.6}\\\\\nICC & \\num{0.1} & \\num{0.1} & \\num{0.1} & \\num{0.0} & \\num{0.0} & \\num{0.0} & \\num{0.0} & \\num{0.0}\\\\\nRMSE & \\num{0.21} & \\num{0.21} & \\num{0.13} & \\num{0.13} & \\num{0.18} & \\num{0.18} & \\num{0.43} & \\num{0.43}\\\\\n\\bottomrule\n\\multicolumn{9}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{longtable}\n\\usepackage{array}\n\\usepackage{multirow}\n\\usepackage{wrapfig}\n\\usepackage{float}\n\\usepackage{colortbl}\n\\usepackage{pdflscape}\n\\usepackage{tabu}\n\\usepackage{threeparttable}\n\\usepackage{threeparttablex}\n\\usepackage[normalem]{ulem}\n\\usepackage{makecell}\n\\usepackage{xcolor}\n\\usepackage{siunitx}\n\n  \\newcolumntype{d}{S[\n    input-open-uncertainty=,\n    input-close-uncertainty=,\n    parse-numbers = false,\n    table-align-text-pre=false,\n    table-align-text-post=false\n  ]}\n  \n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}