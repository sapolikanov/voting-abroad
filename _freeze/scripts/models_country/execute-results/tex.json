{
  "hash": "8b176c1f9385c747846e668ad4af27e3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Country-level analysis: models\"\nsubtitle: \"Part of the final project for AQMSS II\"\nauthor: \"Polikanov Stepan and Okisheva Vera\"\nformat: pdf\nembed-resources: true\nexecute: \n  echo: true\n  warning: false\n  error: false\n  message: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(here::here(\"utilities\", \"check_packages.R\"))\nsource(here::here(\"utilities\", \"functions.R\"))\n\nconflicts_prefer(dplyr::filter)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_country <- read_rds(here(\"data\", \"data_built\", \"data_country.rds\"))\n```\n:::\n\n\n# Aggregated models\n\nWe first run models aggregated to the country-level. This approach has an attractive feature of simplicity and the inability to run out of degrees of freedom. We aggregate to the country- rather than city- or voting station- level because the indicators and variables available to us were either available only at the country-level, are possible to measure only at the country-level (export and import for example) or are comparable only between countries. This means that we may miss some of the between-city variation in the data, however due to selection this is better addressed in the exit-poll sample choice models.\n\n## Selection into conducting exit polls\n\nAs mentioned elsewhere, exit polls are not a representative sample of all voting stations abroad. As initiative that conducted them self-described as founded by \"free people and independent activists from Russia living abroad\". This means that this endeavor is easily labelled within the \"non-systemic opposition\" in Russia by both descriptive signals (civic engagement, control of elections to avoid electoral fraud and simply \"activism\") and scope of operation (WEIRD countries, mostly within OECD and popular Russian tourist or immigration spots such as Vietnam or Kazakhstan).\n\nTo empirically confirm this we run regressions with an outcome denoting whether an exit poll was conducted at a voting station abroad. We relate this to variables that might affect migration choice as well as the baseline number of migrants in the country.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(ep ~ vdem_polyarchy_2022 + log(mad_gdppc_2018) + orthodox_share\n         + log(dist) + log(voters_in_list) + log(mean_trips), data = data_country)\n\nm1.log <- glm(ep ~ vdem_polyarchy_2022 + log(mad_gdppc_2018) + orthodox_share\n              + log(dist) + log(voters_in_list)+ log(mean_trips),\n              data = data_country, family = \"binomial\")\n\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = ep ~ vdem_polyarchy_2022 + log(mad_gdppc_2018) + \n    orthodox_share + log(dist) + log(voters_in_list) + log(mean_trips), \n    data = data_country)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.7548 -0.2099  0.0293  0.1848  0.6735 \n\nCoefficients:\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -0.292865   0.537066  -0.545   0.5866    \nvdem_polyarchy_2022  0.746300   0.113408   6.581 1.29e-09 ***\nlog(mad_gdppc_2018)  0.022125   0.033887   0.653   0.5151    \northodox_share      -0.178875   0.177499  -1.008   0.3156    \nlog(dist)           -0.090970   0.047854  -1.901   0.0597 .  \nlog(voters_in_list)  0.124133   0.027041   4.590 1.10e-05 ***\nlog(mean_trips)      0.001009   0.011522   0.088   0.9304    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3014 on 120 degrees of freedom\n  (15 observations deleted due to missingness)\nMultiple R-squared:  0.6022,\tAdjusted R-squared:  0.5823 \nF-statistic: 30.27 on 6 and 120 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(m1.log)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = ep ~ vdem_polyarchy_2022 + log(mad_gdppc_2018) + \n    orthodox_share + log(dist) + log(voters_in_list) + log(mean_trips), \n    family = \"binomial\", data = data_country)\n\nCoefficients:\n                     Estimate Std. Error z value Pr(>|z|)    \n(Intercept)         -29.85513   10.39357  -2.872 0.004073 ** \nvdem_polyarchy_2022   8.39480    2.25693   3.720 0.000200 ***\nlog(mad_gdppc_2018)   1.04301    0.58517   1.782 0.074682 .  \northodox_share       -2.21453    1.90451  -1.163 0.244918    \nlog(dist)             0.02696    0.54767   0.049 0.960737    \nlog(voters_in_list)   1.95444    0.54075   3.614 0.000301 ***\nlog(mean_trips)       0.05063    0.12307   0.411 0.680811    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 158.245  on 126  degrees of freedom\nResidual deviance:  47.089  on 120  degrees of freedom\n  (15 observations deleted due to missingness)\nAIC: 61.089\n\nNumber of Fisher Scoring iterations: 8\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_m1.log <- plot(check_model(m1.log))\ncheck_m1.log[[4]] <- check_m1.log[[4]] + theme(axis.text.x = element_text(\n  angle = 45,hjust = 1)\n  )\ncheck_m1.log\n```\n\n::: {.cell-output-display}\n![](models_country_files/figure-pdf/models-linear-1-1.pdf)\n:::\n\n```{.r .cell-code}\nsave(m1.log, file = here(\"data\", \"data_built\", \"m1_log.rds\"))\n```\n:::\n\n\n\n## Vote shares\n\nAs the dependent variables here are vote shares (percent, 0-100 for use of interpretation), we use a linear regression model. Here is the simplest model using our preferred variables. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2p <- lm(putin_full ~ orthodox_share + vdem_polyarchy_2022 \n          + log(mad_gdppc_2018) + obl_type + export_share + import_share \n          + friendly_status + help + military_dummy + log(dist) + log(mean_trips), \n          data = data_country)\n\nm2d <- lm(davankov_full ~ orthodox_share + vdem_polyarchy_2022 \n          + log(mad_gdppc_2018) + obl_type + export_share + import_share \n          + friendly_status + help + military_dummy + log(dist) + log(mean_trips), \n          data = data_country)\n\nm2s <- lm(spoiled_full ~ orthodox_share + vdem_polyarchy_2022 \n          + log(mad_gdppc_2018) + obl_type + export_share + import_share \n          + friendly_status + help + military_dummy + log(dist) + log(mean_trips), \n          data = data_country)\n```\n:::\n\n::: {.cell freeze='false'}\n\n```{.r .cell-code}\nsave(list = c(\"m2p\", \"m2d\", \"m2s\"), \n     file = here(\"data\", \"data_built\", \"lin.RData\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef_map_lm <- c(\"(Intercept)\",\n                 \"orthodox_share\" = \"Share of Orthodox Christians\",\n                 \"vdem_polyarchy_2022\" = \"Polyarchy index\",\n                 \"log(mad_gdppc_2018)\" = \"GDP per capita (log)\",\n                 \"obl_type1\" = \"Military agreements: 1 (ref 0)\",\n                 \"obl_type2\" = \"Military agreements: 2 (ref 0)\",\n                 \"obl_type3\" = \"Military agreements: 3 (ref 0)\",\n                 \"obl_type4\" = \"Military agreements: 4 (ref 0)\",\n                 \"export_share\" = \"Export share\",\n                 \"import_share\" = \"Import share\",\n                 \"friendly_statusUnfriendly\" = \n                   \"Unfriendly status (ref Neutral)\",\n                 \"friendly_statusFriendly\" =\n                   \"Friendly status (ref Neutral)\",\n                 \"help\" = \"Help to Ukraine\",\n                 \"military_dummy\" = \"Russian military presence\",\n                 \"log(dist)\" = \"Geodesic distance (log)\")\n```\n:::\n\n::: {#tbl-models-linear-2 .cell tbl-cap='Linear models for vote shares'}\n\n```{.r .cell-code}\nmodelsummary(list(\"Putin\" = m2p, \"Davankov\" = m2d, \"Spoiled\" = m2s),\n             output = \"kableExtra\", \n             stars = T, vcov = \"robust\",\n             coef_map = coef_map_lm) |> \n  kable_styling(latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lccc}\n\\toprule\n  & Putin & Davankov & Spoiled\\\\\n\\midrule\nShare of Orthodox Christians & \\num{32.482}** & \\num{-22.382}* & \\num{-9.951}***\\\\\n & (\\num{11.218}) & (\\num{9.315}) & (\\num{2.830})\\\\\nPolyarchy index & \\num{-21.605}** & \\num{15.022}** & \\num{7.708}***\\\\\n & (\\num{7.132}) & (\\num{5.570}) & (\\num{1.973})\\\\\nGDP per capita (log) & \\num{-3.992}* & \\num{3.374}** & \\num{0.958}*\\\\\n & (\\num{1.587}) & (\\num{1.212}) & (\\num{0.376})\\\\\nMilitary agreements: 1 (ref 0) & \\num{-5.746} & \\num{3.272} & \\num{1.660}+\\\\\n & (\\num{3.647}) & (\\num{2.779}) & (\\num{0.982})\\\\\nMilitary agreements: 2 (ref 0) & \\num{-3.177} & \\num{1.735} & \\num{1.509}\\\\\n & (\\num{5.102}) & (\\num{3.781}) & (\\num{1.284})\\\\\nMilitary agreements: 3 (ref 0) & \\num{-8.516} & \\num{6.848} & \\num{2.055}\\\\\n & (\\num{7.284}) & (\\num{5.700}) & (\\num{2.048})\\\\\nMilitary agreements: 4 (ref 0) & \\num{2.972} & \\num{-1.983} & \\num{0.924}\\\\\n & (\\num{8.597}) & (\\num{6.117}) & (\\num{2.105})\\\\\nExport share & \\num{-3.195}** & \\num{2.251}** & \\num{0.901}*\\\\\n & (\\num{1.055}) & (\\num{0.842}) & (\\num{0.421})\\\\\nImport share & \\num{1.614} & \\num{-1.189} & \\num{-0.492}\\\\\n & (\\num{2.037}) & (\\num{1.578}) & (\\num{0.474})\\\\\nUnfriendly status (ref Neutral) & \\num{-7.973} & \\num{4.735} & \\num{3.463}\\\\\n & (\\num{7.458}) & (\\num{5.474}) & (\\num{2.272})\\\\\nFriendly status (ref Neutral) & \\num{-2.690} & \\num{2.521} & \\num{0.685}\\\\\n & (\\num{3.009}) & (\\num{2.270}) & (\\num{0.823})\\\\\nHelp to Ukraine & \\num{-4.335} & \\num{2.510} & \\num{1.991}\\\\\n & (\\num{6.758}) & (\\num{4.666}) & (\\num{2.005})\\\\\nRussian military presence & \\num{2.270} & \\num{-1.869} & \\num{0.096}\\\\\n & (\\num{3.148}) & (\\num{2.452}) & (\\num{0.894})\\\\\nGeodesic distance (log) & \\num{-2.606} & \\num{2.394} & \\num{-0.573}\\\\\n & (\\num{2.843}) & (\\num{2.156}) & (\\num{0.822})\\\\\n\\midrule\nNum.Obs. & \\num{125} & \\num{125} & \\num{125}\\\\\nR2 & \\num{0.652} & \\num{0.593} & \\num{0.753}\\\\\nR2 Adj. & \\num{0.604} & \\num{0.537} & \\num{0.719}\\\\\nAIC & \\num{1023.2} & \\num{959.4} & \\num{696.2}\\\\\nBIC & \\num{1071.3} & \\num{1007.5} & \\num{744.3}\\\\\nLog.Lik. & \\num{-494.588} & \\num{-462.708} & \\num{-331.124}\\\\\nF & \\num{15.710} & \\num{12.588} & \\num{21.638}\\\\\nRMSE & \\num{12.65} & \\num{9.80} & \\num{3.42}\\\\\nStd.Errors & HC3 & HC3 & HC3\\\\\n\\bottomrule\n\\multicolumn{4}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_m2p <- plot(check_model(m2p))\n```\n\n```{.r .cell-code}\ncheck_m2p[[5]] <- check_m2p[[5]] + theme(axis.text.x = element_text(angle = 45,\n                                                                    hjust = 1))\n\n\ncheck_m2d <- plot(check_model(m2d))\n```\n\n```{.r .cell-code}\ncheck_m2d[[5]] <- check_m2d[[5]] + theme(axis.text.x = element_text(angle = 45,\n                                                                    hjust = 1))\n                                                                    \ncheck_m2s <- plot(check_model(m2s))\n```\n\n```{.r .cell-code}\ncheck_m2s[[5]] <- check_m2s[[5]] + theme(axis.text.x = element_text(angle = 45,\n                                                                    hjust = 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_m2p\n```\n\n::: {.cell-output-display}\n![](models_country_files/figure-pdf/plot-check-models-linear-2-1.pdf)\n:::\n\n```{.r .cell-code}\ncheck_m2d \n```\n\n::: {.cell-output-display}\n![](models_country_files/figure-pdf/plot-check-models-linear-2-2.pdf)\n:::\n\n```{.r .cell-code}\ncheck_m2s\n```\n\n::: {.cell-output-display}\n![](models_country_files/figure-pdf/plot-check-models-linear-2-3.pdf)\n:::\n:::\n",
    "supporting": [
      "models_country_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{longtable}\n\\usepackage{array}\n\\usepackage{multirow}\n\\usepackage{wrapfig}\n\\usepackage{float}\n\\usepackage{colortbl}\n\\usepackage{pdflscape}\n\\usepackage{tabu}\n\\usepackage{threeparttable}\n\\usepackage{threeparttablex}\n\\usepackage[normalem]{ulem}\n\\usepackage{makecell}\n\\usepackage{xcolor}\n\\usepackage{siunitx}\n\n  \\newcolumntype{d}{S[\n    input-open-uncertainty=,\n    input-close-uncertainty=,\n    parse-numbers = false,\n    table-align-text-pre=false,\n    table-align-text-post=false\n  ]}\n  \n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}