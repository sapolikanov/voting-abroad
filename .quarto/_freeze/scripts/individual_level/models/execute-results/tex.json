{
  "hash": "2efab0930497a9d30b3cadd8d9d0c6bc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Individual-level analysis: models\"\nsubtitle: \"Part of the final project for AQMSS II\"\nauthor: \"Polikanov Stepan and Okisheva Vera\"\nformat:\n  pdf:\n    fig-pos: \"H\"\n    fontsize: 11pt\n    highlight-style: kate\n    fig-width: 10\n    fig-height: 6\n    include-in-header:\n      - text: |\n          \\addtokomafont{disposition}{\\rmfamily} \n          \\AddToHook{env/Highlighting/begin}{\\scriptsize} \n          \\usepackage{float} \n          \\usepackage[backend = biber, style = apa]{biblatex}\nembed-resources: true\nexecute: \n  echo: true\n  warning: false\n  error: false\n  message: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(here::here(\"utilities\", \"check_packages.R\"))\nsource(here::here(\"utilities\", \"functions.R\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nep_raw_dep <- read_rds(here(\"data\", \"data_built\", \"ep_raw_dep.rds\"))\ndata_country <- read_rds(here(\"data\", \"data_built\", \"data_country.rds\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nload(here(\"scripts\", \"models\", \"feme_bobyqa.RData\"))\nload(here(\"scripts\", \"models\", \"nlme_bobyqa.RData\"))\nload(here(\"scripts\", \"models\", \"me_allfit.RData\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Recode no data back to native NA\nmodel_data <- ep_raw_dep |> \n  mutate(across(c(sex, age_bin, time_to_vs.less_than_hour, \n                  time_to_vs.less_than_hour, out_of_Russia_time, \n                  result_trust_bin), \n                ~ if_else(. %in% c(\"No Data\", \"Declined to answer\"), NA, .)),\n         vote = relevel(as.factor(vote), ref = \"Putin\"),\n         sex = relevel(as.factor(sex), ref = \"Male\"),\n         age_bin = relevel(as.factor(age_bin), ref = \"25-44\"),\n         out_of_Russia_time = relevel(as.factor(out_of_Russia_time), ref = \"Before annexation\"),\n         result_trust_bin = relevel(as.factor(result_trust_bin), ref = \"Yes\")) |> \n  filter(!countryname_en %in% c(\"New Zealand\", \"Australia\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef_map_default <- c(\"(Intercept)\", \"sexFemale\" = \"Sex: Female\", \n                      \"sexOther\" = \"Sex: Other\", \n                      \"age_bin18-24\" = \"Age: 18-24 (ref 25-44)\", \n                      \"age_bin45-64\" = \"Age: 45-65 (ref 25-44)\", \n                      \"age_bin65+\" = \"Age: 65 + (ref 25-44)\", \n                      \"time_to_vs.less_than_hourYes\" = \n                        \"Took < 1 hour to get to the voting station\",\n                      \"out_of_Russia_timeAfter invasion\" = \n                        \"Moved after March 2022 (ref before 2014)\", \n                      \"out_of_Russia_time2 - 5 years\" = \n                        paste(\"Moved after March 2019 but before\",\n                              \"March 2022 (ref before 2014)\"),\n                      \"out_of_Russia_timeAfter annexation\" =\n                        paste(\"Moved after March 2014 but before\",\n                              \"March 2019 (ref before 2014)\"),\n                      \"out_of_Russia_timeTourist (lives in Russia)\" =\n                        paste(\"Didn't move - tourist, lives\",\n                              \"in Russia (ref before 2014)\"),\n                      \"result_trust_binDon't know\" = \n                        \"Trust in the result: Don't know (ref Yes)\",\n                      \"result_trust_binNo\" = \n                        \"Trust in the result: No (ref Yes)\")\n```\n:::\n\n::: {#tbl-linear-dummy .cell tbl-cap='Binary outcomes, linear models, naive approach'}\n\n```{.r .cell-code}\nmodel_data |> \n  pivot_longer(cols = c(vote_putin, vote_declined, vote_putin_declined,\n                        vote_davankov, vote_spoiled, vote_opposition)) |> \n  nest(data = -name) |> \n  transmute(m1.naive = map(data, \n                        ~ lm(value ~ sex + age_bin + time_to_vs.less_than_hour\n                             + out_of_Russia_time + result_trust_bin,\n                             data = .))) |> \n  deframe() |> \n  set_names(c(\"Vote Putin\", \"Decline to Answer\", \"Putin or Declined\", \n              \"Vote Davankov\", \"Spoil the ballot\", \"Vote Davankov or spoil\")) |>\n  modelsummary(output = \"kableExtra\", vcov = \"robust\", stars = T,\n               gof_map = c(\"nobs\", \"adj.r.squared\", \"bic\", \"logLik\", \"rmse\"),\n               coef_map = coef_map_default) |> \n  kable_styling(latex_options = c(\"scale_down\"))\n```\n\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccccc}\n\\toprule\n  & Vote Putin & Decline to Answer & Putin or Declined & Vote Davankov & Spoil the ballot & Vote Davankov or spoil\\\\\n\\midrule\nSex: Female & \\num{0.010}*** & \\num{0.008}*** & \\num{0.018}*** & \\num{-0.042}*** & \\num{0.028}*** & \\num{-0.014}***\\\\\n & (\\num{0.002}) & (\\num{0.002}) & (\\num{0.002}) & (\\num{0.004}) & (\\num{0.003}) & (\\num{0.002})\\\\\nSex: Other & \\num{0.005} & \\num{0.003} & \\num{0.008} & \\num{-0.087}*** & \\num{0.063}** & \\num{-0.024}+\\\\\n & (\\num{0.012}) & (\\num{0.013}) & (\\num{0.012}) & (\\num{0.023}) & (\\num{0.022}) & (\\num{0.014})\\\\\nAge: 18-24 (ref 25-44) & \\num{-0.003} & \\num{0.000} & \\num{-0.003} & \\num{0.005} & \\num{-0.006} & \\num{-0.001}\\\\\n & (\\num{0.002}) & (\\num{0.002}) & (\\num{0.003}) & (\\num{0.006}) & (\\num{0.006}) & (\\num{0.004})\\\\\nAge: 45-65 (ref 25-44) & \\num{0.044}*** & \\num{0.015}*** & \\num{0.059}*** & \\num{-0.154}*** & \\num{0.091}*** & \\num{-0.063}***\\\\\n & (\\num{0.004}) & (\\num{0.004}) & (\\num{0.003}) & (\\num{0.006}) & (\\num{0.005}) & (\\num{0.004})\\\\\nAge: 65 + (ref 25-44) & \\num{0.064}*** & \\num{0.029}*** & \\num{0.093}*** & \\num{-0.152}*** & \\num{0.053}*** & \\num{-0.099}***\\\\\n & (\\num{0.008}) & (\\num{0.007}) & (\\num{0.005}) & (\\num{0.007}) & (\\num{0.006}) & (\\num{0.005})\\\\\nTook < 1 hour to get to the voting station & \\num{0.001} & \\num{0.013}*** & \\num{0.014}*** & \\num{-0.013}*** & \\num{-0.004} & \\num{-0.017}***\\\\\n & (\\num{0.002}) & (\\num{0.002}) & (\\num{0.002}) & (\\num{0.004}) & (\\num{0.004}) & (\\num{0.002})\\\\\nMoved after March 2022 (ref before 2014) & \\num{-0.048}*** & \\num{-0.020}*** & \\num{-0.067}*** & \\num{0.169}*** & \\num{-0.088}*** & \\num{0.081}***\\\\\n & (\\num{0.003}) & (\\num{0.003}) & (\\num{0.003}) & (\\num{0.006}) & (\\num{0.005}) & (\\num{0.004})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{-0.042}*** & \\num{-0.017}*** & \\num{-0.059}*** & \\num{0.113}*** & \\num{-0.051}*** & \\num{0.062}***\\\\\n & (\\num{0.004}) & (\\num{0.004}) & (\\num{0.004}) & (\\num{0.007}) & (\\num{0.006}) & (\\num{0.004})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{-0.034}*** & \\num{-0.016}*** & \\num{-0.049}*** & \\num{0.050}*** & \\num{-0.001} & \\num{0.049}***\\\\\n & (\\num{0.004}) & (\\num{0.004}) & (\\num{0.004}) & (\\num{0.007}) & (\\num{0.007}) & (\\num{0.005})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{0.002} & \\num{-0.015}* & \\num{-0.013}* & \\num{0.077}*** & \\num{-0.070}*** & \\num{0.007}\\\\\n & (\\num{0.007}) & (\\num{0.007}) & (\\num{0.006}) & (\\num{0.009}) & (\\num{0.007}) & (\\num{0.007})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{-0.666}*** & \\num{0.031}*** & \\num{-0.634}*** & \\num{0.436}*** & \\num{0.136}*** & \\num{0.572}***\\\\\n & (\\num{0.008}) & (\\num{0.009}) & (\\num{0.010}) & (\\num{0.011}) & (\\num{0.007}) & (\\num{0.011})\\\\\nTrust in the result: No (ref Yes) & \\num{-0.731}*** & \\num{-0.081}*** & \\num{-0.812}*** & \\num{0.458}*** & \\num{0.328}*** & \\num{0.786}***\\\\\n & (\\num{0.005}) & (\\num{0.004}) & (\\num{0.005}) & (\\num{0.005}) & (\\num{0.004}) & (\\num{0.005})\\\\\n\\midrule\nNum.Obs. & \\num{54111} & \\num{54111} & \\num{54111} & \\num{54111} & \\num{54111} & \\num{54111}\\\\\nR2 Adj. & \\num{0.726} & \\num{0.047} & \\num{0.763} & \\num{0.291} & \\num{0.082} & \\num{0.668}\\\\\nBIC & \\num{-24139.2} & \\num{-15371.5} & \\num{-20960.5} & \\num{59423.4} & \\num{50050.2} & \\num{2406.8}\\\\\nLog.Lik. & \\num{12145.880} & \\num{7762.046} & \\num{10556.535} & \\num{-29635.417} & \\num{-24948.803} & \\num{-1127.086}\\\\\nRMSE & \\num{0.19} & \\num{0.21} & \\num{0.20} & \\num{0.42} & \\num{0.38} & \\num{0.25}\\\\\n\\bottomrule\n\\multicolumn{7}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n:::\n\n\n# Multinomial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2.naive <- multinom(vote ~ sex + age_bin + time_to_vs.less_than_hour\n                     + out_of_Russia_time + result_trust_bin, \n                     data = model_data, model = F)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm2.fe <- multinom(vote ~ sex + age_bin + time_to_vs.less_than_hour\n                  + out_of_Russia_time + result_trust_bin\n                  + as.factor(voting_station), \n                  data = model_data, model = F)\n```\n:::\n\n::: {#tbl-multinom-naive .cell tbl-cap='Multinomial regression, naive approach'}\n\n```{.r .cell-code}\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells   5476757  292.5    9081791  485.1   9081791  485.1\nVcells 137755836 1051.0  219183858 1672.3 182282060 1390.8\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelsummary(list(\"Naive approach\" = m2.naive), \n             output = \"kableExtra\",\n             stars = T, shape = term ~ response, \n             coef_map = coef_map_default, \n             gof_map = c(\"nobs\", \"adj.r.squared\", \"bic\", \"rmse\")) |> \n  kable_styling(latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccccc}\n\\toprule\n\\multicolumn{1}{c}{ } & \\multicolumn{6}{c}{Naive approach} \\\\\n\\cmidrule(l{3pt}r{3pt}){2-7}\n  & Davankov & Declined to answer & Haritonov & Slutsky & Spoiled ballot & Tore up/took\\\\\n\\midrule\nSex: Female & \\num{-0.565}*** & \\num{-0.070} & \\num{-0.590}*** & \\num{-0.471}*** & \\num{-0.339}*** & \\num{-0.691}***\\\\\n & (\\num{0.056}) & (\\num{0.052}) & (\\num{0.084}) & (\\num{0.102}) & (\\num{0.059}) & (\\num{0.132})\\\\\nSex: Other & \\num{-0.503} & \\num{-0.045} & \\num{-0.130} & \\num{0.326} & \\num{0.022} & \\num{0.400}\\\\\n & (\\num{0.314}) & (\\num{0.267}) & (\\num{0.466}) & (\\num{0.489}) & (\\num{0.324}) & (\\num{0.588})\\\\\nAge: 18-24 (ref 25-44) & \\num{0.114} & \\num{0.106} & \\num{0.069} & \\num{0.384}* & \\num{0.087} & \\num{0.423}*\\\\\n & (\\num{0.105}) & (\\num{0.111}) & (\\num{0.147}) & (\\num{0.161}) & (\\num{0.109}) & (\\num{0.203})\\\\\nAge: 45-65 (ref 25-44) & \\num{-1.308}*** & \\num{-0.213}*** & \\num{-0.769}*** & \\num{-0.733}*** & \\num{-0.452}*** & \\num{-0.171}\\\\\n & (\\num{0.069}) & (\\num{0.061}) & (\\num{0.119}) & (\\num{0.147}) & (\\num{0.073}) & (\\num{0.179})\\\\\nAge: 65 + (ref 25-44) & \\num{-1.870}*** & \\num{-0.091} & \\num{-0.507}** & \\num{-0.800}** & \\num{-0.871}*** & \\num{-0.414}\\\\\n & (\\num{0.118}) & (\\num{0.076}) & (\\num{0.183}) & (\\num{0.248}) & (\\num{0.127}) & (\\num{0.383})\\\\\nTook < 1 hour to get to the voting station & \\num{-0.326}*** & \\num{0.163}** & \\num{-0.236}** & \\num{-0.169} & \\num{-0.323}*** & \\num{-0.208}\\\\\n & (\\num{0.062}) & (\\num{0.059}) & (\\num{0.091}) & (\\num{0.111}) & (\\num{0.064}) & (\\num{0.139})\\\\\nMoved after March 2022 (ref before 2014) & \\num{1.877}*** & \\num{0.623}*** & \\num{0.895}*** & \\num{1.086}*** & \\num{1.120}*** & \\num{1.083}***\\\\\n & (\\num{0.074}) & (\\num{0.071}) & (\\num{0.115}) & (\\num{0.146}) & (\\num{0.078}) & (\\num{0.193})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{1.215}*** & \\num{0.209}* & \\num{0.638}*** & \\num{0.814}*** & \\num{0.689}*** & \\num{0.975}***\\\\\n & (\\num{0.088}) & (\\num{0.087}) & (\\num{0.133}) & (\\num{0.166}) & (\\num{0.092}) & (\\num{0.212})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{0.759}*** & \\num{-0.012} & \\num{0.265}+ & \\num{0.653}*** & \\num{0.532}*** & \\num{0.708}**\\\\\n & (\\num{0.096}) & (\\num{0.093}) & (\\num{0.151}) & (\\num{0.179}) & (\\num{0.100}) & (\\num{0.234})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{0.332}** & \\num{-0.244}* & \\num{-0.069} & \\num{0.517}* & \\num{-0.524}*** & \\num{-0.206}\\\\\n & (\\num{0.113}) & (\\num{0.099}) & (\\num{0.201}) & (\\num{0.216}) & (\\num{0.130}) & (\\num{0.395})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{4.100}*** & \\num{2.287}*** & \\num{3.350}*** & \\num{3.594}*** & \\num{3.890}*** & \\num{2.617}***\\\\\n & (\\num{0.105}) & (\\num{0.110}) & (\\num{0.186}) & (\\num{0.192}) & (\\num{0.156}) & (\\num{0.667})\\\\\nTrust in the result: No (ref Yes) & \\num{7.153}*** & \\num{3.648}*** & \\num{5.779}*** & \\num{5.259}*** & \\num{8.187}*** & \\num{7.097}***\\\\\n & (\\num{0.099}) & (\\num{0.100}) & (\\num{0.145}) & (\\num{0.161}) & (\\num{0.130}) & (\\num{0.341})\\\\\n\\midrule\nNum.Obs. & \\num{54111} &  &  &  &  & \\\\\nR2 Adj. & \\num{0.533} &  &  &  &  & \\\\\nBIC & \\num{89346.1} &  &  &  &  & \\\\\nRMSE & \\num{0.25} &  &  &  &  & \\\\\n\\bottomrule\n\\multicolumn{7}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n\n::: {#tbl-multinom-fe .cell tbl-cap='Multinomial regression, fixed effects'}\n\n```{.r .cell-code}\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells   5477354  292.6    9081780  485.1   9081780  485.1\nVcells 136849555 1044.1  219183850 1672.3 182372714 1391.4\n```\n\n\n:::\n\n```{.r .cell-code}\nmodelsummary(list(\"Fixed Effects\" = m2.fe),  \n             output = \"kableExtra\",\n             stars = T, shape = term ~ response, \n             coef_map = coef_map_default, \n             gof_map = c(\"nobs\", \"adj.r.squared\", \"bic\", \"rmse\")) |> \n  kable_styling(latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\\centering\n\\resizebox{\\ifdim\\width>\\linewidth\\linewidth\\else\\width\\fi}{!}{\n\\begin{tabular}[t]{lcccccc}\n\\toprule\n\\multicolumn{1}{c}{ } & \\multicolumn{6}{c}{Fixed Effects} \\\\\n\\cmidrule(l{3pt}r{3pt}){2-7}\n  & Davankov & Declined to answer & Haritonov & Slutsky & Spoiled ballot & Tore up/took\\\\\n\\midrule\nSex: Female & \\num{-0.452}*** & \\num{0.092}+ & \\num{-0.403}*** & \\num{-0.321}** & \\num{-0.248}*** & \\num{-0.644}***\\\\\n & (\\num{0.059}) & (\\num{0.054}) & (\\num{0.090}) & (\\num{0.113}) & (\\num{0.062}) & (\\num{0.147})\\\\\nSex: Other & \\num{-0.679}* & \\num{-0.232} & \\num{-0.302} & \\num{0.196} & \\num{-0.174} & \\num{0.257}\\\\\n & (\\num{0.318}) & (\\num{0.274}) & (\\num{0.489}) & (\\num{0.517}) & (\\num{0.328}) & (\\num{0.617})\\\\\nAge: 18-24 (ref 25-44) & \\num{0.072} & \\num{0.088} & \\num{-0.115} & \\num{0.324}+ & \\num{0.001} & \\num{0.466}*\\\\\n & (\\num{0.112}) & (\\num{0.117}) & (\\num{0.164}) & (\\num{0.180}) & (\\num{0.116}) & (\\num{0.227})\\\\\nAge: 45-65 (ref 25-44) & \\num{-1.289}*** & \\num{-0.287}*** & \\num{-0.735}*** & \\num{-0.715}*** & \\num{-0.439}*** & \\num{0.004}\\\\\n & (\\num{0.073}) & (\\num{0.063}) & (\\num{0.127}) & (\\num{0.163}) & (\\num{0.077}) & (\\num{0.195})\\\\\nAge: 65 + (ref 25-44) & \\num{-1.757}*** & \\num{-0.387}*** & \\num{-0.350}+ & \\num{-0.763}** & \\num{-0.811}*** & \\num{-0.399}\\\\\n & (\\num{0.120}) & (\\num{0.082}) & (\\num{0.197}) & (\\num{0.292}) & (\\num{0.133}) & (\\num{0.465})\\\\\nTook < 1 hour to get to the voting station & \\num{-0.030} & \\num{0.273}*** & \\num{0.113} & \\num{0.075} & \\num{0.001} & \\num{0.050}\\\\\n & (\\num{0.071}) & (\\num{0.066}) & (\\num{0.107}) & (\\num{0.134}) & (\\num{0.073}) & (\\num{0.172})\\\\\nMoved after March 2022 (ref before 2014) & \\num{2.183}*** & \\num{0.796}*** & \\num{1.319}*** & \\num{1.300}*** & \\num{1.647}*** & \\num{1.704}***\\\\\n & (\\num{0.087}) & (\\num{0.083}) & (\\num{0.137}) & (\\num{0.179}) & (\\num{0.092}) & (\\num{0.240})\\\\\nMoved after March 2019 but before March 2022 (ref before 2014) & \\num{1.399}*** & \\num{0.402}*** & \\num{0.869}*** & \\num{0.974}*** & \\num{0.929}*** & \\num{1.316}***\\\\\n & (\\num{0.096}) & (\\num{0.093}) & (\\num{0.146}) & (\\num{0.187}) & (\\num{0.100}) & (\\num{0.248})\\\\\nMoved after March 2014 but before March 2019 (ref before 2014) & \\num{0.854}*** & \\num{0.154} & \\num{0.378}* & \\num{0.846}*** & \\num{0.619}*** & \\num{1.030}***\\\\\n & (\\num{0.101}) & (\\num{0.096}) & (\\num{0.161}) & (\\num{0.195}) & (\\num{0.106}) & (\\num{0.260})\\\\\nDidn't move - tourist, lives in Russia (ref before 2014) & \\num{0.786}*** & \\num{0.231}* & \\num{0.373}+ & \\num{0.949}*** & \\num{0.197} & \\num{0.609}\\\\\n & (\\num{0.126}) & (\\num{0.109}) & (\\num{0.225}) & (\\num{0.254}) & (\\num{0.142}) & (\\num{0.467})\\\\\nTrust in the result: Don't know (ref Yes) & \\num{3.918}*** & \\num{2.318}*** & \\num{3.527}*** & \\num{3.927}*** & \\num{3.713}*** & \\num{-3.139}***\\\\\n & (\\num{0.109}) & (\\num{0.115}) & (\\num{0.198}) & (\\num{0.225}) & (\\num{0.159}) & (\\num{0.005})\\\\\nTrust in the result: No (ref Yes) & \\num{7.630}*** & \\num{4.343}*** & \\num{6.554}*** & \\num{6.311}*** & \\num{8.689}*** & \\num{11.848}***\\\\\n & (\\num{0.137}) & (\\num{0.138}) & (\\num{0.184}) & (\\num{0.215}) & (\\num{0.160}) & (\\num{2.603})\\\\\n\\midrule\nNum.Obs. & \\num{54111} &  &  &  &  & \\\\\nR2 Adj. & \\num{0.542} &  &  &  &  & \\\\\nBIC & \\num{91620.5} &  &  &  &  & \\\\\nRMSE & \\num{0.25} &  &  &  &  & \\\\\n\\bottomrule\n\\multicolumn{7}{l}{\\rule{0pt}{1em}+ p $<$ 0.1, * p $<$ 0.05, ** p $<$ 0.01, *** p $<$ 0.001}\\\\\n\\end{tabular}}\n\\end{table}\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncomparisons <- logits(answer = dichotomy(answer = c(\"Davankov\",\n                                                    \"Spoiled ballot\",\n                                                    \"Slutsky\",\n                                                    \"Haritonov\",\n                                                    \"Putin\"),\n                                         \"Declined to answer\"),\n                      not_putin = dichotomy(opposition = c(\"Davankov\",\n                                                           \"Spoiled ballot\",\n                                                           \"Slutsky\",\n                                                           \"Haritonov\"),\n                                            \"Putin\"),\n                      opposition = dichotomy(\n                        systemic = c(\"Slutsky\", \"Haritonov\"),\n                        nonsystemic = c(\"Davankov\", \"Spoiled ballot\")),\n                      nonsystemic = c(\"Spoiled ballot\", \"Davankov\"),\n                      systemic = c(\"Haritonov\", \"Slutsky\"))\n\nm3.nested <- nestedLogit(vote ~ sex + age_bin + time_to_vs.less_than_hour\n                          + out_of_Russia_time + result_trust_bin, \n                          dichotomies = comparisons,\n                          data = model_data, \n                          subset = model_data$vote != \"Tore up/took\"\n                         | !is.na(model_data$vote))\n\nm3.nested.fe <- nestedLogit(vote ~ sex + age_bin + time_to_vs.less_than_hour\n                          + out_of_Russia_time + result_trust_bin + as.factor(voting_station), \n                          dichotomies = comparisons,\n                          data = model_data, \n                          subset = model_data$vote != \"Tore up/took\"\n                         | !is.na(model_data$vote))\n\nsave(list = c(\"m3.nested\", \"m3.nested.fe\"), \n     file = here(\"scripts\", \"models\", \"nl_fe.RData\"))\n```\n:::\n\n\n```{.r .cell-code}\nresizebox.stargazer(models(m3.nested), \n          title = \"Nested Logit models\", header = F,\n          dep.var.labels = c(\"Don't answer vs answer\", \"Putin vs everyone\", \n                             \"Non-systemic vs systemic opposition\",\n                             \"Spoiled vs Davankov\", \"Slutsky vs Haritonov\"),\n          covariate.labels = c(\n            \"Sex: Female\", \"Sex: Other\", \"Age: 18-24 (ref 25-44)\", \n            \"Age: 45-65 (ref 25-44)\", \"Age: 65 + (ref 25-44)\",\n            \"Took < 1 hour to get to the voting station\",\n            \"Moved after March 2022 (ref before 2014)\", \n            \"Moved after March 2019 but before March 2022 (ref before 2014)\",\n            \"Moved after March 2014 but before March 2019 (ref before 2014)\",\n            \"Didn't move - tourist, lives in Russia (ref before 2014)\",\n            \"Trust in the result: Don't know (ref Yes)\",\n            \"Trust in the result: No (ref Yes)\", \"Intercept\"),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\"\n          )\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Nested Logit models} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lccccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{5}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-6} \n\\\\[-1.8ex] & Don't answer vs answer & Putin vs everyone & Non-systemic vs systemic opposition & Spoiled vs Davankov & Slutsky vs Haritonov \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4) & (5)\\\\ \n\\hline \\\\[-1.8ex] \n Sex: Female & 0.192$^{***}$ & 0.510$^{***}$ & 0.022 & $-$0.220$^{***}$ & 0.155 \\\\ \n  & (0.043) & (0.069) & (0.056) & (0.024) & (0.115) \\\\ \n  & & & & & \\\\ \n Sex: Other & 0.088 & $-$0.138 & $-$0.383 & $-$0.517$^{***}$ & 0.423 \\\\ \n  & (0.234) & (0.372) & (0.298) & (0.146) & (0.573) \\\\ \n  & & & & & \\\\ \n Age: 18-24 (ref 25-44) & 0.004 & $-$0.132 & $-$0.079 & 0.025 & 0.327$^{*}$ \\\\ \n  & (0.080) & (0.118) & (0.085) & (0.036) & (0.170) \\\\ \n  & & & & & \\\\ \n Age: 45-65 (ref 25-44) & 0.249$^{***}$ & 1.336$^{***}$ & $-$0.308$^{***}$ & $-$0.836$^{***}$ & 0.007 \\\\ \n  & (0.057) & (0.083) & (0.087) & (0.039) & (0.179) \\\\ \n  & & & & & \\\\ \n Age: 65 + (ref 25-44) & 0.339$^{***}$ & 1.542$^{***}$ & $-$0.939$^{***}$ & $-$0.959$^{***}$ & $-$0.424 \\\\ \n  & (0.074) & (0.127) & (0.154) & (0.106) & (0.305) \\\\ \n  & & & & & \\\\ \n Took < 1 hour to get to the voting station & 0.349$^{***}$ & 0.368$^{***}$ & $-$0.107$^{*}$ & $-$0.001 & 0.034 \\\\ \n  & (0.049) & (0.075) & (0.059) & (0.024) & (0.122) \\\\ \n  & & & & & \\\\ \n Moved after March 2022 (ref before 2014) & $-$0.294$^{***}$ & $-$1.413$^{***}$ & 0.401$^{***}$ & 0.513$^{***}$ & 0.148 \\\\ \n  & (0.073) & (0.103) & (0.090) & (0.041) & (0.187) \\\\ \n  & & & & & \\\\ \n Moved after March 2019 but before March 2022 (ref before 2014) & $-$0.227$^{***}$ & $-$0.816$^{***}$ & 0.292$^{***}$ & 0.217$^{***}$ & 0.387$^{*}$ \\\\ \n  & (0.078) & (0.116) & (0.102) & (0.045) & (0.208) \\\\ \n  & & & & & \\\\ \n Moved after March 2014 but before March 2019 (ref before 2014) & $-$0.412$^{***}$ & $-$1.991$^{***}$ & 0.741$^{***}$ & 0.742$^{***}$ & 0.163 \\\\ \n  & (0.062) & (0.087) & (0.080) & (0.036) & (0.166) \\\\ \n  & & & & & \\\\ \n Didn't move - tourist, lives in Russia (ref before 2014) & $-$0.200$^{**}$ & $-$0.530$^{***}$ & $-$0.001 & 0.858$^{***}$ & 0.542$^{**}$ \\\\ \n  & (0.090) & (0.130) & (0.141) & (0.084) & (0.274) \\\\ \n  & & & & & \\\\ \n Trust in the result: Don't know (ref Yes) & 0.438$^{***}$ & $-$4.040$^{***}$ & 0.708$^{***}$ & 0.403$^{***}$ & 0.253 \\\\ \n  & (0.080) & (0.105) & (0.127) & (0.140) & (0.239) \\\\ \n  & & & & & \\\\ \n Trust in the result: No (ref Yes) & $-$1.381$^{***}$ & $-$7.365$^{***}$ & 1.913$^{***}$ & $-$0.809$^{***}$ & $-$0.548$^{***}$ \\\\ \n  & (0.057) & (0.099) & (0.094) & (0.106) & (0.183) \\\\ \n  & & & & & \\\\ \n Intercept & $-$2.404$^{***}$ & 1.881$^{***}$ & 1.276$^{***}$ & 1.466$^{***}$ & $-$0.466$^{**}$ \\\\ \n  & (0.072) & (0.098) & (0.119) & (0.111) & (0.229) \\\\ \n  & & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 53,824 & 51,202 & 42,363 & 40,946 & 1,417 \\\\ \nLog Likelihood & $-$9,435.706 & $-$3,530.187 & $-$5,869.120 & $-$22,756.890 & $-$911.162 \\\\ \nAkaike Inf. Crit. & 18,897.410 & 7,086.374 & 11,764.240 & 45,539.780 & 1,848.323 \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{5}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n```{.r .cell-code}\nresizebox.stargazer(models(m3.nested.fe), \n          title = \"Nested Logit models, fixed effects\", header = F,\n          dep.var.labels = c(\"Don't answer vs answer\", \"Putin vs everyone\", \n                             \"Non-systemic vs systemic opposition\",\n                             \"Spoiled vs Davankov\", \"Slutsky vs Haritonov\"),\n          covariate.labels = c(\n            \"Sex: Female\", \"Sex: Other\", \"Age: 18-24 (ref 25-44)\", \n            \"Age: 45-65 (ref 25-44)\", \"Age: 65 + (ref 25-44)\",\n            \"Took < 1 hour to get to the voting station\",\n            \"Moved after March 2022 (ref before 2014)\", \n            \"Moved after March 2019 but before March 2022 (ref before 2014)\",\n            \"Moved after March 2014 but before March 2019 (ref before 2014)\",\n            \"Didn't move - tourist, lives in Russia (ref before 2014)\",\n            \"Trust in the result: Don't know (ref Yes)\",\n            \"Trust in the result: No (ref Yes)\", \"Intercept\"),\n          omit = \"as.factor\", \n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\"\n          )\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Nested Logit models, fixed effects} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lccccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{5}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-6} \n\\\\[-1.8ex] & Don't answer vs answer & Putin vs everyone & Non-systemic vs systemic opposition & Spoiled vs Davankov & Slutsky vs Haritonov \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4) & (5)\\\\ \n\\hline \\\\[-1.8ex] \n Sex: Female & 0.275$^{***}$ & 0.481$^{***}$ & 0.019 & $-$0.195$^{***}$ & 0.121 \\\\ \n  & (0.044) & (0.072) & (0.057) & (0.024) & (0.120) \\\\ \n  & & & & & \\\\ \n Sex: Other & 0.039 & 0.208 & $-$0.371 & $-$0.455$^{***}$ & 0.331 \\\\ \n  & (0.240) & (0.369) & (0.301) & (0.146) & (0.589) \\\\ \n  & & & & & \\\\ \n Age: 18-24 (ref 25-44) & $-$0.008 & 0.019 & $-$0.114 & 0.072$^{*}$ & 0.335$^{*}$ \\\\ \n  & (0.082) & (0.126) & (0.088) & (0.037) & (0.183) \\\\ \n  & & & & & \\\\ \n Age: 45-65 (ref 25-44) & 0.172$^{***}$ & 1.304$^{***}$ & $-$0.294$^{***}$ & $-$0.827$^{***}$ & 0.011 \\\\ \n  & (0.059) & (0.087) & (0.088) & (0.039) & (0.190) \\\\ \n  & & & & & \\\\ \n Age: 65 + (ref 25-44) & 0.161$^{**}$ & 1.501$^{***}$ & $-$0.994$^{***}$ & $-$0.952$^{***}$ & $-$0.461 \\\\ \n  & (0.078) & (0.132) & (0.159) & (0.107) & (0.322) \\\\ \n  & & & & & \\\\ \n Took < 1 hour to get to the voting station & 0.310$^{***}$ & 0.071 & $-$0.086 & $-$0.028 & $-$0.114 \\\\ \n  & (0.055) & (0.085) & (0.067) & (0.027) & (0.144) \\\\ \n  & & & & & \\\\ \n Moved after March 2022 (ref before 2014) & $-$0.217$^{***}$ & $-$1.467$^{***}$ & 0.419$^{***}$ & 0.438$^{***}$ & 0.149 \\\\ \n  & (0.075) & (0.110) & (0.093) & (0.042) & (0.200) \\\\ \n  & & & & & \\\\ \n Moved after March 2019 but before March 2022 (ref before 2014) & $-$0.179$^{**}$ & $-$0.798$^{***}$ & 0.299$^{***}$ & 0.213$^{***}$ & 0.455$^{**}$ \\\\ \n  & (0.081) & (0.121) & (0.103) & (0.046) & (0.220) \\\\ \n  & & & & & \\\\ \n Moved after March 2014 but before March 2019 (ref before 2014) & $-$0.363$^{***}$ & $-$2.357$^{***}$ & 0.820$^{***}$ & 0.539$^{***}$ & 0.093 \\\\ \n  & (0.069) & (0.103) & (0.090) & (0.040) & (0.191) \\\\ \n  & & & & & \\\\ \n Didn't move - tourist, lives in Russia (ref before 2014) & $-$0.002 & $-$0.997$^{***}$ & 0.134 & 0.633$^{***}$ & 0.410 \\\\ \n  & (0.098) & (0.146) & (0.150) & (0.088) & (0.300) \\\\ \n  & & & & & \\\\ \n Trust in the result: Don't know (ref Yes) & 0.521$^{***}$ & $-$3.955$^{***}$ & 0.716$^{***}$ & 0.392$^{***}$ & 0.241 \\\\ \n  & (0.083) & (0.110) & (0.129) & (0.141) & (0.250) \\\\ \n  & & & & & \\\\ \n Trust in the result: No (ref Yes) & $-$1.293$^{***}$ & $-$7.204$^{***}$ & 1.891$^{***}$ & $-$0.804$^{***}$ & $-$0.552$^{***}$ \\\\ \n  & (0.060) & (0.102) & (0.095) & (0.106) & (0.193) \\\\ \n  & & & & & \\\\ \n Intercept & $-$2.146$^{***}$ & 1.379$^{***}$ & 1.223$^{***}$ & 1.401$^{***}$ & $-$0.644 \\\\ \n  & (0.144) & (0.247) & (0.198) & (0.130) & (0.400) \\\\ \n  & & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 53,824 & 51,202 & 42,363 & 40,946 & 1,417 \\\\ \nLog Likelihood & $-$9,008.215 & $-$3,287.206 & $-$5,809.709 & $-$22,553.850 & $-$878.176 \\\\ \nAkaike Inf. Crit. & 18,166.430 & 6,724.412 & 11,769.420 & 45,257.690 & 1,900.352 \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{5}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n\n# Mixed effects models\n\n## Nested Logit\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Drop Australia and New Zealand for this because they have very skewed and low \n# n observations. Might also help with convergence\nnested_me_data <- model_data |>\n  filter(vote != \"Tore up/took\", !countryname_en %in% c(\"Australia\",\n                                                        \"New Zealand\")) |>\n  mutate(non_answer = if_else(vote == \"Declined to answer\", 1, 0),\n         putin_else = case_when(vote == \"Putin\" ~ 1,\n                                vote %in% c(\"Davankov\", \"Spoiled ballot\",\n                                            \"Slutsky\", \"Haritonov\") ~ 0,\n                                .default = NA),\n         nonsys_sys = case_when(vote %in% c(\"Davankov\", \"Spoiled ballot\") ~ 1,\n                                vote %in% c(\"Slutsky\", \"Haritonov\") ~ 0,\n                                .default = NA),\n         davankov_spoiled = case_when(vote == \"Davankov\" ~ 1,\n                                      vote == \"Spoiled ballot\" ~ 0,\n                                      .default = NA),\n         slutsky_haritonov = case_when(vote == \"Slutsky\" ~ 1,\n                                       vote == \"Haritonov\" ~ 0,\n                                       .default = NA)) |> \n  left_join(data_country, by = c(\"countrycode_n\", \"countrycode_c\"))\n```\n:::\n\n\nWe fit the model consecutively for each dichotomy this time separating data by hand in the same way as the ``nestedLogit`` package does.\n\nFor some models we get non-convergence. We diagnose which optimizers work fine in those case and update the model to achieve convergence.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Answer (1) vs non-answer (0)\nm4a.nested <- glmer(non_answer ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n\n# Fit using all optimizers\n# m4.allfit <- allFit(m4a.nested)\n\n# bobyqa works so use that in the previous call (no reason to estimate it again \n# for knitr destruction reasons)\nsummary(m4a.nested)\n```\n:::\n\n\n### Not answer v answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add second-level predicotrs\nm5a.nested <- glmer(non_answer ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status + help + military_dummy\n                    + log(dist) + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\",\n                                           optCtrl = list(maxfun = 1e9)))\n  # Doesn't converge\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nderivs1 <- m5a.nested@optinfo$derivs\nsc_grad1 <- with(derivs1,solve(Hessian,gradient))\nmax(abs(sc_grad1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.005623852\n```\n\n\n:::\n\n```{.r .cell-code}\nmax(pmin(abs(sc_grad1),abs(derivs1$gradient)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.002404067\n```\n\n\n:::\n\n```{.r .cell-code}\ndd <- update(m5a.nested,devFunOnly=TRUE)\npars <- unlist(getME(m5a.nested,c(\"theta\",\"fixef\")))\ngrad2 <- grad(dd,pars)\nhess2 <- hessian(dd,pars)\nsc_grad2 <- solve(hess2,grad2)\nmax(pmin(abs(sc_grad2),abs(grad2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.002430115\n```\n\n\n:::\n\n```{.r .cell-code}\n# Fit with all optimizers\n# m5a.allfit <- allFit(m5a.nested, maxfun = 1e9)\n\n# No options seem to work\nm5a.allfit_OK <- m5a.allfit[sapply(m5a.allfit, is, \"merMod\")]\nlapply(m5a.allfit_OK, function(x) x@optinfo$conv$lme4$messages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$bobyqa\n[1] \"Model failed to converge with max|grad| = 0.00240407 (tol = 0.002, component 1)\"\n\n$Nelder_Mead\n[1] \"Model failed to converge with max|grad| = 0.0288314 (tol = 0.002, component 1)\"\n\n$nlminbwrap\n[1] \"Model failed to converge with max|grad| = 0.071349 (tol = 0.002, component 1)\"\n\n$nmkbw\n[1] \"Model failed to converge with max|grad| = 0.0112403 (tol = 0.002, component 1)\"\n\n$`optimx.L-BFGS-B`\n[1] \"unable to evaluate scaled gradient\"                                       \n[2] \"Model failed to converge: degenerate  Hessian with 1 negative eigenvalues\"\n\n$nloptwrap.NLOPT_LN_NELDERMEAD\n[1] \"unable to evaluate scaled gradient\"                                       \n[2] \"Model failed to converge: degenerate  Hessian with 1 negative eigenvalues\"\n\n$nloptwrap.NLOPT_LN_BOBYQA\n[1] \"Model failed to converge with max|grad| = 0.0450179 (tol = 0.002, component 1)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# The gradient cutoffs for Nelder Mead (nlopt), bobyqa and nlminwrap seem to \n# be close to what I am getting. \n\n# Check for singular fit \ntt <- getME(m5a.nested,\"theta\")\nll <- getME(m5a.nested,\"lower\")\nmin(tt[ll==0]) # Nope, no singular fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4415713\n```\n\n\n:::\n\n```{.r .cell-code}\n# The only other thing to try is to see whether the coefficients change in unconverged models\nis.OK <- sapply(m5a.allfit, is, \"merMod\")\nm5a.allfit.OK <- m5a.allfit[is.OK]\nlapply(m5a.allfit.OK,function(x) x@optinfo$conv$lme4$messages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$bobyqa\n[1] \"Model failed to converge with max|grad| = 0.00240407 (tol = 0.002, component 1)\"\n\n$Nelder_Mead\n[1] \"Model failed to converge with max|grad| = 0.0288314 (tol = 0.002, component 1)\"\n\n$nlminbwrap\n[1] \"Model failed to converge with max|grad| = 0.071349 (tol = 0.002, component 1)\"\n\n$nmkbw\n[1] \"Model failed to converge with max|grad| = 0.0112403 (tol = 0.002, component 1)\"\n\n$`optimx.L-BFGS-B`\n[1] \"unable to evaluate scaled gradient\"                                       \n[2] \"Model failed to converge: degenerate  Hessian with 1 negative eigenvalues\"\n\n$nloptwrap.NLOPT_LN_NELDERMEAD\n[1] \"unable to evaluate scaled gradient\"                                       \n[2] \"Model failed to converge: degenerate  Hessian with 1 negative eigenvalues\"\n\n$nloptwrap.NLOPT_LN_BOBYQA\n[1] \"Model failed to converge with max|grad| = 0.0450179 (tol = 0.002, component 1)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n(lliks <- sort(sapply(m5a.allfit.OK,logLik)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              optimx.L-BFGS-B                   Nelder_Mead \n                    -8472.303                     -8472.302 \n    nloptwrap.NLOPT_LN_BOBYQA                    nlminbwrap \n                    -8472.302                     -8472.302 \n                        nmkbw                        bobyqa \n                    -8472.302                     -8472.302 \nnloptwrap.NLOPT_LN_NELDERMEAD \n                    -8472.302 \n```\n\n\n:::\n\n```{.r .cell-code}\nm5a.allfit.fixef <- t(sapply(m5a.allfit.OK,fixef))\nm5a.allfit.fixef.m <- melt(m5a.allfit.fixef)\nmodels <- levels(m5a.allfit.fixef.m$Var1)\nm5a.allfit.fixef.m <- transform(m5a.allfit.fixef.m, Var1 = factor(Var1, levels = names(lliks)))\n\nggplot(m5a.allfit.fixef.m[1:98, ], \n       aes(x = value, y = Var1, colour = Var1)) +\n  geom_point() +\n  facet_wrap(~ Var2, scale = \"free\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  scale_y_discrete(breaks = models,\n                   labels = substr(models, 1, 3)) +\n  labs(x = \"\", y = \"\") + \n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](models_files/figure-pdf/mixed effects models - answer level 2 diagnostics-1.pdf)\n:::\n\n```{.r .cell-code}\nggplot(m5a.allfit.fixef.m[99:189, ], \n       aes(x = value, y = Var1, colour = Var1)) +\n  geom_point() +\n  facet_wrap(~ Var2, scale = \"free\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  scale_y_discrete(breaks = models,\n                   labels = substr(models, 1, 3)) +\n  labs(x = \"\", y = \"\") + \n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](models_files/figure-pdf/mixed effects models - answer level 2 diagnostics-2.pdf)\n:::\n\n```{.r .cell-code}\n# So judging by this I leave the model alone - the coefficients seem to be okay \n# between different optimizers and since bobyqa comes close to the tolerance \n# threshold, I will use it.\n```\n:::\n\n\n### Putin v everyone else\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Putin (1) vs everyone else (0), declined to answer NA\nm4p.nested <- glmer(putin_else ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n\n# Converges!\nsummary(m4p.nested)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5p.nested <- glmer(putin_else ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status + help + military_dummy\n                    + log(dist) + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\", \n                                           optCtrl = list(maxfun = 1e9)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nderivs1 <- m5p.nested@optinfo$derivs\nsc_grad1 <- with(derivs1,solve(Hessian,gradient))\nmax(abs(sc_grad1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02388267\n```\n\n\n:::\n\n```{.r .cell-code}\nmax(pmin(abs(sc_grad1),abs(derivs1$gradient)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01320501\n```\n\n\n:::\n\n```{.r .cell-code}\ndd <- update(m5p.nested,devFunOnly=TRUE)\npars <- unlist(getME(m5p.nested,c(\"theta\",\"fixef\")))\ngrad2 <- grad(dd,pars)\nhess2 <- hessian(dd,pars)\nsc_grad2 <- solve(hess2,grad2)\nmax(pmin(abs(sc_grad2),abs(grad2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01319967\n```\n\n\n:::\n\n```{.r .cell-code}\n# Fit with all optimizers (loaded with other models)\n# m5p.allfit <- allFit(m5p.nested, maxfun = 1e9)\n\n# No options seem to work\nm5p.allfit_OK <- m5p.allfit[sapply(m5p.allfit, is, \"merMod\")]\nlapply(m5p.allfit_OK, function(x) x@optinfo$conv$lme4$messages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$bobyqa\n[1] \"Model failed to converge with max|grad| = 0.00486188 (tol = 0.002, component 1)\"\n\n$Nelder_Mead\n[1] \"Model failed to converge with max|grad| = 0.0439094 (tol = 0.002, component 1)\"\n\n$nlminbwrap\n[1] \"Model failed to converge with max|grad| = 0.0198981 (tol = 0.002, component 1)\"\n\n$nmkbw\n[1] \"Model failed to converge with max|grad| = 0.0321358 (tol = 0.002, component 1)\"\n\n$`optimx.L-BFGS-B`\n[1] \"Model failed to converge with max|grad| = 0.0818325 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_NELDERMEAD\n[1] \"Model failed to converge with max|grad| = 0.0240685 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_BOBYQA\n[1] \"Model failed to converge with max|grad| = 0.0277748 (tol = 0.002, component 1)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check for singular fit \ntt <- getME(m5p.nested,\"theta\")\nll <- getME(m5p.nested,\"lower\")\nmin(tt[ll==0]) # Nope, no singular fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3402741\n```\n\n\n:::\n\n```{.r .cell-code}\n# The only other thing to try is to see whether the coefficients change in unconverged models\nis.OK <- sapply(m5p.allfit, is, \"merMod\")\nm5p.allfit.OK <- m5p.allfit[is.OK]\nlapply(m5p.allfit.OK,function(x) x@optinfo$conv$lme4$messages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$bobyqa\n[1] \"Model failed to converge with max|grad| = 0.00486188 (tol = 0.002, component 1)\"\n\n$Nelder_Mead\n[1] \"Model failed to converge with max|grad| = 0.0439094 (tol = 0.002, component 1)\"\n\n$nlminbwrap\n[1] \"Model failed to converge with max|grad| = 0.0198981 (tol = 0.002, component 1)\"\n\n$nmkbw\n[1] \"Model failed to converge with max|grad| = 0.0321358 (tol = 0.002, component 1)\"\n\n$`optimx.L-BFGS-B`\n[1] \"Model failed to converge with max|grad| = 0.0818325 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_NELDERMEAD\n[1] \"Model failed to converge with max|grad| = 0.0240685 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_BOBYQA\n[1] \"Model failed to converge with max|grad| = 0.0277748 (tol = 0.002, component 1)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n(lliks <- sort(sapply(m5p.allfit.OK,logLik)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        nmkbw                   Nelder_Mead \n                    -3178.424                     -3178.423 \n    nloptwrap.NLOPT_LN_BOBYQA               optimx.L-BFGS-B \n                    -3178.423                     -3178.423 \n                   nlminbwrap nloptwrap.NLOPT_LN_NELDERMEAD \n                    -3178.423                     -3178.423 \n                       bobyqa \n                    -3178.423 \n```\n\n\n:::\n\n```{.r .cell-code}\nm5p.allfit.fixef <- t(sapply(m5p.allfit.OK,fixef))\nm5p.allfit.fixef.m <- melt(m5p.allfit.fixef)\nmodels <- levels(m5p.allfit.fixef.m$Var1)\nm5p.allfit.fixef.m <- transform(m5p.allfit.fixef.m, Var1 = factor(Var1, levels = names(lliks)))\n\nggplot(m5p.allfit.fixef.m[1:98, ], \n       aes(x = value, y = Var1, colour = Var1)) +\n  geom_point() +\n  facet_wrap(~ Var2, scale = \"free\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  scale_y_discrete(breaks = models,\n                   labels = substr(models, 1, 3)) +\n  labs(x = \"\", y = \"\") + \n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](models_files/figure-pdf/mixed effects models - putin level 2 diagnostics-1.pdf)\n:::\n\n```{.r .cell-code}\nggplot(m5p.allfit.fixef.m[99:189, ], \n       aes(x = value, y = Var1, colour = Var1)) +\n  geom_point() +\n  facet_wrap(~ Var2, scale = \"free\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  scale_y_discrete(breaks = models,\n                   labels = substr(models, 1, 3)) +\n  labs(x = \"\", y = \"\") + \n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](models_files/figure-pdf/mixed effects models - putin level 2 diagnostics-2.pdf)\n:::\n:::\n\n\n### Non-systemic v systemic opposition\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Non-systemic - Davankov or Spoiled (1) vs systemic - Haritonov, Slutsky (0) \n# opposition, declined to answer and Putin are NA\nm4s.nested <- glmer(nonsys_sys ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n\nsummary(m4s.nested)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5s.nested <- glmer(nonsys_sys ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status  + help + military_dummy\n                    + log(dist) + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\", \n                                           optCtrl = list(maxfun = 1e9)))\n\n# Singular fit! \n\n# The predictors most likely to cause issues are obl_type and friendly_status\n# as they are broadly (and correlated between themselves and other variables) \n# defined dichotomous predictors. Remove them from the model and try again\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5s.red <- update(m5s.nested, ~ . - obl_type - friendly_status)\n\n# Works great and no issues with convergence either\n```\n:::\n\n\n\n### Davankov v spoiled\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Davankov (1) vs Spoiled (0) declined to answer, Haritonov, Slutsky and Putin\n# are NA\nm4d.nested <- glmer(davankov_spoiled ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\"))\n\nsummary(m4d.nested)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5d.nested <- glmer(davankov_spoiled ~ sex + age_bin + time_to_vs.less_than_hour\n                    + out_of_Russia_time + result_trust_bin\n                    + orthodox_share + vdem_polyarchy_2022 \n                    + log(mad_gdppc_2018) + obl_type + export_share\n                    + import_share + friendly_status  + help + military_dummy\n                    + log(dist) + (1 | countryname_en.x), \n                    data = nested_me_data, family = binomial,\n                    control = glmerControl(optimizer = \"bobyqa\", \n                                           optCtrl = list(maxfun = 1e9)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nderivs1 <- m5d.nested@optinfo$derivs\nsc_grad1 <- with(derivs1,solve(Hessian,gradient))\nmax(abs(sc_grad1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.004068683\n```\n\n\n:::\n\n```{.r .cell-code}\nmax(pmin(abs(sc_grad1),abs(derivs1$gradient)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.004068683\n```\n\n\n:::\n\n```{.r .cell-code}\ndd <- update(m5d.nested, devFunOnly=TRUE)\npars <- unlist(getME(m5d.nested,c(\"theta\", \"fixef\")))\ngrad2 <- grad(dd,pars)\nhess2 <- hessian(dd,pars)\nsc_grad2 <- solve(hess2, grad2)\nmax(pmin(abs(sc_grad2), abs(grad2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.003948733\n```\n\n\n:::\n\n```{.r .cell-code}\n# Fit with all optimizers (loaded with other models)\n# m5d.allfit <- allFit(m5d.nested, maxfun = 1e9)\n\n# No options seem to work\nm5d.allfit_OK <- m5d.allfit[sapply(m5d.allfit, is, \"merMod\")]\nlapply(m5d.allfit_OK, function(x) x@optinfo$conv$lme4$messages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$bobyqa\n[1] \"Model failed to converge with max|grad| = 0.0157886 (tol = 0.002, component 1)\"\n\n$Nelder_Mead\n[1] \"Model failed to converge with max|grad| = 0.425244 (tol = 0.002, component 1)\"\n\n$nlminbwrap\n[1] \"Model failed to converge with max|grad| = 1.66793 (tol = 0.002, component 1)\"\n\n$`optimx.L-BFGS-B`\n[1] \"Model failed to converge with max|grad| = 0.0682182 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_NELDERMEAD\n[1] \"Model failed to converge with max|grad| = 0.081166 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_BOBYQA\n[1] \"Model failed to converge with max|grad| = 0.0678025 (tol = 0.002, component 1)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check for singular fit \ntt <- getME(m5d.nested,\"theta\")\nll <- getME(m5d.nested,\"lower\")\nmin(tt[ll==0]) # Nope, no singular fit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.112515\n```\n\n\n:::\n\n```{.r .cell-code}\n# The only other thing to try is to see whether the coefficients change in \n# unconverged models\nis.OK <- sapply(m5d.allfit, is, \"merMod\") \nm5d.allfit.OK <- m5d.allfit[is.OK]\nlapply(m5d.allfit.OK,function(x) x@optinfo$conv$lme4$messages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$bobyqa\n[1] \"Model failed to converge with max|grad| = 0.0157886 (tol = 0.002, component 1)\"\n\n$Nelder_Mead\n[1] \"Model failed to converge with max|grad| = 0.425244 (tol = 0.002, component 1)\"\n\n$nlminbwrap\n[1] \"Model failed to converge with max|grad| = 1.66793 (tol = 0.002, component 1)\"\n\n$`optimx.L-BFGS-B`\n[1] \"Model failed to converge with max|grad| = 0.0682182 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_NELDERMEAD\n[1] \"Model failed to converge with max|grad| = 0.081166 (tol = 0.002, component 1)\"\n\n$nloptwrap.NLOPT_LN_BOBYQA\n[1] \"Model failed to converge with max|grad| = 0.0678025 (tol = 0.002, component 1)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n(lliks <- sort(sapply(m5d.allfit.OK,logLik)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Nelder_Mead                    nlminbwrap \n                    -20537.76                     -20537.73 \n              optimx.L-BFGS-B     nloptwrap.NLOPT_LN_BOBYQA \n                    -20537.73                     -20537.73 \nnloptwrap.NLOPT_LN_NELDERMEAD                        bobyqa \n                    -20537.73                     -20537.73 \n```\n\n\n:::\n\n```{.r .cell-code}\nm5d.allfit.fixef <- t(sapply(m5d.allfit.OK,fixef))\nm5d.allfit.fixef.m <- melt(m5d.allfit.fixef)\nmodels <- levels(m5d.allfit.fixef.m$Var1)\nm5d.allfit.fixef.m <- transform(m5d.allfit.fixef.m,\n                                Var1 = factor(Var1, levels = names(lliks)))\n\nggplot(m5d.allfit.fixef.m[1:98, ], \n       aes(x = value, y = Var1, colour = Var1)) +\n  geom_point() +\n  facet_wrap(~ Var2, scale = \"free\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  scale_y_discrete(breaks = models,\n                   labels = substr(models, 1, 3)) +\n  labs(x = \"\", y = \"\") + \n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](models_files/figure-pdf/mixed effects models - davankov level 2 diagnostics-1.pdf)\n:::\n\n```{.r .cell-code}\nggplot(m5d.allfit.fixef.m[99:189, ], \n       aes(x = value, y = Var1, colour = Var1)) +\n  geom_point() +\n  facet_wrap(~ Var2, scale = \"free\") +\n  scale_colour_brewer(palette = \"Dark2\") +\n  scale_y_discrete(breaks = models,\n                   labels = substr(models, 1, 3)) +\n  labs(x = \"\", y = \"\") + \n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](models_files/figure-pdf/mixed effects models - davankov level 2 diagnostics-2.pdf)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsave(list = c(\"m5a.nested\", \"m5p.nested\", \"m5s.nested\", \"m5s.red\", \"m5d.nested\"), \n     file = \"nlme_bobyqa.RData\")\n\nsave(list = c(\"m4a.nested\", \"m4p.nested\", \"m4s.nested\", \"m4d.nested\"), \n     file = \"feme_bobyqa.RData\")\n\nsave(list = c(\"m5a.allfit\", \"m5p.allfit\", \"m5d.allfit\"), \n     file = \"me_allfit.RData\")\n```\n:::\n\n\n```{.r .cell-code}\nresizebox.stargazer(m4a.nested, m4p.nested, m4s.nested, m4d.nested, \n          title = \"Mixed effects models, level 1\", header = F,\n          dep.var.labels = c(\"Declined to answer vs answer\", \n                             \"Putin vs everyone else\", \n                             \"Non-systemic vs systemic opposition\",\n                             \"Davankov vs Spoiled\"),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\")\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Mixed effects models, level 1} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-5} \n\\\\[-1.8ex] & Declined to answer vs answer & Putin vs everyone else & Non-systemic vs systemic opposition & Davankov vs Spoiled \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ \n\\hline \\\\[-1.8ex] \n sexFemale & 0.275$^{***}$ & 0.482$^{***}$ & 0.022 & $-$0.199$^{***}$ \\\\ \n  & (0.044) & (0.071) & (0.056) & (0.024) \\\\ \n  & & & & \\\\ \n sexOther & 0.064 & 0.171 & $-$0.375 & $-$0.470$^{***}$ \\\\ \n  & (0.237) & (0.368) & (0.296) & (0.144) \\\\ \n  & & & & \\\\ \n age\\_bin18-24 & $-$0.003 & 0.026 & $-$0.095 & 0.062$^{*}$ \\\\ \n  & (0.081) & (0.124) & (0.086) & (0.037) \\\\ \n  & & & & \\\\ \n age\\_bin45-64 & 0.180$^{***}$ & 1.322$^{***}$ & $-$0.302$^{***}$ & $-$0.826$^{***}$ \\\\ \n  & (0.059) & (0.086) & (0.087) & (0.039) \\\\ \n  & & & & \\\\ \n age\\_bin65+ & 0.170$^{**}$ & 1.507$^{***}$ & $-$0.957$^{***}$ & $-$0.931$^{***}$ \\\\ \n  & (0.077) & (0.131) & (0.155) & (0.106) \\\\ \n  & & & & \\\\ \n time\\_to\\_vs.less\\_than\\_hourYes & 0.376$^{***}$ & 0.094 & $-$0.099 & $-$0.034 \\\\ \n  & (0.052) & (0.081) & (0.061) & (0.026) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_time2 - 5 years & $-$0.207$^{***}$ & $-$1.480$^{***}$ & 0.409$^{***}$ & 0.454$^{***}$ \\\\ \n  & (0.075) & (0.109) & (0.091) & (0.042) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter annexation & $-$0.159$^{**}$ & $-$0.806$^{***}$ & 0.296$^{***}$ & 0.219$^{***}$ \\\\ \n  & (0.080) & (0.120) & (0.102) & (0.045) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter invasion & $-$0.359$^{***}$ & $-$2.330$^{***}$ & 0.766$^{***}$ & 0.565$^{***}$ \\\\ \n  & (0.069) & (0.101) & (0.084) & (0.040) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeTourist (lives in Russia) & $-$0.039 & $-$0.975$^{***}$ & 0.041 & 0.652$^{***}$ \\\\ \n  & (0.096) & (0.143) & (0.144) & (0.087) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binDon't know & 0.499$^{***}$ & $-$3.960$^{***}$ & 0.718$^{***}$ & 0.387$^{***}$ \\\\ \n  & (0.082) & (0.109) & (0.127) & (0.139) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binNo & $-$1.328$^{***}$ & $-$7.218$^{***}$ & 1.903$^{***}$ & $-$0.806$^{***}$ \\\\ \n  & (0.060) & (0.101) & (0.094) & (0.105) \\\\ \n  & & & & \\\\ \n Constant & $-$2.658$^{***}$ & 1.992$^{***}$ & 1.267$^{***}$ & 1.558$^{***}$ \\\\ \n  & (0.123) & (0.158) & (0.123) & (0.117) \\\\ \n  & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 53,824 & 51,202 & 42,363 & 40,946 \\\\ \nLog Likelihood & $-$9,143.189 & $-$3,369.086 & $-$5,864.162 & $-$22,658.160 \\\\ \nAkaike Inf. Crit. & 18,314.380 & 6,766.172 & 11,756.320 & 45,344.320 \\\\ \nBayesian Inf. Crit. & 18,438.890 & 6,889.982 & 11,877.480 & 45,465.000 \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n```{.r .cell-code}\nm3.answer <- models(m3.nested.fe, 1)\nm3.putin <- models(m3.nested.fe, 2)\nm3.nonsys <- models(m3.nested.fe, 3)\nm3.davankov <- models(m3.nested.fe, 4)\n\n\nresizebox.stargazer(m4a.nested, m3.answer, m4p.nested, m3.putin, \n          title = \"Mixed effects models, comparison I\", header = F,\n          omit = \"as.factor\",\n          dep.var.labels = c(\"Declined to answer vs answer\", \n                             \"Declined to answer vs answer\", \n                             \"Putin vs everyone else\", \n                             \"Putin vs everyone else\"\n                             ),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\")\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Mixed effects models, comparison I} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-5} \n\\\\[-1.8ex] & Declined to answer vs answer & Declined to answer vs answer & Putin vs everyone else & Putin vs everyone else \\\\ \n\\\\[-1.8ex] & \\textit{generalized linear} & \\textit{logistic} & \\textit{generalized linear} & \\textit{logistic} \\\\ \n & \\textit{mixed-effects} & \\textit{} & \\textit{mixed-effects} & \\textit{} \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ \n\\hline \\\\[-1.8ex] \n sexFemale & 0.275$^{***}$ & 0.275$^{***}$ & 0.482$^{***}$ & 0.481$^{***}$ \\\\ \n  & (0.044) & (0.044) & (0.071) & (0.072) \\\\ \n  & & & & \\\\ \n sexOther & 0.064 & 0.039 & 0.171 & 0.208 \\\\ \n  & (0.237) & (0.240) & (0.368) & (0.369) \\\\ \n  & & & & \\\\ \n age\\_bin18-24 & $-$0.003 & $-$0.008 & 0.026 & 0.019 \\\\ \n  & (0.081) & (0.082) & (0.124) & (0.126) \\\\ \n  & & & & \\\\ \n age\\_bin45-64 & 0.180$^{***}$ & 0.172$^{***}$ & 1.322$^{***}$ & 1.304$^{***}$ \\\\ \n  & (0.059) & (0.059) & (0.086) & (0.087) \\\\ \n  & & & & \\\\ \n age\\_bin65+ & 0.170$^{**}$ & 0.161$^{**}$ & 1.507$^{***}$ & 1.501$^{***}$ \\\\ \n  & (0.077) & (0.078) & (0.131) & (0.132) \\\\ \n  & & & & \\\\ \n time\\_to\\_vs.less\\_than\\_hourYes & 0.376$^{***}$ & 0.310$^{***}$ & 0.094 & 0.071 \\\\ \n  & (0.052) & (0.055) & (0.081) & (0.085) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_time2 - 5 years & $-$0.207$^{***}$ & $-$0.217$^{***}$ & $-$1.480$^{***}$ & $-$1.467$^{***}$ \\\\ \n  & (0.075) & (0.075) & (0.109) & (0.110) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter annexation & $-$0.159$^{**}$ & $-$0.179$^{**}$ & $-$0.806$^{***}$ & $-$0.798$^{***}$ \\\\ \n  & (0.080) & (0.081) & (0.120) & (0.121) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter invasion & $-$0.359$^{***}$ & $-$0.363$^{***}$ & $-$2.330$^{***}$ & $-$2.357$^{***}$ \\\\ \n  & (0.069) & (0.069) & (0.101) & (0.103) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeTourist (lives in Russia) & $-$0.039 & $-$0.002 & $-$0.975$^{***}$ & $-$0.997$^{***}$ \\\\ \n  & (0.096) & (0.098) & (0.143) & (0.146) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binDon't know & 0.499$^{***}$ & 0.521$^{***}$ & $-$3.960$^{***}$ & $-$3.955$^{***}$ \\\\ \n  & (0.082) & (0.083) & (0.109) & (0.110) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binNo & $-$1.328$^{***}$ & $-$1.293$^{***}$ & $-$7.218$^{***}$ & $-$7.204$^{***}$ \\\\ \n  & (0.060) & (0.060) & (0.101) & (0.102) \\\\ \n  & & & & \\\\ \n Constant & $-$2.658$^{***}$ & $-$2.146$^{***}$ & 1.992$^{***}$ & 1.379$^{***}$ \\\\ \n  & (0.123) & (0.144) & (0.158) & (0.247) \\\\ \n  & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 53,824 & 53,824 & 51,202 & 51,202 \\\\ \nLog Likelihood & $-$9,143.189 & $-$9,008.215 & $-$3,369.086 & $-$3,287.206 \\\\ \nAkaike Inf. Crit. & 18,314.380 & 18,166.430 & 6,766.172 & 6,724.412 \\\\ \nBayesian Inf. Crit. & 18,438.890 &  & 6,889.982 &  \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n```{.r .cell-code}\nresizebox.stargazer(m4s.nested, m3.nonsys, m4d.nested, m3.davankov, \n          title = \"Mixed effects models, comparison II\", header = F,\n          omit = \"as.factor\",\n          dep.var.labels = c(\"Non-systemic vs systemic opposition\",\n                             \"Non-systemic vs systemic opposition\",\n                             \"Davankov vs Spoiled\",\n                             \"Davankov vs Spoiled\"\n                             ),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\")\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Mixed effects models, comparison II} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-5} \n\\\\[-1.8ex] & Non-systemic vs systemic opposition & Non-systemic vs systemic opposition & Davankov vs Spoiled & Davankov vs Spoiled \\\\ \n\\\\[-1.8ex] & \\textit{generalized linear} & \\textit{logistic} & \\textit{generalized linear} & \\textit{logistic} \\\\ \n & \\textit{mixed-effects} & \\textit{} & \\textit{mixed-effects} & \\textit{} \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ \n\\hline \\\\[-1.8ex] \n sexFemale & 0.022 & 0.019 & $-$0.199$^{***}$ & $-$0.195$^{***}$ \\\\ \n  & (0.056) & (0.057) & (0.024) & (0.024) \\\\ \n  & & & & \\\\ \n sexOther & $-$0.375 & $-$0.371 & $-$0.470$^{***}$ & $-$0.455$^{***}$ \\\\ \n  & (0.296) & (0.301) & (0.144) & (0.146) \\\\ \n  & & & & \\\\ \n age\\_bin18-24 & $-$0.095 & $-$0.114 & 0.062$^{*}$ & 0.072$^{*}$ \\\\ \n  & (0.086) & (0.088) & (0.037) & (0.037) \\\\ \n  & & & & \\\\ \n age\\_bin45-64 & $-$0.302$^{***}$ & $-$0.294$^{***}$ & $-$0.826$^{***}$ & $-$0.827$^{***}$ \\\\ \n  & (0.087) & (0.088) & (0.039) & (0.039) \\\\ \n  & & & & \\\\ \n age\\_bin65+ & $-$0.957$^{***}$ & $-$0.994$^{***}$ & $-$0.931$^{***}$ & $-$0.952$^{***}$ \\\\ \n  & (0.155) & (0.159) & (0.106) & (0.107) \\\\ \n  & & & & \\\\ \n time\\_to\\_vs.less\\_than\\_hourYes & $-$0.099 & $-$0.086 & $-$0.034 & $-$0.028 \\\\ \n  & (0.061) & (0.067) & (0.026) & (0.027) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_time2 - 5 years & 0.409$^{***}$ & 0.419$^{***}$ & 0.454$^{***}$ & 0.438$^{***}$ \\\\ \n  & (0.091) & (0.093) & (0.042) & (0.042) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter annexation & 0.296$^{***}$ & 0.299$^{***}$ & 0.219$^{***}$ & 0.213$^{***}$ \\\\ \n  & (0.102) & (0.103) & (0.045) & (0.046) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter invasion & 0.766$^{***}$ & 0.820$^{***}$ & 0.565$^{***}$ & 0.539$^{***}$ \\\\ \n  & (0.084) & (0.090) & (0.040) & (0.040) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeTourist (lives in Russia) & 0.041 & 0.134 & 0.652$^{***}$ & 0.633$^{***}$ \\\\ \n  & (0.144) & (0.150) & (0.087) & (0.088) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binDon't know & 0.718$^{***}$ & 0.716$^{***}$ & 0.387$^{***}$ & 0.392$^{***}$ \\\\ \n  & (0.127) & (0.129) & (0.139) & (0.141) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binNo & 1.903$^{***}$ & 1.891$^{***}$ & $-$0.806$^{***}$ & $-$0.804$^{***}$ \\\\ \n  & (0.094) & (0.095) & (0.105) & (0.106) \\\\ \n  & & & & \\\\ \n Constant & 1.267$^{***}$ & 1.223$^{***}$ & 1.558$^{***}$ & 1.401$^{***}$ \\\\ \n  & (0.123) & (0.198) & (0.117) & (0.130) \\\\ \n  & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 42,363 & 42,363 & 40,946 & 40,946 \\\\ \nLog Likelihood & $-$5,864.162 & $-$5,809.709 & $-$22,658.160 & $-$22,553.850 \\\\ \nAkaike Inf. Crit. & 11,756.320 & 11,769.420 & 45,344.320 & 45,257.690 \\\\ \nBayesian Inf. Crit. & 11,877.480 &  & 45,465.000 &  \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n```{.r .cell-code}\nresizebox.stargazer(m5a.nested, m5p.nested, m5s.red, m5d.nested, \n          title = \"Mixed effects models with level 2\", header = F,\n          omit = \"as.factor\",\n          dep.var.labels = c(\"Declined to answer vs answer\", \n                             \"Putin vs everyone else\", \n                             \"Non-systemic vs systemic opposition\",\n                             \"Davankov vs Spoiled\"\n                             ),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\")\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Mixed effects models with level 2} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-5} \n\\\\[-1.8ex] & Declined to answer vs answer & Putin vs everyone else & Non-systemic vs systemic opposition & Davankov vs Spoiled \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ \n\\hline \\\\[-1.8ex] \n sexFemale & 0.258$^{***}$ & 0.489$^{***}$ & 0.015 & $-$0.186$^{***}$ \\\\ \n  & (0.045) & (0.073) & (0.059) & (0.025) \\\\ \n  & & & & \\\\ \n sexOther & 0.071 & 0.176 & $-$0.232 & $-$0.462$^{***}$ \\\\ \n  & (0.240) & (0.376) & (0.328) & (0.148) \\\\ \n  & & & & \\\\ \n age\\_bin18-24 & 0.036 & 0.040 & $-$0.117 & 0.064$^{*}$ \\\\ \n  & (0.083) & (0.125) & (0.088) & (0.038) \\\\ \n  & & & & \\\\ \n age\\_bin45-64 & 0.194$^{***}$ & 1.316$^{***}$ & $-$0.299$^{***}$ & $-$0.823$^{***}$ \\\\ \n  & (0.060) & (0.089) & (0.090) & (0.040) \\\\ \n  & & & & \\\\ \n age\\_bin65+ & 0.175$^{**}$ & 1.491$^{***}$ & $-$0.930$^{***}$ & $-$0.906$^{***}$ \\\\ \n  & (0.078) & (0.134) & (0.159) & (0.108) \\\\ \n  & & & & \\\\ \n time\\_to\\_vs.less\\_than\\_hourYes & 0.355$^{***}$ & 0.054 & $-$0.081 & $-$0.041 \\\\ \n  & (0.054) & (0.084) & (0.065) & (0.027) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_time2 - 5 years & $-$0.175$^{**}$ & $-$1.496$^{***}$ & 0.402$^{***}$ & 0.444$^{***}$ \\\\ \n  & (0.076) & (0.111) & (0.093) & (0.042) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter annexation & $-$0.134$^{*}$ & $-$0.826$^{***}$ & 0.318$^{***}$ & 0.214$^{***}$ \\\\ \n  & (0.081) & (0.121) & (0.103) & (0.045) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter invasion & $-$0.351$^{***}$ & $-$2.329$^{***}$ & 0.817$^{***}$ & 0.540$^{***}$ \\\\ \n  & (0.071) & (0.103) & (0.090) & (0.040) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeTourist (lives in Russia) & $-$0.018 & $-$1.014$^{***}$ & 0.148 & 0.647$^{***}$ \\\\ \n  & (0.099) & (0.148) & (0.153) & (0.090) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binDon't know & 0.551$^{***}$ & $-$3.956$^{***}$ & 0.700$^{***}$ & 0.331$^{**}$ \\\\ \n  & (0.084) & (0.111) & (0.133) & (0.146) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binNo & $-$1.355$^{***}$ & $-$7.238$^{***}$ & 1.910$^{***}$ & $-$0.839$^{***}$ \\\\ \n  & (0.062) & (0.103) & (0.098) & (0.111) \\\\ \n  & & & & \\\\ \n orthodox\\_share & $-$0.472 & 1.888$^{***}$ & $-$0.360$^{**}$ & 0.071 \\\\ \n  & (0.468) & (0.412) & (0.142) & (0.163) \\\\ \n  & & & & \\\\ \n vdem\\_polyarchy\\_2022 & 0.328 & $-$0.959 & 0.532$^{**}$ & $-$0.561$^{**}$ \\\\ \n  & (0.668) & (0.674) & (0.250) & (0.233) \\\\ \n  & & & & \\\\ \n log(mad\\_gdppc\\_2018) & $-$0.280 & $-$0.336$^{*}$ & 0.036 & 0.037 \\\\ \n  & (0.174) & (0.176) & (0.088) & (0.072) \\\\ \n  & & & & \\\\ \n obl\\_type1 & $-$0.412 & $-$0.683 &  & 0.084 \\\\ \n  & (0.471) & (0.454) &  & (0.162) \\\\ \n  & & & & \\\\ \n obl\\_type2 & $-$0.900$^{*}$ & $-$0.705 &  & 0.160 \\\\ \n  & (0.507) & (0.485) &  & (0.171) \\\\ \n  & & & & \\\\ \n obl\\_type3 & $-$0.653 & $-$0.592 &  & 0.014 \\\\ \n  & (0.463) & (0.427) &  & (0.162) \\\\ \n  & & & & \\\\ \n obl\\_type4 & $-$0.826 & 0.149 &  & $-$0.132 \\\\ \n  & (0.814) & (0.739) &  & (0.278) \\\\ \n  & & & & \\\\ \n export\\_share & $-$0.174$^{***}$ & $-$0.061 & 0.030 & 0.018 \\\\ \n  & (0.062) & (0.058) & (0.024) & (0.016) \\\\ \n  & & & & \\\\ \n import\\_share & 0.217$^{***}$ & 0.123$^{**}$ & $-$0.020 & $-$0.018 \\\\ \n  & (0.063) & (0.056) & (0.020) & (0.018) \\\\ \n  & & & & \\\\ \n friendly\\_statusUnfriendly & 0.622 & 0.103 &  & 0.149 \\\\ \n  & (0.819) & (0.794) &  & (0.284) \\\\ \n  & & & & \\\\ \n friendly\\_statusFriendly & 0.430 & $-$0.279 &  & 0.264 \\\\ \n  & (0.480) & (0.466) &  & (0.183) \\\\ \n  & & & & \\\\ \n help & $-$1.003$^{**}$ & $-$0.599 & $-$0.124 & $-$0.255 \\\\ \n  & (0.476) & (0.532) & (0.194) & (0.196) \\\\ \n  & & & & \\\\ \n military\\_dummy & 0.085 & $-$1.367$^{**}$ & 0.224 & 0.254 \\\\ \n  & (0.728) & (0.678) & (0.195) & (0.264) \\\\ \n  & & & & \\\\ \n log(dist) & $-$0.386$^{**}$ & 0.212 & $-$0.150$^{***}$ & 0.074 \\\\ \n  & (0.151) & (0.144) & (0.057) & (0.050) \\\\ \n  & & & & \\\\ \n Constant & 3.842$^{*}$ & 5.416$^{***}$ & 1.739$^{*}$ & 0.991 \\\\ \n  & (1.965) & (2.091) & (1.051) & (0.907) \\\\ \n  & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 48,964 & 46,494 & 37,827 & 36,523 \\\\ \nLog Likelihood & $-$8,472.302 & $-$3,178.423 & $-$5,342.410 & $-$20,537.730 \\\\ \nAkaike Inf. Crit. & 17,000.600 & 6,412.846 & 10,728.820 & 41,131.460 \\\\ \nBayesian Inf. Crit. & 17,246.970 & 6,657.764 & 10,916.720 & 41,369.610 \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n```{.r .cell-code}\nresizebox.stargazer(m4a.nested, m5a.nested, m4p.nested, m5p.nested, \n          title = \"Mixed effects models with level 2, comparison I\", header = F,\n          omit = \"as.factor\",\n          dep.var.labels = c(\"Declined to answer vs answer\", \n                             \"Declined to answer vs answer\", \n                             \"Putin vs everyone else\", \n                             \"Putin vs everyone else\"\n                             ),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\")\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Mixed effects models with level 2, comparison I} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-5} \n\\\\[-1.8ex] & \\multicolumn{2}{c}{Declined to answer vs answer} & \\multicolumn{2}{c}{Declined to answer vs answer} \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ \n\\hline \\\\[-1.8ex] \n sexFemale & 0.275$^{***}$ & 0.258$^{***}$ & 0.482$^{***}$ & 0.489$^{***}$ \\\\ \n  & (0.044) & (0.045) & (0.071) & (0.073) \\\\ \n  & & & & \\\\ \n sexOther & 0.064 & 0.071 & 0.171 & 0.176 \\\\ \n  & (0.237) & (0.240) & (0.368) & (0.376) \\\\ \n  & & & & \\\\ \n age\\_bin18-24 & $-$0.003 & 0.036 & 0.026 & 0.040 \\\\ \n  & (0.081) & (0.083) & (0.124) & (0.125) \\\\ \n  & & & & \\\\ \n age\\_bin45-64 & 0.180$^{***}$ & 0.194$^{***}$ & 1.322$^{***}$ & 1.316$^{***}$ \\\\ \n  & (0.059) & (0.060) & (0.086) & (0.089) \\\\ \n  & & & & \\\\ \n age\\_bin65+ & 0.170$^{**}$ & 0.175$^{**}$ & 1.507$^{***}$ & 1.491$^{***}$ \\\\ \n  & (0.077) & (0.078) & (0.131) & (0.134) \\\\ \n  & & & & \\\\ \n time\\_to\\_vs.less\\_than\\_hourYes & 0.376$^{***}$ & 0.355$^{***}$ & 0.094 & 0.054 \\\\ \n  & (0.052) & (0.054) & (0.081) & (0.084) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_time2 - 5 years & $-$0.207$^{***}$ & $-$0.175$^{**}$ & $-$1.480$^{***}$ & $-$1.496$^{***}$ \\\\ \n  & (0.075) & (0.076) & (0.109) & (0.111) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter annexation & $-$0.159$^{**}$ & $-$0.134$^{*}$ & $-$0.806$^{***}$ & $-$0.826$^{***}$ \\\\ \n  & (0.080) & (0.081) & (0.120) & (0.121) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter invasion & $-$0.359$^{***}$ & $-$0.351$^{***}$ & $-$2.330$^{***}$ & $-$2.329$^{***}$ \\\\ \n  & (0.069) & (0.071) & (0.101) & (0.103) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeTourist (lives in Russia) & $-$0.039 & $-$0.018 & $-$0.975$^{***}$ & $-$1.014$^{***}$ \\\\ \n  & (0.096) & (0.099) & (0.143) & (0.148) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binDon't know & 0.499$^{***}$ & 0.551$^{***}$ & $-$3.960$^{***}$ & $-$3.956$^{***}$ \\\\ \n  & (0.082) & (0.084) & (0.109) & (0.111) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binNo & $-$1.328$^{***}$ & $-$1.355$^{***}$ & $-$7.218$^{***}$ & $-$7.238$^{***}$ \\\\ \n  & (0.060) & (0.062) & (0.101) & (0.103) \\\\ \n  & & & & \\\\ \n orthodox\\_share &  & $-$0.472 &  & 1.888$^{***}$ \\\\ \n  &  & (0.468) &  & (0.412) \\\\ \n  & & & & \\\\ \n vdem\\_polyarchy\\_2022 &  & 0.328 &  & $-$0.959 \\\\ \n  &  & (0.668) &  & (0.674) \\\\ \n  & & & & \\\\ \n log(mad\\_gdppc\\_2018) &  & $-$0.280 &  & $-$0.336$^{*}$ \\\\ \n  &  & (0.174) &  & (0.176) \\\\ \n  & & & & \\\\ \n obl\\_type1 &  & $-$0.412 &  & $-$0.683 \\\\ \n  &  & (0.471) &  & (0.454) \\\\ \n  & & & & \\\\ \n obl\\_type2 &  & $-$0.900$^{*}$ &  & $-$0.705 \\\\ \n  &  & (0.507) &  & (0.485) \\\\ \n  & & & & \\\\ \n obl\\_type3 &  & $-$0.653 &  & $-$0.592 \\\\ \n  &  & (0.463) &  & (0.427) \\\\ \n  & & & & \\\\ \n obl\\_type4 &  & $-$0.826 &  & 0.149 \\\\ \n  &  & (0.814) &  & (0.739) \\\\ \n  & & & & \\\\ \n export\\_share &  & $-$0.174$^{***}$ &  & $-$0.061 \\\\ \n  &  & (0.062) &  & (0.058) \\\\ \n  & & & & \\\\ \n import\\_share &  & 0.217$^{***}$ &  & 0.123$^{**}$ \\\\ \n  &  & (0.063) &  & (0.056) \\\\ \n  & & & & \\\\ \n friendly\\_statusUnfriendly &  & 0.622 &  & 0.103 \\\\ \n  &  & (0.819) &  & (0.794) \\\\ \n  & & & & \\\\ \n friendly\\_statusFriendly &  & 0.430 &  & $-$0.279 \\\\ \n  &  & (0.480) &  & (0.466) \\\\ \n  & & & & \\\\ \n help &  & $-$1.003$^{**}$ &  & $-$0.599 \\\\ \n  &  & (0.476) &  & (0.532) \\\\ \n  & & & & \\\\ \n military\\_dummy &  & 0.085 &  & $-$1.367$^{**}$ \\\\ \n  &  & (0.728) &  & (0.678) \\\\ \n  & & & & \\\\ \n log(dist) &  & $-$0.386$^{**}$ &  & 0.212 \\\\ \n  &  & (0.151) &  & (0.144) \\\\ \n  & & & & \\\\ \n Constant & $-$2.658$^{***}$ & 3.842$^{*}$ & 1.992$^{***}$ & 5.416$^{***}$ \\\\ \n  & (0.123) & (1.965) & (0.158) & (2.091) \\\\ \n  & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 53,824 & 48,964 & 51,202 & 46,494 \\\\ \nLog Likelihood & $-$9,143.189 & $-$8,472.302 & $-$3,369.086 & $-$3,178.423 \\\\ \nAkaike Inf. Crit. & 18,314.380 & 17,000.600 & 6,766.172 & 6,412.846 \\\\ \nBayesian Inf. Crit. & 18,438.890 & 17,246.970 & 6,889.982 & 6,657.764 \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n\n```{.r .cell-code}\nresizebox.stargazer(m4s.nested, m5s.red, m4d.nested, m5d.nested, \n          title = \"Mixed effects models with level 2, comparison II\", header = F,\n          omit = \"as.factor\",\n          dep.var.labels = c(\"Non-systemic vs systemic opposition\",\n                             \"Non-systemic vs systemic opposition\",\n                             \"Davankov vs Spoiled\",\n                             \"Davankov vs Spoiled\"\n                             ),\n          tab.height = \"\\\\textheight\", tab.width= \"\\\\textwidth\")\n```\n\n\n\\begin{table}[!htbp] \\centering \n  \\caption{Mixed effects models with level 2, comparison II} \n  \\label{} \n\\resizebox*{\\textwidth}{\\textheight}{%\n\\begin{tabular}{@{\\extracolsep{5pt}}lcccc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{4}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-5} \n\\\\[-1.8ex] & \\multicolumn{2}{c}{Non-systemic vs systemic opposition} & \\multicolumn{2}{c}{Non-systemic vs systemic opposition} \\\\ \n\\\\[-1.8ex] & (1) & (2) & (3) & (4)\\\\ \n\\hline \\\\[-1.8ex] \n sexFemale & 0.022 & 0.015 & $-$0.199$^{***}$ & $-$0.186$^{***}$ \\\\ \n  & (0.056) & (0.059) & (0.024) & (0.025) \\\\ \n  & & & & \\\\ \n sexOther & $-$0.375 & $-$0.232 & $-$0.470$^{***}$ & $-$0.462$^{***}$ \\\\ \n  & (0.296) & (0.328) & (0.144) & (0.148) \\\\ \n  & & & & \\\\ \n age\\_bin18-24 & $-$0.095 & $-$0.117 & 0.062$^{*}$ & 0.064$^{*}$ \\\\ \n  & (0.086) & (0.088) & (0.037) & (0.038) \\\\ \n  & & & & \\\\ \n age\\_bin45-64 & $-$0.302$^{***}$ & $-$0.299$^{***}$ & $-$0.826$^{***}$ & $-$0.823$^{***}$ \\\\ \n  & (0.087) & (0.090) & (0.039) & (0.040) \\\\ \n  & & & & \\\\ \n age\\_bin65+ & $-$0.957$^{***}$ & $-$0.930$^{***}$ & $-$0.931$^{***}$ & $-$0.906$^{***}$ \\\\ \n  & (0.155) & (0.159) & (0.106) & (0.108) \\\\ \n  & & & & \\\\ \n time\\_to\\_vs.less\\_than\\_hourYes & $-$0.099 & $-$0.081 & $-$0.034 & $-$0.041 \\\\ \n  & (0.061) & (0.065) & (0.026) & (0.027) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_time2 - 5 years & 0.409$^{***}$ & 0.402$^{***}$ & 0.454$^{***}$ & 0.444$^{***}$ \\\\ \n  & (0.091) & (0.093) & (0.042) & (0.042) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter annexation & 0.296$^{***}$ & 0.318$^{***}$ & 0.219$^{***}$ & 0.214$^{***}$ \\\\ \n  & (0.102) & (0.103) & (0.045) & (0.045) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeAfter invasion & 0.766$^{***}$ & 0.817$^{***}$ & 0.565$^{***}$ & 0.540$^{***}$ \\\\ \n  & (0.084) & (0.090) & (0.040) & (0.040) \\\\ \n  & & & & \\\\ \n out\\_of\\_Russia\\_timeTourist (lives in Russia) & 0.041 & 0.148 & 0.652$^{***}$ & 0.647$^{***}$ \\\\ \n  & (0.144) & (0.153) & (0.087) & (0.090) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binDon't know & 0.718$^{***}$ & 0.700$^{***}$ & 0.387$^{***}$ & 0.331$^{**}$ \\\\ \n  & (0.127) & (0.133) & (0.139) & (0.146) \\\\ \n  & & & & \\\\ \n result\\_trust\\_binNo & 1.903$^{***}$ & 1.910$^{***}$ & $-$0.806$^{***}$ & $-$0.839$^{***}$ \\\\ \n  & (0.094) & (0.098) & (0.105) & (0.111) \\\\ \n  & & & & \\\\ \n orthodox\\_share &  & $-$0.360$^{**}$ &  & 0.071 \\\\ \n  &  & (0.142) &  & (0.163) \\\\ \n  & & & & \\\\ \n vdem\\_polyarchy\\_2022 &  & 0.532$^{**}$ &  & $-$0.561$^{**}$ \\\\ \n  &  & (0.250) &  & (0.233) \\\\ \n  & & & & \\\\ \n log(mad\\_gdppc\\_2018) &  & 0.036 &  & 0.037 \\\\ \n  &  & (0.088) &  & (0.072) \\\\ \n  & & & & \\\\ \n obl\\_type1 &  &  &  & 0.084 \\\\ \n  &  &  &  & (0.162) \\\\ \n  & & & & \\\\ \n obl\\_type2 &  &  &  & 0.160 \\\\ \n  &  &  &  & (0.171) \\\\ \n  & & & & \\\\ \n obl\\_type3 &  &  &  & 0.014 \\\\ \n  &  &  &  & (0.162) \\\\ \n  & & & & \\\\ \n obl\\_type4 &  &  &  & $-$0.132 \\\\ \n  &  &  &  & (0.278) \\\\ \n  & & & & \\\\ \n export\\_share &  & 0.030 &  & 0.018 \\\\ \n  &  & (0.024) &  & (0.016) \\\\ \n  & & & & \\\\ \n import\\_share &  & $-$0.020 &  & $-$0.018 \\\\ \n  &  & (0.020) &  & (0.018) \\\\ \n  & & & & \\\\ \n friendly\\_statusUnfriendly &  &  &  & 0.149 \\\\ \n  &  &  &  & (0.284) \\\\ \n  & & & & \\\\ \n friendly\\_statusFriendly &  &  &  & 0.264 \\\\ \n  &  &  &  & (0.183) \\\\ \n  & & & & \\\\ \n help &  & $-$0.124 &  & $-$0.255 \\\\ \n  &  & (0.194) &  & (0.196) \\\\ \n  & & & & \\\\ \n military\\_dummy &  & 0.224 &  & 0.254 \\\\ \n  &  & (0.195) &  & (0.264) \\\\ \n  & & & & \\\\ \n log(dist) &  & $-$0.150$^{***}$ &  & 0.074 \\\\ \n  &  & (0.057) &  & (0.050) \\\\ \n  & & & & \\\\ \n Constant & 1.267$^{***}$ & 1.739$^{*}$ & 1.558$^{***}$ & 0.991 \\\\ \n  & (0.123) & (1.051) & (0.117) & (0.907) \\\\ \n  & & & & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 42,363 & 37,827 & 40,946 & 36,523 \\\\ \nLog Likelihood & $-$5,864.162 & $-$5,342.410 & $-$22,658.160 & $-$20,537.730 \\\\ \nAkaike Inf. Crit. & 11,756.320 & 10,728.820 & 45,344.320 & 41,131.460 \\\\ \nBayesian Inf. Crit. & 11,877.480 & 10,916.720 & 45,465.000 & 41,369.610 \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n}\n\\end{table} \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{longtable}\n\\usepackage{array}\n\\usepackage{multirow}\n\\usepackage{wrapfig}\n\\usepackage{float}\n\\usepackage{colortbl}\n\\usepackage{pdflscape}\n\\usepackage{tabu}\n\\usepackage{threeparttable}\n\\usepackage{threeparttablex}\n\\usepackage[normalem]{ulem}\n\\usepackage{makecell}\n\\usepackage{xcolor}\n\\usepackage{siunitx}\n\n  \\newcolumntype{d}{S[\n    input-open-uncertainty=,\n    input-close-uncertainty=,\n    parse-numbers = false,\n    table-align-text-pre=false,\n    table-align-text-post=false\n  ]}\n  \n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}